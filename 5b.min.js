const version="beta 5.2.3";let canvas,ctx;const cwidth=960,cheight=540;let pixelRatio,addedZoom=1,highQual=!0;const requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;let osc1,osctx1,osc2,osctx2,osc3,osctx3,osc4,osctx4;const thumbs=new Array(8),thumbsctx=new Array(8);let thumbBig,thumbBigctx,_xmouse=0,_ymouse=0,_pxmouse=0,_pymouse=0,lastClickX=0,lastClickY=0,valueAtClick=0,_cursor="default",hoverText="";const _keysDown=new Array(222).fill(!1);let _frameCount=0,qTimer=0,inputText="",textAfterCursorAtClick="",controlOrCommandPress=!1,defaultLevelsString="",levelsString="",levelCount=133,f=19;const levels=new Array(levelCount),startLocations=new Array(levelCount),locations=new Array(6),bgs=new Array(levelCount);let levelStart=0,levelWidth=0,levelHeight=0,thisLevel=[],tileFrames=[];const switchable=new Array(6);let charCount=0,charCount2=0,playMode=0,lineCount=0,lineLength=0;const dialogueChar=new Array(levelCount),dialogueText=new Array(levelCount),dialogueFace=new Array(levelCount);let cLevelDialogueChar=new Array(levelCount),cLevelDialogueText=new Array(levelCount),cLevelDialogueFace=new Array(levelCount);const levelName=new Array(levelCount),mdao=new Array(levelCount);let mdao2=0,levelProgress,bonusProgress,bonusesCleared,gotCoin,gotThisCoin=!1;const bfdia5b=window.localStorage;let deathCount,timer,coins,longMode=!1,quirksMode=!1,enableExperimentalFeatures=!1,levelAlreadySharedToExplore=!1;function clearVars(){deathCount=timer=coins=bonusProgress=levelProgress=0,bonusesCleared=new Array(33).fill(!1),gotCoin=new Array(levelCount).fill(!1)}function saveGame(){bfdia5b.setItem("gotCoin",gotCoin),bfdia5b.setItem("coins",coins),bfdia5b.setItem("levelProgress",levelProgress),bfdia5b.setItem("bonusProgress",bonusProgress),bfdia5b.setItem("bonusesCleared",bonusesCleared),bfdia5b.setItem("deathCount",deathCount),bfdia5b.setItem("timer",timer)}if(null==bfdia5b.getItem("levelProgress"))clearVars();else{levelProgress=parseInt(bfdia5b.getItem("levelProgress")),bonusProgress=parseInt(bfdia5b.getItem("bonusProgress")),deathCount=parseInt(bfdia5b.getItem("deathCount")),timer=parseFloat(bfdia5b.getItem("timer")),gotCoin=new Array(levelCount);let t=bfdia5b.getItem("gotCoin").split(",");for(let e=coins=0;e<levelCount;e++)gotCoin[e]="true"===t[e],gotCoin[e]&&coins++;bonusesCleared=new Array(33);let a=bfdia5b.getItem("bonusesCleared").split(",");for(let e=0;e<33;e++)bonusesCleared[e]="true"===a[e]}let white_alpha=0;function getTimer(){return _frameCount/.06}function charAt(e){return levelsString.charCodeAt(e+levelStart)-48}function charAt2(e){return levelsString.charAt(e+levelStart)}function tileAt(e,t,a){e=levelsString.charCodeAt(e+levelStart);return 8364==e?93:e<=126?e-46:e<=182?e-80:e-81}function loadLevels(){for(let a=0;a<levelCount;a++){for(levelStart+=2,levelName[a]="",lineLength=0;-35!=charAt(lineLength);lineLength++)levelName[a]+=charAt2(lineLength);levelStart+=lineLength,levelWidth=10*charAt(2)+charAt(3),levelHeight=10*charAt(5)+charAt(6),charCount=10*charAt(8)+charAt(9),bgs[a]=10*charAt(11)+charAt(12),longMode=!1,24==charAt(14)&&(longMode=!0),levels[a]=new Array(levelHeight);for(let e=0;e<levelHeight;e++)levels[a][e]=new Array(levelWidth);if(longMode){for(let t=0;t<levelHeight;t++)for(let e=0;e<levelWidth;e++)levels[a][t][e]=111*tileAt(t*(2*levelWidth+2)+2*e+17,a,t)+tileAt(t*(2*levelWidth+2)+2*e+18,a,t);levelStart+=levelHeight*(2*levelWidth+2)+17}else{for(let t=0;t<levelHeight;t++)for(let e=0;e<levelWidth;e++)levels[a][t][e]=tileAt(t*(levelWidth+2)+e+17,a,t);levelStart+=levelHeight*(levelWidth+2)+17}startLocations[a]=new Array(charCount);for(let t=0;t<charCount;t++){startLocations[a][t]=new Array(6);for(let e=0;e<(f-1)/3;e++)startLocations[a][t][e]=10*charAt(3*e)+charAt(3*e+1);if(levelStart+=f-2,3==startLocations[a][t][5]||4==startLocations[a][t][5]){for(levelStart++,startLocations[a][t].push([]),lineLength=0;-35!=charAt(lineLength);lineLength++)startLocations[a][t][6].push(charAt(lineLength));levelStart+=lineLength}levelStart+=2}lineCount=10*charAt(0)+charAt(1),levelStart+=4,dialogueText[a]=new Array(lineCount),dialogueChar[a]=new Array(lineCount),dialogueFace[a]=new Array(lineCount);for(let e=0;e<lineCount;e++){for(dialogueChar[a][e]=10*charAt(0)+charAt(1),24==charAt(2)?dialogueFace[a][e]=2:dialogueFace[a][e]=3,levelStart+=4,lineLength=0,dialogueText[a][e]="";-35!=charAt(lineLength);)lineLength++,dialogueText[a][e]+=charAt2(lineLength-1);levelStart+=lineLength+2}mdao2+=1e5*charAt(0)+1e4*charAt(1)+1e3*charAt(2)+100*charAt(3)+10*charAt(4)+charAt(5),mdao[a]=mdao2,levelStart+=8}}function loadLevelpack(){let o=levelsString.replace(/\r/gi,"").split("\n"),c=0;for(let r=0;r<o.length;c++){for(;""===o[r];)r++;if(r>=o.length)break;if("loadedLevels="==o[r])if(""==o[r+1]){for(r++;""===o[r];)r++;if(r>=o.length)break}else 1<o[r+2].split(",").length&&r++;levelName[c]=o[r],r++;var e=o[r].split(",");if(levelWidth=parseInt(e[0]),levelHeight=parseInt(e[1]),charCount=parseInt(e[2]),bgs[c]=parseInt(e[3]),longMode="H"==e[4],r++,levels[c]=new Array(levelHeight),longMode)for(let t=0;t<levelHeight;t++){levels[c][t]=new Array(levelWidth);for(let e=0;e<levelWidth;e++)levels[c][t][e]=111*tileIDFromChar(o[r+t].charCodeAt(2*e))+tileIDFromChar(o[r+t].charCodeAt(2*e+1))}else for(let t=0;t<levelHeight;t++){levels[c][t]=new Array(levelWidth);for(let e=0;e<levelWidth;e++)levels[c][t][e]=tileIDFromChar(o[r+t].charCodeAt(e))}r+=levelHeight,startLocations[c]=new Array(charCount);for(let a=0;a<charCount;a++){let t=o[r+a].split(/[\s,\.]+/);if(startLocations[c][a]=new Array(6),startLocations[c][a][0]=parseInt(t[0],10),startLocations[c][a][1]=parseInt(t[1],10),startLocations[c][a][2]=parseInt(t[2],10),startLocations[c][a][3]=parseInt(t[3],10),startLocations[c][a][4]=parseInt(t[4],10),startLocations[c][a][5]=parseInt(t[5],10),3==startLocations[c][a][5]||4==startLocations[c][a][5]){startLocations[c][a].push([]);for(let e=0;e<t[6].length;e++)startLocations[c][a][6].push(t[6].charCodeAt(e)-48)}}r+=charCount,lineCount=parseInt(o[r],10),r++,dialogueText[c]=new Array(lineCount),dialogueChar[c]=new Array(lineCount),dialogueFace[c]=new Array(lineCount);for(let e=0;e<lineCount;e++)dialogueChar[c][e]=parseInt(o[r+e].slice(0,2)),"H"==o[r+e].charAt(2)?dialogueFace[c][e]=2:dialogueFace[c][e]=3,dialogueText[c][e]=o[r+e].substring(4);r+=lineCount,mdao2+=parseInt(o[r],10),mdao[r]=mdao2,r++}}const blockProperties=[[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,0,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,0,0,!0,!1,!0,1,!1],[!0,!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!0,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!0,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!0,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,0,0,!1,!1,!0,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,0,0,!1,!1,!0,120,!0,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119]],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,0,0,!0,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,0,0,!1,!1,!0,0,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!0,!1,!1,0,0,!1,!1,!0,14,!1,[0,1,2,3,4,5,6,7,8,9,10,11,12,13]],[!0,!0,!0,!0,!1,!1,!1,!1,!0,!1,!1,0,6,!1,!1,!0,12,!0,[0,1,2,3,4,5,6,7,8,9,10,11]],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!0,0,0,!1,!1,!0,41,!0,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40]],[!0,!0,!0,!0,!1,!1,!1,!1,!0,!1,!1,0,6,!1,!1,!0,12,!0,[0,1,2,3,4,5,6,7,8,9,10,11]],[!0,!0,!0,!0,!0,!0,!0,!0,!1,!1,!1,0,0,!1,!1,!0,1,!0],[!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!0,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!0,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!0,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!0,!1,!1,0,1,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!0,!1,!1,0,1,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,1,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,1,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,1,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,7,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,2,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,8,0,!1,!1,!0,1,!1],[!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!0,!0,!1,13,0,!1,!1,!0,5,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!0,!0,!1,14,0,!1,!1,!0,5,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!0,!1,!0,!1,!0,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!0,!0,!1,!1,!0,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!0,!1,!1,0,0,!1,!1,!0,3,!0,[0,0,0,0,0,1,1,2,2,1,1]],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!0,!1,!1,0,2,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!0,!1,!1,0,2,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,2,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,2,!1,!1,!0,1,!1],[!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,3,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,9,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,0,0,!1,!1,!0,120,!0,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119]],[!0,!0,!0,!0,!1,!1,!1,!1,!0,!1,!1,0,3,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,3,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,3,!1,!1,!0,1,!1],[!1,!0,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,3,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,3,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!0,!1,!1,0,3,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,0,0,!1,!1,!0,2,!0,[0,0,0,1,1,1]],[!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!0,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!0,!0,!1,15,0,!1,!1,!0,5,!1],[!0,!0,!0,!0,!0,!0,!0,!0,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,0,0,!0,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!0,!1,!1,0,0,!1,!1,!0,30,!0,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29]],[!1,!1,!1,!1,!0,!0,!0,!0,!0,!1,!1,0,0,!1,!1,!0,20,!0,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]],[!1,!1,!1,!1,!0,!0,!0,!0,!0,!1,!1,0,0,!1,!1,!0,20,!0,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,1,!1,!1,!0,1,!1],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!1,!1,0,1,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,0,0,!1,!1,!0,120,!0,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119]],[!1,!0,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,1,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,1,!1,!1,!0,1,!1],[!1,!0,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,6,!1,!1,!0,12,!0,[0,1,2,3,4,5,6,7,8,9,10,11]],[!1,!0,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,6,!1,!1,!1,1,!1],[!1,!0,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,6,!1,!1,!0,12,!0,[0,1,2,3,4,5,6,7,8,9,10,11]],[!1,!0,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,6,!1,!1,!1,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,0,0,!0,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,0,0,!0,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,0,0,!1,!1,!1,1,!1],[!1,!1,!1,!1,!0,!0,!0,!0,!1,!1,!1,0,1,!1,!0,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,0,!1,!1,!0,60,!0,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]],[!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,0,0,!0,!1,!0,1,!1],[!1,!1,!1,!1,!0,!0,!0,!0,!1,!1,!1,0,1,!1,!0,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,0,!1,!1,!0,60,!0,[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]],[!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,0,0,!0,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,0,0,!1,!1,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,0,0,!0,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,6,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,12,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,0,0,!1,!0,!0,1,!1],[!0,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,0,0,!0,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,0,0,!1,!1,!1,1,!1],[!1,!0,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,2,!1,!1,!0,1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,0,2,!1,!1,!0,1,!1]],switches=[[31,33,32,34,79,78,81,82],[51,53,52,54,133,134],[65,61,60,62,63,64],[],[],[14,16,83,85]],charD=[[28,45.4,.45,27,.8,!1,1,1,!0,10],[23,56,.36,31,.8,!1,1.7,1,!0,10],[20,51,.41,20,.85,!1,5,1,!1,10],[10,86,.26,31,.8,!1,1.6,1,!0,10],[10,84,.23,31,.8,!1,1.4,1,!0,10],[28,70,.075,28,.8,!1,9,1,!0,10],[26,49,.2,20,.75,!1,.6,1,!1,10],[44,65,.8,20,.75,!1,.8,1,!1,10],[16,56,.25,17,.76,!1,.8,1,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[0,0,0,0,0,!1,1,0,!0,10],[36.5,72.8,1,20,.6,!1,0,1,!0,6],[15.1,72.8,.6,20,.7,!0,0,1,!0,6],[20,40,.15,20,.7,!0,.7,1,!0,6],[25,50,.64,20,.6,!0,.1,1,!0,6],[25,10,1,5,.7,!0,.2,1,!0,4],[25,50,1,20,.7,!0,.1,1,!0,3],[25,29,.1,20,.8,!0,1,1,!0,6],[21.5,43,.3,20,.6,!0,.5,1,!0,6],[35,60,1,20,.7,!0,.1,1,!0,3],[22.5,45,1,20,.7,!0,.8,1,!0,3],[25,50,1,20,.7,!0,.1,27,!0,3],[15,30,.64,20,.6,!0,.2,1,!0,3],[10,55,.8,20,.3,!0,.4,1,!0,6],[45,10,1,20,.7,!0,.2,1,!0,4],[20,40,1,20,.8,!1,.8,5,!0,3],[16,45,.4,20,.94,!1,1.1,60,!0,3],[25,10,1,20,.7,!0,.3,1,!0,3],[45,10,.4,20,.7,!0,.7,1,!0,4],[15,50,.1,20,.8,!0,1.9,1,!0,6],[25,25,.1,20,.8,!0,1.7,1,!0,6],[30,540,10,20,.4,!0,0,1,!0,3]],diaMouths=[{frameorder:[1,2,3,2,1,0,0,1,2,3,2,1,0,0,1,2,3,2,1,0,0,1,2,3,2,1,0,0,1,2,3,2,1,0,0,1,2,3,2,1,0,0,1,2,3,2,1,0,0,1,2,3,2,1,0],frames:[{type:"static",bodypart:36,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-1.55,ty:-.1}},{type:"static",bodypart:37,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-1.55,ty:-.1}},{type:"static",bodypart:45,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-1.55,ty:-.1}},{type:"static",bodypart:36,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-1.55,ty:-.1}}]},{frameorder:[0,0,1,2,3,1,1,0,0,1,2,3,1,1,0,0,1,2,3,1,1,0,0,1,2,3,1,1,0,0,1,2,3,1,1,0,0,1,2,3,1,1,0,0,1,2,3,1,1,0,0,1,2,3,1,1,0],frames:[{type:"static",bodypart:1,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-.55,ty:1.35}},{type:"static",bodypart:42,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-.55,ty:1.35}},{type:"static",bodypart:43,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-.55,ty:1.35}},{type:"static",bodypart:44,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-.55,ty:1.35}}]},{frameorder:[1,2,2,2,1,0,0,1,2,2,2,1,0,0,1,2,2,2,1,0,0,1,2,2,2,1,0,0,1,2,2,2,1,0,0,1,2,2,2,1,0,0,1,2,2,2,1,0,0,1,2,2,2,1,0],frames:[{type:"static",bodypart:51,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-33.45,ty:-2.15}},{type:"static",bodypart:52,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-33.45,ty:-2.15}},{type:"static",bodypart:53,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-33.45,ty:-2.15}}]},{frameorder:[1,2,2,2,1,0,0,1,2,2,2,1,0,0,1,2,2,2,1,0,0,1,2,2,2,1,0,0,1,2,2,2,1,0,0,1,2,2,2,1,0,0,1,2,2,2,1,0,0,1,2,2,2,1,0],frames:[{type:"static",bodypart:54,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-33.45,ty:-2.15}},{type:"static",bodypart:55,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-33.45,ty:-2.15}},{type:"static",bodypart:56,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-33.45,ty:-2.15}}]}],bodyPartAnimations=[{bodypart:41,frames:[{a:.1691741943359375,b:-.3343353271484375,c:-.32513427734375,d:-.164520263671875,tx:0,ty:0},{a:.1628875732421875,b:-.3369293212890625,c:-.32763671875,d:-.1584014892578125,tx:-.05,ty:.05},{a:.143402099609375,b:-.3457183837890625,c:-.3361968994140625,d:-.13946533203125,tx:0,ty:.05},{a:.106475830078125,b:-.35894775390625,c:-.3490753173828125,d:-.1035614013671875,tx:0,ty:.15},{a:.0476837158203125,b:-.37158203125,c:-.3613433837890625,d:-.0463714599609375,tx:0,ty:.2},{a:-.0312652587890625,b:-.3734130859375,c:-.3631439208984375,d:.0304107666015625,tx:.1,ty:.3},{a:-.130035400390625,b:-.3511962890625,c:-.341522216796875,d:.12646484375,tx:.2,ty:.45},{a:-.2310028076171875,b:-.29461669921875,c:-.2865142822265625,d:.224639892578125,tx:.4,ty:.6},{a:-.31005859375,b:-.209991455078125,c:-.2042236328125,d:.3015289306640625,tx:.5,ty:.6},{a:-.3542327880859375,b:-.1222076416015625,c:-.1188507080078125,d:.3444976806640625,tx:.75,ty:.65},{a:-.3712921142578125,b:-.0524749755859375,c:-.051025390625,d:.361083984375,tx:.9,ty:.65},{a:-.37493896484375,b:-.0117645263671875,c:-.011444091796875,d:.3646240234375,tx:1,ty:.6},{a:-.37518310546875,b:-152587890625e-16,c:-152587890625e-16,d:.3648681640625,tx:.95,ty:.55},{a:-.375152587890625,b:-.0035858154296875,c:-.0034942626953125,d:.364837646484375,tx:.95,ty:.55},{a:-.3746490478515625,b:-.0182647705078125,c:-.01776123046875,d:.364349365234375,tx:.95,ty:.55},{a:-.3723907470703125,b:-.044281005859375,c:-.0430755615234375,d:.3621368408203125,tx:.85,ty:.6},{a:-.3656005859375,b:-.0829010009765625,c:-.08062744140625,d:.35552978515625,tx:.8,ty:.65},{a:-.3497314453125,b:-.1344451904296875,c:-.1307373046875,d:.3401031494140625,tx:.7,ty:.6},{a:-.3190460205078125,b:-.196136474609375,c:-.19073486328125,d:.310272216796875,tx:.6,ty:.6},{a:-.2664947509765625,b:-.2629547119140625,c:-.2557220458984375,d:.2591705322265625,tx:.5,ty:.6},{a:-.19036865234375,b:-.3223876953125,c:-.3135223388671875,d:.1851348876953125,tx:.3,ty:.5},{a:-.0957794189453125,b:-.36212158203125,c:-.3521575927734375,d:.0931396484375,tx:.2,ty:.45},{a:-.0017242431640625,b:-.3748016357421875,c:-.3644866943359375,d:.001678466796875,tx:.15,ty:.3},{a:.076385498046875,b:-.3666534423828125,c:-.3565673828125,d:-.07427978515625,tx:.1,ty:.15},{a:.129913330078125,b:-.35107421875,c:-.3414154052734375,d:-.1263275146484375,tx:.05,ty:.05},{a:.159912109375,b:-.338348388671875,c:-.32904052734375,d:-.155517578125,tx:.05,ty:.05}]},{bodypart:3,frames:[{a:.24114990234375,b:.0818023681640625,c:-.123992919921875,d:.365570068359375,tx:-.05,ty:4.4},{a:.2412567138671875,b:.083343505859375,c:-.12591552734375,d:.364501953125,tx:0,ty:4.4},{a:.2418670654296875,b:.0895843505859375,c:-.1339111328125,d:.3616180419921875,tx:-.1,ty:4.25},{a:.2423858642578125,b:.1007843017578125,c:-.1479644775390625,d:.356048583984375,tx:-.1,ty:4.2},{a:.2422637939453125,b:.1172943115234375,c:-.1678619384765625,d:.3470306396484375,tx:-.15,ty:4},{a:.240447998046875,b:.139434814453125,c:-.193145751953125,d:.3335418701171875,tx:-.25,ty:3.8},{a:.2349395751953125,b:.1680755615234375,c:-.222930908203125,d:.3143310546875,tx:-.3,ty:3.6},{a:.22479248046875,b:.20147705078125,c:-.255889892578125,d:.2880706787109375,tx:-.4,ty:3.25},{a:.2071990966796875,b:.239471435546875,c:-.2901611328125,d:.25347900390625,tx:-.6,ty:2.85},{a:.1816253662109375,b:.27899169921875,c:-.3218231201171875,d:.2118682861328125,tx:-.75,ty:2.5},{a:.146728515625,b:.3177032470703125,c:-.3484039306640625,d:.1646728515625,tx:-.85,ty:2.1},{a:.1043548583984375,b:.351959228515625,c:-.3685150146484375,d:.11297607421875,tx:-1.05,ty:1.65},{a:.056854248046875,b:.37933349609375,c:-.3805389404296875,d:.062042236328125,tx:-1.2,ty:1.3},{a:.0088653564453125,b:.3985443115234375,c:-.3854522705078125,d:.0136566162109375,tx:-1.3,ty:.9},{a:-.0344390869140625,b:.410064697265625,c:-.3846893310546875,d:-.0270843505859375,tx:-1.4,ty:.6},{a:-.07354736328125,b:.41558837890625,c:-.3806915283203125,d:-.0607147216796875,tx:-1.5,ty:.35},{a:-.1043243408203125,b:.41729736328125,c:-.375457763671875,d:-.0870208740234375,tx:-1.6,ty:.15},{a:-.1259613037109375,b:.4172210693359375,c:-.37078857421875,d:-.104949951171875,tx:-1.6,ty:0},{a:-.1394805908203125,b:.4163665771484375,c:-.3674163818359375,d:-.115997314453125,tx:-1.7,ty:-.1},{a:-.1436767578125,b:.4165496826171875,c:-.3667144775390625,d:-.119384765625,tx:-1.7,ty:-.1}]},{bodypart:2,frames:[{a:.363616943359375,b:.0290069580078125,c:-.0290069580078125,d:.363616943359375,tx:.05,ty:2.5},{a:.3632659912109375,b:.03179931640625,c:-.03179931640625,d:.3632659912109375,tx:.1,ty:2.45},{a:.362457275390625,b:.0399322509765625,c:-.0399322509765625,d:.362457275390625,tx:0,ty:2.45},{a:.3603515625,b:.0555419921875,c:-.0555419921875,d:.3603515625,tx:0,ty:2.4},{a:.356475830078125,b:.07623291015625,c:-.07623291015625,d:.356475830078125,tx:0,ty:2.35},{a:.3489227294921875,b:.105255126953125,c:-.105255126953125,d:.3489227294921875,tx:0,ty:2.3},{a:.336517333984375,b:.1396942138671875,c:-.1396942138671875,d:.336517333984375,tx:-.05,ty:2.25},{a:.317535400390625,b:.178497314453125,c:-.178497314453125,d:.317535400390625,tx:-.1,ty:2.1},{a:.2895660400390625,b:.2209014892578125,c:-.2209014892578125,d:.2895660400390625,tx:-.15,ty:2.05},{a:.252410888671875,b:.26251220703125,c:-.26251220703125,d:.252410888671875,tx:-.15,ty:2},{a:.20660400390625,b:.2999420166015625,c:-.2999420166015625,d:.20660400390625,tx:-.25,ty:2},{a:.152862548828125,b:.3306884765625,c:-.3306884765625,d:.152862548828125,tx:-.3,ty:2},{a:.096160888671875,b:.3515472412109375,c:-.3515472412109375,d:.096160888671875,tx:-.3,ty:2},{a:.0413360595703125,b:.3622894287109375,c:-.3622894287109375,d:.0413360595703125,tx:-.35,ty:2.05},{a:-.00811767578125,b:.364654541015625,c:-.364654541015625,d:-.00811767578125,tx:-.5,ty:2.05},{a:-.04949951171875,b:.361236572265625,c:-.361236572265625,d:-.04949951171875,tx:-.55,ty:2.1},{a:-.08221435546875,b:.3551177978515625,c:-.3551177978515625,d:-.08221435546875,tx:-.6,ty:2.25},{a:-.103973388671875,b:.34930419921875,c:-.34930419921875,d:-.103973388671875,tx:-.7,ty:2.25},{a:-.117431640625,b:.344970703125,c:-.344970703125,d:-.117431640625,tx:-.7,ty:2.25},{a:-.12213134765625,b:.343719482421875,c:-.343719482421875,d:-.12213134765625,tx:-.75,ty:2.25}]},{bodypart:2,frames:[{a:1,b:0,c:0,d:1,tx:.45,ty:-.05},{a:.941253662109375,b:.334625244140625,c:-.334625244140625,d:.941253662109375,tx:.45,ty:-.05},{a:.902191162109375,b:-.428955078125,c:.428955078125,d:.902191162109375,tx:.45,ty:-.05},{a:.962890625,b:.2609100341796875,c:-.2609100341796875,d:.962890625,tx:.45,ty:-.05}]},{bodypart:57,frames:[{a:-.3065643310546875,b:0,c:0,d:.3065643310546875,tx:27.45,ty:-49.95},{a:-.30633544921875,b:.0095062255859375,c:.0095062255859375,d:.30633544921875,tx:26.5,ty:-50.75},{a:-.3059234619140625,b:.01763916015625,c:.01763916015625,d:.3059234619140625,tx:25.75,ty:-51.45},{a:-.305419921875,b:.0243682861328125,c:.0243682861328125,d:.305419921875,tx:25.1,ty:-51.95},{a:-.304901123046875,b:.029693603515625,c:.029693603515625,d:.304901123046875,tx:24.5,ty:-52.4},{a:-.304473876953125,b:.0336456298828125,c:.0336456298828125,d:.304473876953125,tx:24.15,ty:-52.75},{a:-.304168701171875,b:.0362091064453125,c:.0362091064453125,d:.304168701171875,tx:23.85,ty:-52.95},{a:-.3041229248046875,b:.037567138671875,c:.037567138671875,d:.3041229248046875,tx:23.75,ty:-53.05},{a:-.304168701171875,b:.0362091064453125,c:.0362091064453125,d:.304168701171875,tx:23.85,ty:-52.95},{a:-.3044586181640625,b:.0336456298828125,c:.0336456298828125,d:.3044586181640625,tx:24.1,ty:-52.7},{a:-.304901123046875,b:.029693603515625,c:.029693603515625,d:.304901123046875,tx:24.55,ty:-52.4},{a:-.305419921875,b:.0243682861328125,c:.0243682861328125,d:.305419921875,tx:25.05,ty:-51.95},{a:-.3059234619140625,b:.01763916015625,c:.01763916015625,d:.3059234619140625,tx:25.75,ty:-51.45},{a:-.30633544921875,b:.009521484375,c:.009521484375,d:.30633544921875,tx:26.55,ty:-50.7},{a:-.3065643310546875,b:0,c:0,d:.3065643310546875,tx:27.45,ty:-49.95},{a:-.3064117431640625,b:-.008209228515625,c:-.008209228515625,d:.3064117431640625,tx:28.15,ty:-49.15},{a:-.3060760498046875,b:-.0161285400390625,c:-.0161285400390625,d:.3060760498046875,tx:28.85,ty:-48.45},{a:-.305633544921875,b:-.022735595703125,c:-.022735595703125,d:.305633544921875,tx:29.45,ty:-47.8},{a:-.30517578125,b:-.028045654296875,c:-.028045654296875,d:.30517578125,tx:29.9,ty:-47.3},{a:-.304779052734375,b:-.0320587158203125,c:-.0320587158203125,d:.304779052734375,tx:30.25,ty:-46.9},{a:-.3044586181640625,b:-.0347747802734375,c:-.0347747802734375,d:.3044586181640625,tx:30.45,ty:-46.6},{a:-.304290771484375,b:-.0362091064453125,c:-.0362091064453125,d:.304290771484375,tx:30.55,ty:-46.45},{a:-.3042755126953125,b:-.037353515625,c:-.037353515625,d:.3042755126953125,tx:30.65,ty:-46.35},{a:-.304290771484375,b:-.0361785888671875,c:-.0361785888671875,d:.304290771484375,tx:30.55,ty:-46.45},{a:-.304595947265625,b:-.033599853515625,c:-.033599853515625,d:.304595947265625,tx:30.4,ty:-46.7},{a:-.3050079345703125,b:-.0296630859375,c:-.0296630859375,d:.3050079345703125,tx:30,ty:-47.1},{a:-.305511474609375,b:-.0243377685546875,c:-.0243377685546875,d:.305511474609375,tx:29.6,ty:-47.65},{a:-.3059844970703125,b:-.0176239013671875,c:-.0176239013671875,d:.3059844970703125,tx:29,ty:-48.3},{a:-.306365966796875,b:-.0095062255859375,c:-.0095062255859375,d:.306365966796875,tx:28.3,ty:-49},{a:-.3065643310546875,b:0,c:0,d:.3065643310546875,tx:27.45,ty:-49.95}]}],legFrames=[{type:"static",bodypart:6},{type:"static",bodypart:7},{type:"anim",usesMats:!1,frames:[8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35]},{type:"anim",usesMats:!0,bodypart:62,frames:[{a:.351593017578125,b:.111663818359375,c:-.1230926513671875,d:.463104248046875,tx:.25,ty:-.7},{a:.3514251708984375,b:.1110687255859375,c:-.122222900390625,d:.46295166015625,tx:.2,ty:-.75},{a:.3518218994140625,b:.1097564697265625,c:-.12200927734375,d:.4629974365234375,tx:.25,ty:-.75},{a:.351898193359375,b:.1095123291015625,c:-.12017822265625,d:.4634857177734375,tx:.25,ty:-.7},{a:.35235595703125,b:.10797119140625,c:-.118133544921875,d:.4640350341796875,tx:.35,ty:-.7},{a:.3529052734375,b:.1063232421875,c:-.115966796875,d:.464569091796875,tx:.25,ty:-.7},{a:.3537445068359375,b:.103363037109375,c:-.1120758056640625,d:.4655303955078125,tx:.25,ty:-.75},{a:.35467529296875,b:.1002655029296875,c:-.108001708984375,d:.46649169921875,tx:.25,ty:-.7},{a:.3555755615234375,b:.097015380859375,c:-.103729248046875,d:.4674835205078125,tx:.35,ty:-.7},{a:.3567962646484375,b:.0924530029296875,c:-.0977325439453125,d:.468780517578125,tx:.35,ty:-.75},{a:.3580169677734375,b:.08770751953125,c:-.09149169921875,d:.470062255859375,tx:.35,ty:-.75},{a:.35943603515625,b:.0815887451171875,c:-.0834808349609375,d:.4715576171875,tx:.4,ty:-.7},{a:.3608551025390625,b:.075286865234375,c:-.0751953125,d:.4729461669921875,tx:.4,ty:-.65},{a:.36212158203125,b:.068817138671875,c:-.0667266845703125,d:.4742431640625,tx:.35,ty:-.75},{a:.363555908203125,b:.06097412109375,c:-.0564727783203125,d:.4756011962890625,tx:.35,ty:-.7},{a:.36480712890625,b:.052978515625,c:-.046051025390625,d:.476715087890625,tx:.45,ty:-.7},{a:.3661041259765625,b:.0436859130859375,c:-.033905029296875,d:.477783203125,tx:.4,ty:-.65},{a:.3669586181640625,b:.0355377197265625,c:-.02325439453125,d:.4784393310546875,tx:.5,ty:-.75},{a:.3676605224609375,b:.0273284912109375,c:-.0125579833984375,d:.4788665771484375,tx:.6,ty:-.75},{a:.3682708740234375,b:.017974853515625,c:-.000396728515625,d:.4790496826171875,tx:.5,ty:-.75},{a:.368621826171875,b:.009918212890625,c:.00848388671875,d:.47894287109375,tx:.6,ty:-.75},{a:.3687286376953125,b:.003204345703125,c:.017181396484375,d:.4786376953125,tx:.6,ty:-.75},{a:.36871337890625,b:-.0032806396484375,c:.027191162109375,d:.4781646728515625,tx:.65,ty:-.7},{a:.3686370849609375,b:-.00836181640625,c:.0337677001953125,d:.4777069091796875,tx:.6,ty:-.7},{a:.3684844970703125,b:-.0131988525390625,c:.040069580078125,d:.4771728515625,tx:.65,ty:-.7},{a:.368255615234375,b:-.0178070068359375,c:.0460052490234375,d:.4766387939453125,tx:.65,ty:-.7},{a:.3680419921875,b:-.0209503173828125,c:.0500946044921875,d:.4762115478515625,tx:.7,ty:-.7},{a:.3679656982421875,b:-.0226898193359375,c:.0523529052734375,d:.4759368896484375,tx:.65,ty:-.7},{a:.3678741455078125,b:-.024200439453125,c:.054290771484375,d:.4757080078125,tx:.65,ty:-.7},{a:.367889404296875,b:-.02484130859375,c:.05499267578125,d:.4757843017578125,tx:.65,ty:-.7},{a:.3678741455078125,b:-.024261474609375,c:.0543670654296875,d:.4757080078125,tx:.65,ty:-.7},{a:.367919921875,b:-.02288818359375,c:.0525970458984375,d:.475921630859375,tx:.6,ty:-.7},{a:.367950439453125,b:-.02264404296875,c:.052276611328125,d:.4759368896484375,tx:.65,ty:-.7},{a:.3680419921875,b:-.0210723876953125,c:.05023193359375,d:.476165771484375,tx:.65,ty:-.75},{a:.3681793212890625,b:-.019378662109375,c:.048065185546875,d:.476409912109375,tx:.65,ty:-.7},{a:.368316650390625,b:-.0163421630859375,c:.044158935546875,d:.4768218994140625,tx:.65,ty:-.75},{a:.3684844970703125,b:-.0131988525390625,c:.0400543212890625,d:.4771728515625,tx:.6,ty:-.7},{a:.3685760498046875,b:-.0099029541015625,c:.0358123779296875,d:.4775543212890625,tx:.6,ty:-.7},{a:.36865234375,b:-.0064544677734375,c:.0313262939453125,d:.4778594970703125,tx:.6,ty:-.7},{a:.3687286376953125,b:-.00164794921875,c:.0251007080078125,d:.4782867431640625,tx:.6,ty:-.7},{a:.3687286376953125,b:.0032958984375,c:.01708984375,d:.4786376953125,tx:.5,ty:-.7},{a:.3686370849609375,b:.0084075927734375,c:.01043701171875,d:.4788970947265625,tx:.5,ty:-.7},{a:.36834716796875,b:.0160980224609375,c:.000457763671875,d:.4790191650390625,tx:.5,ty:-.7},{a:.3679962158203125,b:.022705078125,c:-.006561279296875,d:.47900390625,tx:.5,ty:-.75},{a:.367431640625,b:.0306549072265625,c:-.01690673828125,d:.4787139892578125,tx:.4,ty:-.7},{a:.3666534423828125,b:.0386505126953125,c:-.0273590087890625,d:.47821044921875,tx:.45,ty:-.7},{a:.36572265625,b:.0467376708984375,c:-.0378875732421875,d:.47747802734375,tx:.4,ty:-.7},{a:.36456298828125,b:.0548095703125,c:-.0484161376953125,d:.4764862060546875,tx:.35,ty:-.75},{a:.363250732421875,b:.062835693359375,c:-.0604705810546875,d:.47509765625,tx:.4,ty:-.7},{a:.36151123046875,b:.07196044921875,c:-.0708770751953125,d:.4736328125,tx:.25,ty:-.65},{a:.3601226806640625,b:.0785675048828125,c:-.0795135498046875,d:.47222900390625,tx:.35,ty:-.7},{a:.3583526611328125,b:.0861663818359375,c:-.089508056640625,d:.4704437255859375,tx:.35,ty:-.65},{a:.3568267822265625,b:.0923919677734375,c:-.09765625,d:.468780517578125,tx:.2,ty:-.75},{a:.3555145263671875,b:.0972137451171875,c:-.1039886474609375,d:.4674072265625,tx:.25,ty:-.7},{a:.3542022705078125,b:.1017913818359375,c:-.1100006103515625,d:.46600341796875,tx:.25,ty:-.65},{a:.3532867431640625,b:.1049957275390625,c:-.114227294921875,d:.4650115966796875,tx:.2,ty:-.75},{a:.3524017333984375,b:.10797119140625,c:-.1181488037109375,d:.4640045166015625,tx:.15,ty:-.7},{a:.3518829345703125,b:.109619140625,c:-.120269775390625,d:.4634552001953125,tx:.25,ty:-.7},{a:.3514404296875,b:.1110076904296875,c:-.1221466064453125,d:.46295166015625,tx:.2,ty:-.7},{a:.351593017578125,b:.111663818359375,c:-.1230926513671875,d:.463104248046875,tx:.25,ty:-.7}]},{type:"anim",usesMats:!0,bodypart:62,frames:[{a:.2861175537109375,b:.232147216796875,c:-.2834320068359375,d:.3856353759765625,tx:.1,ty:-.65},{a:.2884979248046875,b:.228240966796875,c:-.2781219482421875,d:.3885650634765625,tx:.15,ty:-.7},{a:.29730224609375,b:.2166748046875,c:-.262603759765625,d:.3993072509765625,tx:0,ty:-.7},{a:.312591552734375,b:.194122314453125,c:-.23236083984375,d:.417724609375,tx:.2,ty:-.7},{a:.3320465087890625,b:.1588134765625,c:-.18536376953125,d:.4407501220703125,tx:.35,ty:-.7},{a:.3515167236328125,b:.1096343994140625,c:-.120361328125,d:.4630279541015625,tx:.45,ty:-.75},{a:.3641204833984375,b:.0562286376953125,c:-.05029296875,d:.47607421875,tx:.5,ty:-.65},{a:.368499755859375,b:.0100250244140625,c:.0083465576171875,d:.4788360595703125,tx:.65,ty:-.7},{a:.368316650390625,b:-.0161285400390625,c:.043853759765625,d:.4767913818359375,tx:.7,ty:-.75},{a:.367889404296875,b:-.0248565673828125,c:.05499267578125,d:.4757843017578125,tx:.7,ty:-.7},{a:.3680419921875,b:-.02099609375,c:.050140380859375,d:.476165771484375,tx:.7,ty:-.75},{a:.3685760498046875,b:-.0084228515625,c:.0338897705078125,d:.4776763916015625,tx:.65,ty:-.7},{a:.3684844970703125,b:.0113525390625,c:.0066070556640625,d:.4788665771484375,tx:.6,ty:-.7},{a:.365966796875,b:.043426513671875,c:-.0335845947265625,d:.4776153564453125,tx:.5,ty:-.65},{a:.358428955078125,b:.0848388671875,c:-.0877532958984375,d:.4704437255859375,tx:.45,ty:-.7},{a:.3435211181640625,b:.13238525390625,c:-.1503753662109375,d:.45404052734375,tx:.35,ty:-.65},{a:.3231201171875,b:.1761322021484375,c:-.208404541015625,d:.430267333984375,tx:.2,ty:-.7},{a:.3029327392578125,b:.2087860107421875,c:-.2519989013671875,d:.4060821533203125,tx:.1,ty:-.65},{a:.29034423828125,b:.225860595703125,c:-.274932861328125,d:.390838623046875,tx:.1,ty:-.7},{a:.2861175537109375,b:.232147216796875,c:-.2834320068359375,d:.3856353759765625,tx:.1,ty:-.65}]}],charModels=[{torsomat:{a:1,b:0,c:0,d:1,tx:.05,ty:-3.1},legx:[-8.55,9.8],legy:[-11.25,-11.25],firemat:{a:-.45697021484375,b:.0060882568359375,c:.0076904296875,d:.5772552490234375,tx:-2.3,ty:-51.8},charimgmat:{a:.15606689453125,b:0,c:0,d:.15606689453125,tx:.05,ty:.6},burstmat:{a:1.5308685302734375,b:0,c:0,d:.8062744140625,tx:.05,ty:-23.95},defaultExpr:0,mouthType:0,frames:[[{type:"anim",anim:0,offset:15,loop:!0,mat:{a:1,b:0,c:0,d:1,tx:-19.05,ty:-17.65}},{type:"body",mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:0,ty:-24.75}},{type:"static",bodypart:36,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-13.05,ty:-20.25}},{type:"static",bodypart:39,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-25.35,ty:-30.7}},{type:"static",bodypart:39,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-9.65,ty:-30.95}},{type:"anim",anim:0,offset:0,loop:!0,mat:{a:1,b:0,c:0,d:1,tx:15.95,ty:-17.65}}],[{type:"static",bodypart:2,mat:{a:.3648681640625,b:152587890625e-16,c:-152587890625e-16,d:.3648681640625,tx:-19.15,ty:-18.1}},{type:"body",mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:0,ty:-23.85}},{type:"dia",mat:{a:1,b:0,c:0,d:1,tx:-11.7,ty:-19.35}},{type:"static",bodypart:39,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-25.35,ty:-29.8}},{type:"static",bodypart:39,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-9.65,ty:-30.05}},{type:"static",bodypart:2,mat:{a:.3648681640625,b:0,c:152587890625e-16,d:.3648681640625,tx:19.2,ty:-19.6}}],[{type:"anim",anim:0,offset:15,loop:!0,mat:{a:-1,b:0,c:0,d:1,tx:18.95,ty:-17.65}},{type:"body",mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-.1,ty:-24.75}},{type:"static",bodypart:36,mat:{a:.400299072265625,b:0,c:0,d:.400299072265625,tx:12.95,ty:-20.25}},{type:"static",bodypart:39,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:9.55,ty:-30.95}},{type:"static",bodypart:39,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:25.25,ty:-30.7}},{type:"anim",anim:0,offset:0,loop:!0,mat:{a:-1,b:0,c:0,d:1,tx:-16.05,ty:-17.65}}],[{type:"static",bodypart:2,mat:{a:-.3648681640625,b:152587890625e-16,c:152587890625e-16,d:.3648681640625,tx:19.15,ty:-18.1}},{type:"body",mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:0,ty:-23.85}},{type:"dia",mat:{a:-1,b:0,c:0,d:1,tx:11.7,ty:-19.35}},{type:"static",bodypart:39,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:9.65,ty:-30.05}},{type:"static",bodypart:39,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:25.35,ty:-29.8}},{type:"static",bodypart:2,mat:{a:-.3648681640625,b:0,c:-152587890625e-16,d:.3648681640625,tx:-19.2,ty:-19.35}}],[{type:"anim",anim:2,offset:0,loop:!1,mat:{a:1,b:0,c:0,d:1,tx:-20.65,ty:-23.15}},{type:"body",mat:{a:.3636016845703125,b:.02899169921875,c:-.02899169921875,d:.3636016845703125,tx:1.5,ty:-23.8}},{type:"static",bodypart:36,mat:{a:-.39892578125,b:-.0318145751953125,c:-.0318145751953125,d:.39892578125,tx:-11.85,ty:-20.4}},{type:"static",bodypart:39,mat:{a:.3636016845703125,b:.02899169921875,c:-.02899169921875,d:.3636016845703125,tx:-23.3,ty:-31.75}},{type:"static",bodypart:39,mat:{a:.3636016845703125,b:.02899169921875,c:-.02899169921875,d:.3636016845703125,tx:-7.6,ty:-30.75}},{type:"anim",anim:2,offset:0,loop:!1,mat:{a:-1,b:0,c:0,d:1,tx:21.75,ty:-22.9}}],[{type:"anim",anim:2,offset:0,loop:!1,mat:{a:-1,b:0,c:0,d:1,tx:21.05,ty:-23.15}},{type:"body",mat:{a:-.3636016845703125,b:.02899169921875,c:.02899169921875,d:.3636016845703125,tx:-1.1,ty:-23.8}},{type:"static",bodypart:36,mat:{a:.39892578125,b:-.0318145751953125,c:.0318145751953125,d:.39892578125,tx:12.25,ty:-20.4}},{type:"static",bodypart:39,mat:{a:-.3636016845703125,b:.02899169921875,c:.02899169921875,d:.3636016845703125,tx:8,ty:-30.75}},{type:"static",bodypart:39,mat:{a:-.3636016845703125,b:.02899169921875,c:.02899169921875,d:.3636016845703125,tx:23.7,ty:-31.75}},{type:"anim",anim:2,offset:0,loop:!1,mat:{a:1,b:0,c:0,d:1,tx:-21.35,ty:-22.9}}],[{type:"static",bodypart:41,mat:{a:.211151123046875,b:-.2940673828125,c:-.300384521484375,d:-.2069244384765625,tx:-21.25,ty:-20.6}},{type:"body",mat:{a:.3636016845703125,b:.02899169921875,c:-.02899169921875,d:.3636016845703125,tx:1.5,ty:-23.8}},{type:"static",bodypart:1,mat:{a:-.399322509765625,b:-.0230865478515625,c:-.0230865478515625,d:.399322509765625,tx:-13,ty:-21.15}},{type:"static",bodypart:0,mat:{a:.3636016845703125,b:.02899169921875,c:-.02899169921875,d:.3636016845703125,tx:-19.45,ty:-31.5}},{type:"static",bodypart:0,mat:{a:-.3636016845703125,b:.02899169921875,c:-.02899169921875,d:.3636016845703125,tx:-5.4,ty:-30.5}},{type:"static",bodypart:41,mat:{a:.211151123046875,b:-.2940673828125,c:-.300384521484375,d:-.2069244384765625,tx:-1.35,ty:-17.85}}],[{type:"static",bodypart:41,mat:{a:-.211151123046875,b:-.2940673828125,c:.300384521484375,d:-.2069244384765625,tx:23.05,ty:-20.6}},{type:"body",mat:{a:-.3636016845703125,b:.02899169921875,c:.02899169921875,d:.3636016845703125,tx:-1.1,ty:-23.8}},{type:"static",bodypart:1,mat:{a:.399322509765625,b:-.0230865478515625,c:.0230865478515625,d:.399322509765625,tx:14.8,ty:-21.15}},{type:"static",bodypart:0,mat:{a:.3636016845703125,b:.02899169921875,c:.02899169921875,d:.3636016845703125,tx:7.2,ty:-30.5}},{type:"static",bodypart:0,mat:{a:-.3636016845703125,b:.02899169921875,c:.02899169921875,d:.3636016845703125,tx:21.25,ty:-31.5}},{type:"static",bodypart:41,mat:{a:-.211151123046875,b:-.2940673828125,c:.300384521484375,d:-.2069244384765625,tx:3.15,ty:-17.85}}],[{type:"static",bodypart:2,mat:{a:-.12213134765625,b:.343719482421875,c:-.343719482421875,d:-.12213134765625,tx:-21.4,ty:-20.9}},{type:"body",mat:{a:.3636016845703125,b:.02899169921875,c:-.02899169921875,d:.3636016845703125,tx:1.5,ty:-23.8}},{type:"static",bodypart:5,mat:{a:-.412109375,b:-.0328521728515625,c:-.024749755859375,d:.3104248046875,tx:-9.3,ty:-21.75}},{type:"static",bodypart:4,mat:{a:.3636016845703125,b:.02899169921875,c:-.02899169921875,d:.3636016845703125,tx:-20.8,ty:-32}},{type:"static",bodypart:4,mat:{a:.3636016845703125,b:.02899169921875,c:-.02899169921875,d:.3636016845703125,tx:-4.85,ty:-31}},{type:"static",bodypart:2,mat:{a:-.0661163330078125,b:-.358734130859375,c:.358734130859375,d:-.066131591796875,tx:20.35,ty:-18.1}}],[{type:"static",bodypart:2,mat:{a:.12213134765625,b:.343719482421875,c:.343719482421875,d:-.12213134765625,tx:22.4,ty:-20.9}},{type:"body",mat:{a:-.3636016845703125,b:.02899169921875,c:.02899169921875,d:.3636016845703125,tx:-.5,ty:-23.8}},{type:"static",bodypart:5,mat:{a:.412109375,b:-.0328521728515625,c:.024749755859375,d:.3104248046875,tx:10.3,ty:-21.75}},{type:"static",bodypart:4,mat:{a:-.3636016845703125,b:.02899169921875,c:.02899169921875,d:.3636016845703125,tx:5.85,ty:-31}},{type:"static",bodypart:4,mat:{a:-.3636016845703125,b:.02899169921875,c:.02899169921875,d:.3636016845703125,tx:21.8,ty:-32}},{type:"static",bodypart:2,mat:{a:.0661163330078125,b:-.358734130859375,c:-.358734130859375,d:-.066131591796875,tx:-19.35,ty:-18.1}}],[{type:"armroot",id:0,pos:{x:-19.4,y:-17.4}},{type:"body",mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:0,ty:-23.85}},{type:"static",bodypart:36,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-13.05,ty:-19.35}},{type:"static",bodypart:39,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-25.35,ty:-29.8}},{type:"static",bodypart:39,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-9.65,ty:-30.05}},{type:"armroot",id:1,pos:{x:19.2,y:-17.4}}],[{type:"armroot",id:0,pos:{x:19.2,y:-17.4}},{type:"body",mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:0,ty:-23.85}},{type:"static",bodypart:36,mat:{a:.400299072265625,b:0,c:0,d:.400299072265625,tx:11.6,ty:-19.35}},{type:"static",bodypart:39,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:9.65,ty:-30.05}},{type:"static",bodypart:39,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:25.35,ty:-29.8}},{type:"armroot",id:1,pos:{x:-19.4,y:-17.4}}],[{type:"armroot",id:0,pos:{x:19.2,y:-17.4}},{type:"armroot",id:1,pos:{x:-19.4,y:-17.4}},{type:"body",mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:0,ty:-23.85}}],[{type:"armroot",id:0,pos:{x:19.2,y:-17.4}},{type:"armroot",id:1,pos:{x:-19.4,y:-17.4}},{type:"body",mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:0,ty:-23.85}}]]},{torsomat:{a:1,b:0,c:0,d:1,tx:1.15,ty:-8.95},legx:[-5.55,8.8],legy:[-11.25,-11.25],firemat:{a:-.4046630859375,b:.0060882568359375,c:.006805419921875,d:.5772552490234375,tx:1.05,ty:-51.05},charimgmat:{a:.12158203125,b:-.0020751953125,c:.0037384033203125,d:.12152099609375,tx:.1,ty:.4},burstmat:{a:1.0688934326171875,b:0,c:0,d:1,tx:1.6,ty:-32.25},defaultExpr:1,mouthType:0,frames:[[{type:"anim",anim:0,offset:15,loop:!0,mat:{a:1,b:0,c:0,d:1,tx:-21.05,ty:-17.65}},{type:"body",mat:{a:.2847747802734375,b:-.0040130615234375,c:.0086822509765625,d:.285064697265625,tx:.35,ty:-26.65}},{type:"static",bodypart:0,mat:{a:-.375213623046875,b:.00494384765625,c:0,d:.375213623046875,tx:-9.05,ty:-30.6}},{type:"static",bodypart:0,mat:{a:-.37518310546875,b:.00494384765625,c:0,d:.375213623046875,tx:4.2,ty:-30.35}},{type:"static",bodypart:1,mat:{a:-.3180999755859375,b:.01141357421875,c:.022735595703125,d:.43402099609375,tx:-2.5,ty:-17.5}},{type:"anim",anim:0,offset:0,loop:!0,mat:{a:1,b:0,c:0,d:1,tx:17.95,ty:-17.65}}],[{type:"static",bodypart:2,mat:{a:.3733978271484375,b:.0712127685546875,c:-.0721435546875,d:.3782196044921875,tx:-21.35,ty:-16.9}},{type:"body",mat:{a:.2847747802734375,b:-.0040130615234375,c:.0086822509765625,d:.285064697265625,tx:.6,ty:-26.2}},{type:"static",bodypart:0,mat:{a:-.375213623046875,b:.00494384765625,c:0,d:.375213623046875,tx:-8.8,ty:-30.15}},{type:"static",bodypart:0,mat:{a:-.37518310546875,b:.00494384765625,c:0,d:.375213623046875,tx:4.45,ty:-29.8}},{type:"static",bodypart:2,mat:{a:-.3849334716796875,b:.0501251220703125,c:.0777587890625,d:.3766937255859375,tx:21.1,ty:-18.65}},{type:"dia",mat:{a:.886138916015625,b:0,c:0,d:.886138916015625,tx:-2.05,ty:-18.05}}],[{type:"anim",anim:0,offset:15,loop:!0,mat:{a:-1,b:0,c:0,d:1,tx:22.1,ty:-17.65}},{type:"body",mat:{a:.283721923828125,b:.0136260986328125,c:-.0087432861328125,d:.283905029296875,tx:.85,ty:-26.65}},{type:"static",bodypart:0,mat:{a:.37518310546875,b:.00494384765625,c:0,d:.375213623046875,tx:-4.2,ty:-30.25}},{type:"static",bodypart:0,mat:{a:.37518310546875,b:.00494384765625,c:0,d:.375213623046875,tx:9.05,ty:-30.6}},{type:"static",bodypart:1,mat:{a:.3180999755859375,b:.01141357421875,c:-.022735595703125,d:.43402099609375,tx:2.5,ty:-17.5}},{type:"anim",anim:0,offset:0,loop:!0,mat:{a:-1,b:0,c:0,d:1,tx:-17.95,ty:-17.65}}],[{type:"static",bodypart:2,mat:{a:-.3730010986328125,b:.071136474609375,c:.0718994140625,d:.3780364990234375,tx:21.2,ty:-16.8}},{type:"body",mat:{a:.2848052978515625,b:.003997802734375,c:-.0077362060546875,d:.2839813232421875,tx:-.3,ty:-26.2}},{type:"static",bodypart:0,mat:{a:.37518310546875,b:.00494384765625,c:0,d:.375213623046875,tx:-4.4,ty:-29.75}},{type:"static",bodypart:0,mat:{a:.37518310546875,b:.00494384765625,c:0,d:.375213623046875,tx:8.75,ty:-30.1}},{type:"static",bodypart:2,mat:{a:.3796844482421875,b:.0500335693359375,c:-.076751708984375,d:.3769683837890625,tx:-20.85,ty:-18.65}},{type:"dia",mat:{a:-.886138916015625,b:0,c:0,d:.886138916015625,tx:2.35,ty:-18.05}}],[{type:"anim",anim:1,offset:0,loop:!1,mat:{a:1,b:0,c:0,d:1,tx:-18.55,ty:-24.65}},{type:"body",mat:{a:.28375244140625,b:.0136871337890625,c:-.009918212890625,d:.2838592529296875,tx:1.9,ty:-26.75}},{type:"static",bodypart:0,mat:{a:-.37451171875,b:-.0196380615234375,c:-.0245208740234375,d:.374267578125,tx:-7.25,ty:-31.35}},{type:"static",bodypart:0,mat:{a:-.37451171875,b:-.0196380615234375,c:-.0245208740234375,d:.374267578125,tx:6,ty:-30.1}},{type:"static",bodypart:1,mat:{a:-.3180389404296875,b:-.0084075927734375,c:-.004058837890625,d:.310455322265625,tx:-1.55,ty:-17.8}},{type:"anim",anim:1,offset:0,loop:!1,mat:{a:-1,b:0,c:0,d:1,tx:21.4,ty:-24.65}}],[{type:"anim",anim:1,offset:0,loop:!1,mat:{a:-1,b:0,c:0,d:1,tx:21.4,ty:-24.65}},{type:"body",mat:{a:.2836456298828125,b:-.0136871337890625,c:.009918212890625,d:.2837677001953125,tx:.9,ty:-26.75}},{type:"static",bodypart:0,mat:{a:.37451171875,b:-.0196380615234375,c:.0245208740234375,d:.374267578125,tx:-3.2,ty:-30.1}},{type:"static",bodypart:0,mat:{a:.37451171875,b:-.0196380615234375,c:.0245208740234375,d:.374267578125,tx:10.05,ty:-31.35}},{type:"static",bodypart:1,mat:{a:.3180389404296875,b:-.0084075927734375,c:.004058837890625,d:.310455322265625,tx:4.35,ty:-17.8}},{type:"anim",anim:1,offset:0,loop:!1,mat:{a:1,b:0,c:0,d:1,tx:-18.55,ty:-24.65}}],[{type:"static",bodypart:3,mat:{a:-.0284576416015625,b:-.457672119140625,c:-.385009765625,d:.023651123046875,tx:-17.15,ty:-21.15}},{type:"body",mat:{a:.28375244140625,b:.0136871337890625,c:-.009918212890625,d:.2838592529296875,tx:1.9,ty:-26.75}},{type:"static",bodypart:0,mat:{a:-.37451171875,b:-.0196380615234375,c:-.0245208740234375,d:.374267578125,tx:-7.25,ty:-31.35}},{type:"static",bodypart:0,mat:{a:-.37451171875,b:-.0196380615234375,c:-.0245208740234375,d:.374267578125,tx:6,ty:-30.1}},{type:"static",bodypart:1,mat:{a:-.3180389404296875,b:-.0084075927734375,c:-.004058837890625,d:.310455322265625,tx:-1.55,ty:-17.8}},{type:"static",bodypart:3,mat:{a:-.02813720703125,b:-.4629669189453125,c:-.386383056640625,d:.0238037109375,tx:9.25,ty:-19.75}}],[{type:"static",bodypart:3,mat:{a:.0284576416015625,b:-.457672119140625,c:.385009765625,d:.023651123046875,tx:16.9,ty:-21.25}},{type:"body",mat:{a:.28363037109375,b:-.0136871337890625,c:.009918212890625,d:.28375244140625,tx:-2.3,ty:-26.75}},{type:"static",bodypart:0,mat:{a:.37451171875,b:-.0196380615234375,c:.0245208740234375,d:.374267578125,tx:-6.4,ty:-30.1}},{type:"static",bodypart:0,mat:{a:.37451171875,b:-.0196380615234375,c:.0245208740234375,d:.374267578125,tx:6.85,ty:-31.35}},{type:"static",bodypart:1,mat:{a:.3180389404296875,b:-.0084075927734375,c:.004058837890625,d:.310455322265625,tx:1.15,ty:-17.8}},{type:"static",bodypart:3,mat:{a:.02813720703125,b:-.46295166015625,c:.386383056640625,d:.0238037109375,tx:-9.5,ty:-19.75}}],[{type:"static",bodypart:2,mat:{a:-.26220703125,b:.2750244140625,c:-.2784881591796875,d:-.2655029296875,tx:-20.2,ty:-24.1}},{type:"body",mat:{a:.283966064453125,b:.0086822509765625,c:-.00372314453125,d:.28411865234375,tx:1.5,ty:-25.95}},{type:"static",bodypart:4,mat:{a:-.37493896484375,b:-.011810302734375,c:-.016754150390625,d:.3746490478515625,tx:-7.6,ty:-30.4}},{type:"static",bodypart:4,mat:{a:-.3749237060546875,b:-.011810302734375,c:-.016448974609375,d:.3746795654296875,tx:5.6,ty:-29.45}},{type:"static",bodypart:5,mat:{a:-.3182525634765625,b:-.0028076171875,c:.0003204345703125,d:.3105926513671875,tx:-.7,ty:-18.75}},{type:"static",bodypart:2,mat:{a:.21820068359375,b:.313629150390625,c:.29925537109375,d:-.2410430908203125,tx:21.95,ty:-24.25}}],[{type:"static",bodypart:2,mat:{a:.26220703125,b:.2750244140625,c:.2784881591796875,d:-.2655029296875,tx:20.6,ty:-24.5}},{type:"body",mat:{a:.2838592529296875,b:-.0077362060546875,c:.0037994384765625,d:.284027099609375,tx:-1.2,ty:-26.4}},{type:"static",bodypart:4,mat:{a:.3748626708984375,b:-.0118255615234375,c:.0179901123046875,d:.374542236328125,tx:-5.2,ty:-29.85}},{type:"static",bodypart:4,mat:{a:.3748779296875,b:.011810302734375,c:.0179901123046875,d:.3745269775390625,tx:8,ty:-30.8}},{type:"static",bodypart:5,mat:{a:.3182220458984375,b:-.0028076171875,c:-.0013580322265625,d:.3105621337890625,tx:1.1,ty:-19.15}},{type:"static",bodypart:2,mat:{a:-.21820068359375,b:.313629150390625,c:-.29925537109375,d:-.2410430908203125,tx:-21.2,ty:-24.75}}],[{type:"armroot",id:0,pos:{x:-21.1,y:-17.05}},{type:"body",mat:{a:.2847747802734375,b:-.0040130615234375,c:.0086822509765625,d:.285064697265625,tx:.6,ty:-26.2}},{type:"static",bodypart:0,mat:{a:-.375213623046875,b:.00494384765625,c:0,d:.375213623046875,tx:-8.8,ty:-30.15}},{type:"static",bodypart:0,mat:{a:-.37518310546875,b:.00494384765625,c:0,d:.375213623046875,tx:4.45,ty:-29.9}},{type:"static",bodypart:1,mat:{a:-.3180999755859375,b:.01141357421875,c:.022735595703125,d:.43402099609375,tx:-2.25,ty:-17.05}},{type:"armroot",id:1,pos:{x:21.5,y:-17.05}}],[{type:"armroot",id:0,pos:{x:22.1,y:-17.05}},{type:"body",mat:{a:.28399658203125,b:.00396728515625,c:-.008697509765625,d:.2838592529296875,tx:.25,ty:-26.2}},{type:"static",bodypart:0,mat:{a:.37518310546875,b:.00494384765625,c:0,d:.375213623046875,tx:-3.45,ty:-29.8}},{type:"static",bodypart:0,mat:{a:.37518310546875,b:.00494384765625,c:0,d:.375213623046875,tx:9.8,ty:-30.15}},{type:"static",bodypart:1,mat:{a:.3180999755859375,b:.01141357421875,c:-.022735595703125,d:.43402099609375,tx:3.25,ty:-17.05}},{type:"armroot",id:1,pos:{x:-20.5,y:-17.05}}],[{type:"armroot",id:0,pos:{x:22.1,y:-17.05}},{type:"armroot",id:1,pos:{x:-20.5,y:-17.05}},{type:"body",mat:{a:-.28411865234375,b:152587890625e-16,c:-.0037078857421875,d:.2840576171875,tx:.4,ty:-26.2}}],[{type:"armroot",id:0,pos:{x:22.1,y:-17.05}},{type:"armroot",id:1,pos:{x:-20.5,y:-17.05}},{type:"body",mat:{a:-.28411865234375,b:152587890625e-16,c:-.0037078857421875,d:.2840576171875,tx:.4,ty:-26.2}}]]},{torsomat:{a:1,b:0,c:0,d:1,tx:-.05,ty:-4.6},legx:[-5.55,8.8],legy:[-11.25,-11.25],firemat:{a:.8855438232421875,b:0,c:0,d:1,tx:2.05,ty:0},charimgmat:{a:.14532470703125,b:-.00250244140625,c:.00445556640625,d:.1452484130859375,tx:-.3,ty:.5},burstmat:{a:1,b:0,c:0,d:.8679046630859375,tx:.6,ty:-27.95},defaultExpr:1,mouthType:0,frames:[[{type:"body",mat:{a:.319091796875,b:-.0054779052734375,c:.009796142578125,d:.3189697265625,tx:.35,ty:-26.65}},{type:"static",bodypart:39,mat:{a:-.375244140625,b:.0051116943359375,c:0,d:.375244140625,tx:-17.4,ty:-30}},{type:"static",bodypart:1,mat:{a:-.318145751953125,b:.0123748779296875,c:.01629638671875,d:.31024169921875,tx:-11.3,ty:-18.55}}],[{type:"body",mat:{a:.31939697265625,b:-.005462646484375,c:.0098114013671875,d:.3192596435546875,tx:-.05,ty:-26.6}},{type:"static",bodypart:39,mat:{a:-.375244140625,b:.0051116943359375,c:0,d:.375244140625,tx:-17.75,ty:-29.55}},{type:"dia",mat:{a:.759613037109375,b:0,c:0,d:.759613037109375,tx:-11.75,ty:-19.85}}],[{type:"body",mat:{a:-.319091796875,b:-.0054779052734375,c:-.009796142578125,d:.3189697265625,tx:-.45,ty:-26.65}},{type:"static",bodypart:39,mat:{a:.375244140625,b:.0051116943359375,c:0,d:.375244140625,tx:17.3,ty:-30}},{type:"static",bodypart:1,mat:{a:.318145751953125,b:.0123748779296875,c:-.01629638671875,d:.31024169921875,tx:11.2,ty:-18.55}}],[{type:"body",mat:{a:-.31939697265625,b:-.005462646484375,c:-.0098114013671875,d:.3192596435546875,tx:1.05,ty:-26.6}},{type:"static",bodypart:39,mat:{a:.375244140625,b:.0051116943359375,c:0,d:.375244140625,tx:18.75,ty:-29.55}},{type:"dia",mat:{a:-.759613037109375,b:0,c:0,d:.759613037109375,tx:12.75,ty:-19.85}}],[{type:"body",mat:{a:.3189697265625,b:.0085296630859375,c:-.00421142578125,d:.31903076171875,tx:.6,ty:-26.6}},{type:"static",bodypart:39,mat:{a:-.3750457763671875,b:-.0113525390625,c:-.0164642333984375,d:.37481689453125,tx:-16.95,ty:-30.7}},{type:"static",bodypart:1,mat:{a:-.318328857421875,b:-.0016021728515625,c:.002655029296875,d:.31060791015625,tx:-11.35,ty:-19}}],[{type:"body",mat:{a:-.3189697265625,b:.0085296630859375,c:.00421142578125,d:.31903076171875,tx:-.7,ty:-26.6}},{type:"static",bodypart:39,mat:{a:.3750457763671875,b:-.0113525390625,c:.0164642333984375,d:.37481689453125,tx:16.85,ty:-30.7}},{type:"static",bodypart:1,mat:{a:.318328857421875,b:-.0016021728515625,c:-.002655029296875,d:.31060791015625,tx:11.25,ty:-19}}],[],[],[{type:"body",mat:{a:.31939697265625,b:-.005462646484375,c:.0098114013671875,d:.3192596435546875,tx:-.05,ty:-26.6}},{type:"static",bodypart:40,mat:{a:-.375244140625,b:.0051116943359375,c:0,d:.375244140625,tx:-16.85,ty:-28}},{type:"static",bodypart:5,mat:{a:-.318145751953125,b:.0123748779296875,c:.01629638671875,d:.31024169921875,tx:-11.4,ty:-19.15}}],[{type:"body",mat:{a:-.31939697265625,b:-.005462646484375,c:-.0098114013671875,d:.3192596435546875,tx:1.6,ty:-26.6}},{type:"static",bodypart:40,mat:{a:.375244140625,b:.0051116943359375,c:0,d:.375244140625,tx:18.4,ty:-28}},{type:"static",bodypart:5,mat:{a:.318145751953125,b:.0123748779296875,c:-.01629638671875,d:.31024169921875,tx:12.95,ty:-19.15}}],[],[],[],[]]},{torsomat:{a:.9517822265625,b:0,c:0,d:.9517822265625,tx:.4,ty:-8.95},legx:[-2.45,5.1],legy:[-11.25,-11.25],firemat:{a:-.1956634521484375,b:.0030975341796875,c:.0032806396484375,d:.2937164306640625,tx:1.05,ty:-94},charimgmat:{a:.1161346435546875,b:0,c:0,d:.1161346435546875,tx:-.15,ty:.2},burstmat:{a:.5277099609375,b:0,c:0,d:1.2281951904296875,tx:.6,ty:-41},defaultExpr:0,mouthType:0,frames:[[{type:"anim",anim:0,offset:15,loop:!0,mat:{a:1,b:0,c:0,d:1,tx:-6.1,ty:-22.1}},{type:"body",mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:.05,ty:-41.75}},{type:"static",bodypart:0,mat:{a:-.3351287841796875,b:0,c:0,d:.3351287841796875,tx:-3.6,ty:-39.6}},{type:"static",bodypart:36,mat:{a:-.194427490234375,b:0,c:0,d:.329345703125,tx:-1.4,ty:-29.45}},{type:"anim",anim:0,offset:0,loop:!0,mat:{a:1,b:0,c:0,d:1,tx:5.95,ty:-22.65}}],[{type:"static",bodypart:2,mat:{a:-.322235107421875,b:-.090789794921875,c:-.090789794921875,d:.322235107421875,tx:-5.6,ty:-19.95}},{type:"body",mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:.05,ty:-40.85}},{type:"static",bodypart:0,mat:{a:-.3351287841796875,b:0,c:0,d:.3351287841796875,tx:-3.6,ty:-38.7}},{type:"static",bodypart:2,mat:{a:-.313751220703125,b:.1172332763671875,c:.1172332763671875,d:.313751220703125,tx:4.65,ty:-20.1}},{type:"dia",mat:{a:.4889373779296875,b:0,c:0,d:.9688720703125,tx:-.8,ty:-28.85}}],[{type:"anim",anim:0,offset:15,loop:!0,mat:{a:-1,b:0,c:0,d:1,tx:7.5,ty:-22.65}},{type:"body",mat:{a:-.3351287841796875,b:0,c:0,d:.3351287841796875,tx:.05,ty:-41.75}},{type:"static",bodypart:0,mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:5,ty:-39.6}},{type:"static",bodypart:36,mat:{a:.194427490234375,b:0,c:0,d:.329345703125,tx:2.8,ty:-29.45}},{type:"anim",anim:0,offset:0,loop:!0,mat:{a:-1,b:0,c:0,d:1,tx:-4.55,ty:-22.65}}],[{type:"static",bodypart:2,mat:{a:.322235107421875,b:-.090789794921875,c:.090789794921875,d:.322235107421875,tx:6.2,ty:-19.95}},{type:"body",mat:{a:-.3351287841796875,b:0,c:0,d:.3351287841796875,tx:.55,ty:-40.85}},{type:"static",bodypart:0,mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:4.2,ty:-38.7}},{type:"static",bodypart:2,mat:{a:.313751220703125,b:.1172332763671875,c:-.1172332763671875,d:.313751220703125,tx:-4.05,ty:-20.1}},{type:"dia",mat:{a:-.4889373779296875,b:0,c:0,d:.9688720703125,tx:1.4,ty:-28.85}}],[{type:"anim",anim:2,offset:0,loop:!1,mat:{a:.999664306640625,b:-.022705078125,c:.022705078125,d:.999664306640625,tx:-3.05,ty:-25.7}},{type:"body",mat:{a:.33477783203125,b:.0128631591796875,c:-.0128631591796875,d:.33477783203125,tx:2.45,ty:-41.05}},{type:"static",bodypart:0,mat:{a:-.33477783203125,b:-.0128631591796875,c:-.0128631591796875,d:.33477783203125,tx:-1.3,ty:-39.05}},{type:"static",bodypart:37,mat:{a:-.194244384765625,b:-.0074615478515625,c:-.0112762451171875,d:.2929840087890625,tx:.55,ty:-28.7}},{type:"anim",anim:2,offset:0,loop:!1,mat:{a:-.999664306640625,b:.022705078125,c:.022705078125,d:.999664306640625,tx:6.7,ty:-25.1}}],[{type:"anim",anim:2,offset:0,loop:!1,mat:{a:-.999755859375,b:-.01812744140625,c:-.01812744140625,d:.999755859375,tx:5.05,ty:-25.2}},{type:"body",mat:{a:-.334716796875,b:.014404296875,c:.014404296875,d:.334716796875,tx:-.5,ty:-40.5}},{type:"static",bodypart:0,mat:{a:.334716796875,b:-.014404296875,c:.014404296875,d:.334716796875,tx:3.25,ty:-38.55}},{type:"static",bodypart:37,mat:{a:.1941986083984375,b:-.0083465576171875,c:.012603759765625,d:.2929229736328125,tx:1.45,ty:-28.2}},{type:"anim",anim:2,offset:0,loop:!1,mat:{a:.999755859375,b:.01812744140625,c:-.01812744140625,d:.999755859375,tx:-4.65,ty:-24.6}}],[{type:"static",bodypart:3,mat:{a:.02471923828125,b:-.3337860107421875,c:-.3337860107421875,d:-.0247039794921875,tx:-3.5,ty:-20.2}},{type:"body",mat:{a:.3344268798828125,b:.0204620361328125,c:-.0204620361328125,d:.3344268798828125,tx:3.4,ty:-40.75}},{type:"static",bodypart:38,mat:{a:-.19403076171875,b:-.011871337890625,c:-.017913818359375,d:.29266357421875,tx:1.2,ty:-28.45}},{type:"static",bodypart:39,mat:{a:-.3344268798828125,b:-.0204620361328125,c:-.0204620361328125,d:.3344268798828125,tx:-.4,ty:-38.85}},{type:"static",bodypart:3,mat:{a:.02471923828125,b:-.3337860107421875,c:-.3337860107421875,d:-.0247039794921875,tx:7.25,ty:-20.2}}],[{type:"static",bodypart:3,mat:{a:-.02471923828125,b:-.3337860107421875,c:.3337860107421875,d:-.0247039794921875,tx:5.55,ty:-20.2}},{type:"body",mat:{a:-.3344268798828125,b:.0204620361328125,c:.0204620361328125,d:.3344268798828125,tx:-1.35,ty:-40.75}},{type:"static",bodypart:38,mat:{a:.19403076171875,b:-.011871337890625,c:.017913818359375,d:.29266357421875,tx:.85,ty:-28.45}},{type:"static",bodypart:39,mat:{a:.33441162109375,b:-.0204620361328125,c:.0204620361328125,d:.33441162109375,tx:2.45,ty:-38.85}},{type:"static",bodypart:3,mat:{a:-.02471923828125,b:-.3337860107421875,c:.3337860107421875,d:-.0247039794921875,tx:-5.2,ty:-20.2}}],[{type:"static",bodypart:3,mat:{a:.247894287109375,b:-.2249298095703125,c:-.2249298095703125,d:-.247894287109375,tx:-4.9,ty:-20.15}},{type:"body",mat:{a:.334869384765625,b:.011962890625,c:-.011962890625,d:.334869384765625,tx:1.5,ty:-40.85}},{type:"static",bodypart:5,mat:{a:-.19427490234375,b:-.0069427490234375,c:-.011749267578125,d:.3291015625,tx:-.05,ty:-30.75}},{type:"static",bodypart:4,mat:{a:-.334869384765625,b:-.011962890625,c:-.011962890625,d:.334869384765625,tx:-1.95,ty:-41.55}},{type:"static",bodypart:3,mat:{a:-.1793365478515625,b:-.380706787109375,c:.3028411865234375,d:-.1426544189453125,tx:5.35,ty:-20}}],[{type:"static",bodypart:3,mat:{a:-.247894287109375,b:-.2249298095703125,c:.2249298095703125,d:-.247894287109375,tx:5.95,ty:-20.15}},{type:"body",mat:{a:-.334869384765625,b:.011962890625,c:.011962890625,d:.334869384765625,tx:-.45,ty:-40.85}},{type:"static",bodypart:5,mat:{a:.19427490234375,b:-.0069427490234375,c:.011749267578125,d:.3291015625,tx:1.1,ty:-30.75}},{type:"static",bodypart:4,mat:{a:.334869384765625,b:-.011962890625,c:.011962890625,d:.334869384765625,tx:3,ty:-41.55}},{type:"static",bodypart:3,mat:{a:.1793365478515625,b:-.380706787109375,c:-.3028411865234375,d:-.1426544189453125,tx:-4.3,ty:-20}}],[{type:"armroot",id:0,pos:{x:-6.15,y:-20.1}},{type:"body",mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:.05,ty:-40.85}},{type:"static",bodypart:0,mat:{a:-.3351287841796875,b:0,c:0,d:.3351287841796875,tx:-3.6,ty:-38.7}},{type:"static",bodypart:36,mat:{a:-.194427490234375,b:0,c:0,d:.329345703125,tx:-1.4,ty:-28.55}},{type:"armroot",id:1,pos:{x:5.4,y:-20.1}}],[{type:"armroot",id:0,pos:{x:6.75,y:-20.1}},{type:"body",mat:{a:-.3351287841796875,b:0,c:0,d:.3351287841796875,tx:.55,ty:-40.85}},{type:"static",bodypart:0,mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:4.2,ty:-38.7}},{type:"static",bodypart:36,mat:{a:.194427490234375,b:0,c:0,d:.329345703125,tx:2,ty:-28.55}},{type:"armroot",id:1,pos:{x:-4.8,y:-20.1}}],[{type:"armroot",id:0,pos:{x:-6.15,y:-20.1}},{type:"armroot",id:1,pos:{x:7.2,y:-20.1}},{type:"body",mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:.2,ty:-40.85}},{type:"static",bodypart:0,mat:{a:-.20111083984375,b:0,c:0,d:.3351287841796875,tx:-5.15,ty:-38.7}},{type:"static",bodypart:36,mat:{a:-.1166839599609375,b:0,c:0,d:.329345703125,tx:-3.8,ty:-28.55}}],[{type:"armroot",id:0,pos:{x:6.9,y:-20.1}},{type:"armroot",id:1,pos:{x:-6.3,y:-20.1}},{type:"body",mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:.1,ty:-40.85}},{type:"static",bodypart:0,mat:{a:.20111083984375,b:0,c:0,d:.3351287841796875,tx:5.8,ty:-38.7}},{type:"static",bodypart:36,mat:{a:.1166839599609375,b:0,c:0,d:.329345703125,tx:4.45,ty:-28.55}}]]},{torsomat:{a:.9736328125,b:0,c:0,d:.9736328125,tx:-.2,ty:-8.75},legx:[-2.45,5.1],legy:[-11.25,-11.25],firemat:{a:-.16912841796875,b:.0142822265625,c:.031341552734375,d:.6383819580078125,tx:-3.65,ty:-58.2},charimgmat:{a:.10894775390625,b:-.003753662109375,c:.003753662109375,d:.10894775390625,tx:-.2,ty:-1.4},burstmat:{a:.557373046875,b:0,c:0,d:1.2081451416015625,tx:-2.65,ty:-42.2},defaultExpr:0,mouthType:0,frames:[[{type:"anim",anim:0,offset:15,loop:!0,mat:{a:1,b:0,c:0,d:1,tx:-4.55,ty:-20.4}},{type:"body",mat:{a:.333160400390625,b:-.035125732421875,c:.035125732421875,d:.333160400390625,tx:-2.5,ty:-39.2}},{type:"static",bodypart:0,mat:{a:-.333160400390625,b:.035125732421875,c:.035125732421875,d:.333160400390625,tx:-7.1,ty:-36.05}},{type:"static",bodypart:36,mat:{a:-.1932830810546875,b:.0203857421875,c:.034515380859375,d:.327423095703125,tx:-3.85,ty:-26.2}},{type:"anim",anim:0,offset:0,loop:!0,mat:{a:1,b:0,c:0,d:1,tx:5.95,ty:-20.4}}],[{type:"static",bodypart:2,mat:{a:-.322235107421875,b:-.090789794921875,c:-.090789794921875,d:.322235107421875,tx:-5.25,ty:-18.95}},{type:"body",mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:1.4,ty:-39.85}},{type:"static",bodypart:0,mat:{a:-.3351287841796875,b:0,c:0,d:.3351287841796875,tx:-3.25,ty:-37.2}},{type:"static",bodypart:2,mat:{a:-.313751220703125,b:.1172332763671875,c:.1172332763671875,d:.313751220703125,tx:6.5,ty:-19.1}},{type:"dia",mat:{a:.555206298828125,b:0,c:0,d:.8481903076171875,tx:-.25,ty:-27.2}}],[{type:"anim",anim:0,offset:15,loop:!0,mat:{a:-1,b:0,c:0,d:1,tx:7.45,ty:-20.4}},{type:"body",mat:{a:-.333160400390625,b:-.035125732421875,c:-.035125732421875,d:.333160400390625,tx:5.4,ty:-39.2}},{type:"static",bodypart:0,mat:{a:.333160400390625,b:.035125732421875,c:-.035125732421875,d:.333160400390625,tx:10,ty:-36.05}},{type:"static",bodypart:36,mat:{a:.1932830810546875,b:.0203857421875,c:-.034515380859375,d:.327423095703125,tx:6.75,ty:-26.2}},{type:"anim",anim:0,offset:0,loop:!0,mat:{a:-1,b:0,c:0,d:1,tx:-3.05,ty:-20.4}}],[{type:"static",bodypart:2,mat:{a:.322235107421875,b:-.090789794921875,c:.090789794921875,d:.322235107421875,tx:7.45,ty:-18.95}},{type:"body",mat:{a:-.3351287841796875,b:0,c:0,d:.3351287841796875,tx:.8,ty:-39.85}},{type:"static",bodypart:0,mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:4.2,ty:-38.7}},{type:"static",bodypart:2,mat:{a:.313751220703125,b:.1172332763671875,c:-.1172332763671875,d:.313751220703125,tx:-4.3,ty:-19.1}},{type:"dia",mat:{a:-.555206298828125,b:0,c:0,d:.8481903076171875,tx:2.45,ty:-27.2}}],[{type:"anim",anim:2,offset:0,loop:!1,mat:{a:.9993896484375,b:-.0311737060546875,c:.0311737060546875,d:.9993896484375,tx:-4.05,ty:-24.5}},{type:"body",mat:{a:.334869384765625,b:.0100250244140625,c:-.0100250244140625,d:.334869384765625,tx:2.45,ty:-39.9}},{type:"static",bodypart:0,mat:{a:-.334869384765625,b:-.0100250244140625,c:-.0100250244140625,d:.334869384765625,tx:-2.4,ty:-37.85}},{type:"static",bodypart:37,mat:{a:-.19427490234375,b:-.005828857421875,c:-.0087738037109375,d:.293060302734375,tx:-.5,ty:-27.5}},{type:"anim",anim:2,offset:0,loop:!1,mat:{a:-.9993896484375,b:.0311737060546875,c:.0311737060546875,d:.9993896484375,tx:5.7,ty:-24}}],[{type:"anim",anim:2,offset:0,loop:!1,mat:{a:-.9992523193359375,b:-.0352020263671875,c:-.0352020263671875,d:.9992523193359375,tx:6.75,ty:-24.55}},{type:"body",mat:{a:-.33489990234375,b:.0086669921875,c:.0086669921875,d:.33489990234375,tx:.35,ty:-39.9}},{type:"static",bodypart:0,mat:{a:.33489990234375,b:-.0086669921875,c:.0086669921875,d:.33489990234375,tx:5.15,ty:-37.85}},{type:"static",bodypart:37,mat:{a:.1942901611328125,b:-.0050201416015625,c:.007598876953125,d:.2930755615234375,tx:3.2,ty:-27.55}},{type:"anim",anim:2,offset:0,loop:!1,mat:{a:.9992523193359375,b:.0352020263671875,c:-.0352020263671875,d:.9992523193359375,tx:-3,ty:-24.05}}],[{type:"static",bodypart:3,mat:{a:.02471923828125,b:-.3337860107421875,c:-.3337860107421875,d:-.0247039794921875,tx:-4.45,ty:-20.75}},{type:"body",mat:{a:.3344268798828125,b:.0204620361328125,c:-.0204620361328125,d:.3344268798828125,tx:3.4,ty:-39.75}},{type:"static",bodypart:1,mat:{a:-.19403076171875,b:-.011871337890625,c:-.017913818359375,d:.29266357421875,tx:.2,ty:-27.2}},{type:"static",bodypart:0,mat:{a:-.3344268798828125,b:-.0204620361328125,c:-.0204620361328125,d:.3344268798828125,tx:-1.15,ty:-37.85}},{type:"static",bodypart:3,mat:{a:.02471923828125,b:-.3337860107421875,c:-.3337860107421875,d:-.0247039794921875,tx:6.35,ty:-20.75}}],[{type:"static",bodypart:3,mat:{a:-.02471923828125,b:-.3337860107421875,c:.3337860107421875,d:-.0247039794921875,tx:6.4,ty:-20.75}},{type:"body",mat:{a:-.3344268798828125,b:.0204620361328125,c:.0204620361328125,d:.3344268798828125,tx:-1.45,ty:-39.75}},{type:"static",bodypart:1,mat:{a:.19403076171875,b:-.011871337890625,c:.017913818359375,d:.29266357421875,tx:1.75,ty:-27.2}},{type:"static",bodypart:0,mat:{a:.3344268798828125,b:-.0204620361328125,c:.0204620361328125,d:.3344268798828125,tx:3.1,ty:-37.85}},{type:"static",bodypart:3,mat:{a:-.02471923828125,b:-.3337860107421875,c:.3337860107421875,d:-.0247039794921875,tx:-4.4,ty:-20.75}}],[{type:"anim",anim:3,offset:0,loop:!0,mat:{a:.2680206298828125,b:-.1997222900390625,c:-.1997222900390625,d:-.2680206298828125,tx:-5.7,ty:-23.55}},{type:"body",mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:.95,ty:-39.85}},{type:"static",bodypart:5,mat:{a:-.194427490234375,b:0,c:0,d:.329345703125,tx:-1.75,ty:-27.05}},{type:"static",bodypart:40,mat:{a:-.3351287841796875,b:0,c:0,d:.3351287841796875,tx:-3.7,ty:-37.2}},{type:"anim",anim:3,offset:0,loop:!0,mat:{a:-.2680206298828125,b:-.1997222900390625,c:.1997222900390625,d:-.2680206298828125,tx:5.75,ty:-25.4}}],[{type:"anim",anim:3,offset:0,loop:!0,bodypart:3,mat:{a:-.2680206298828125,b:-.1997222900390625,c:.1997222900390625,d:-.2680206298828125,tx:6.8,ty:-23.55}},{type:"body",mat:{a:-.3351287841796875,b:0,c:0,d:.3351287841796875,tx:.15,ty:-39.85}},{type:"static",bodypart:5,mat:{a:.194427490234375,b:0,c:0,d:.329345703125,tx:2.85,ty:-27.05}},{type:"static",bodypart:40,mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:4.8,ty:-37.2}},{type:"anim",anim:3,offset:0,loop:!0,bodypart:3,mat:{a:.2680206298828125,b:-.1997222900390625,c:-.1997222900390625,d:-.2680206298828125,tx:-4.65,ty:-25.4}}],[{type:"armroot",id:0,pos:{x:-6.4,y:-21.2}},{type:"body",mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:.8,ty:-40.1}},{type:"static",bodypart:0,mat:{a:-.3351287841796875,b:0,c:0,d:.3351287841796875,tx:-3.85,ty:-37.95}},{type:"static",bodypart:36,mat:{a:-.194427490234375,b:0,c:0,d:.329345703125,tx:-1.65,ty:-27.8}},{type:"armroot",id:1,pos:{x:5.65,y:-21.2}}],[{type:"armroot",id:0,pos:{x:8.55,y:-21.2}},{type:"body",mat:{a:-.3351287841796875,b:0,c:0,d:.3351287841796875,tx:1.35,ty:-40.1}},{type:"static",bodypart:0,mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:6,ty:-37.95}},{type:"static",bodypart:36,mat:{a:.194427490234375,b:0,c:0,d:.329345703125,tx:3.8,ty:-27.8}},{type:"armroot",id:1,pos:{x:-3.5,y:-21.2}}],[{type:"armroot",id:0,pos:{x:-6.4,y:-21.2}},{type:"armroot",id:1,pos:{x:8,y:-21.2}},{type:"body",mat:{a:.3351287841796875,b:0,c:0,d:.3351287841796875,tx:.8,ty:-40.1}},{type:"static",bodypart:0,mat:{a:-.17022705078125,b:0,c:0,d:.3351287841796875,tx:-5.35,ty:-38.25}},{type:"static",bodypart:36,mat:{a:-.0987548828125,b:0,c:0,d:.329345703125,tx:-4.25,ty:-28.1}}],[{type:"armroot",id:0,pos:{x:8.55,y:-20.45}},{type:"armroot",id:1,pos:{x:-5.85,y:-20.45}},{type:"body",mat:{a:-.3351287841796875,b:0,c:0,d:.3351287841796875,tx:1.35,ty:-40.1}},{type:"static",bodypart:0,mat:{a:.20745849609375,b:0,c:0,d:.3351287841796875,tx:6.7,ty:-37.95}},{type:"static",bodypart:36,mat:{a:.120361328125,b:0,c:0,d:.329345703125,tx:5.35,ty:-27.8}}]]},{torsomat:{a:.87811279296875,b:0,c:0,d:.87811279296875,tx:-.7,ty:-3},legx:[-5.1,10.85],legy:[-11.25,-11.25],firemat:{a:1,b:0,c:0,d:1,tx:0,ty:0},charimgmat:{a:.126861572265625,b:0,c:0,d:.126861572265625,tx:-.1,ty:-.3},burstmat:{a:1.35589599609375,b:0,c:0,d:1.2286834716796875,tx:1.8,ty:-39.65},defaultExpr:0,mouthType:0,frames:[[{type:"anim",anim:0,offset:15,loop:!0,mat:{a:1,b:0,c:0,d:1,tx:-26.55,ty:-24.15}},{type:"body",mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:2.9,ty:-42}},{type:"static",bodypart:36,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-15.75,ty:-28.25}},{type:"static",bodypart:0,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-9.25,ty:-44.2}},{type:"static",bodypart:0,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-24.95,ty:-43.95}},{type:"anim",anim:0,offset:0,loop:!0,mat:{a:1,b:0,c:0,d:1,tx:20.95,ty:-26.15}}],[{type:"static",bodypart:2,mat:{a:-.3739166259765625,b:-.0296478271484375,c:-.02886962890625,d:.3636322021484375,tx:-26.25,ty:-23.9}},{type:"body",mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:2.35,ty:-42}},{type:"dia",mat:{a:1,b:0,c:0,d:1,tx:-14.9,ty:-27.95}},{type:"static",bodypart:0,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-9.8,ty:-44.2}},{type:"static",bodypart:0,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-25.5,ty:-43.95}},{type:"static",bodypart:2,mat:{a:-.3738250732421875,b:.0201416015625,c:.0196075439453125,d:.3635406494140625,tx:23.75,ty:-23.85}}],[{type:"anim",anim:0,offset:15,loop:!0,mat:{a:-1,b:0,c:0,d:1,tx:32.2,ty:-24.15}},{type:"body",mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:2.75,ty:-42}},{type:"static",bodypart:36,mat:{a:.400299072265625,b:0,c:0,d:.400299072265625,tx:21.4,ty:-28.25}},{type:"static",bodypart:0,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:30.6,ty:-43.95}},{type:"static",bodypart:0,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:14.9,ty:-44.2}},{type:"anim",anim:0,offset:0,loop:!0,mat:{a:-1,b:0,c:0,d:1,tx:-15.3,ty:-26.15}}],[{type:"static",bodypart:2,mat:{a:.3739166259765625,b:-.0296478271484375,c:.02886962890625,d:.3636322021484375,tx:31.4,ty:-23.9}},{type:"body",mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:2.8,ty:-42}},{type:"dia",mat:{a:-1,b:0,c:0,d:1,tx:20.05,ty:-27.95}},{type:"static",bodypart:0,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:30.6,ty:-43.95}},{type:"static",bodypart:0,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:14.9,ty:-44.2}},{type:"static",bodypart:2,mat:{a:.3738250732421875,b:.0201416015625,c:-.0196075439453125,d:.3635406494140625,tx:-18.6,ty:-23.85}}],[{type:"anim",anim:1,offset:0,loop:!1,mat:{a:1,b:0,c:0,d:1,tx:-30.9,ty:-34.05}},{type:"body",mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:1.9,ty:-42}},{type:"static",bodypart:36,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-16.75,ty:-28.25}},{type:"static",bodypart:0,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-25.95,ty:-43.95}},{type:"static",bodypart:0,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-10.25,ty:-44.2}},{type:"anim",anim:1,offset:0,loop:!1,mat:{a:-1,b:0,c:0,d:1,tx:18.65,ty:-34.6}}],[{type:"anim",anim:1,offset:0,loop:!1,mat:{a:-1,b:0,c:0,d:1,tx:35.4,ty:-34.05}},{type:"body",mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:2.6,ty:-42}},{type:"static",bodypart:36,mat:{a:.400299072265625,b:0,c:0,d:.400299072265625,tx:21.25,ty:-28.25}},{type:"static",bodypart:0,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:14.75,ty:-44.2}},{type:"static",bodypart:0,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:30.45,ty:-43.95}},{type:"anim",anim:1,offset:0,loop:!1,mat:{a:1,b:0,c:0,d:1,tx:-14.15,ty:-34.6}}],[{type:"static",bodypart:3,mat:{a:.0090179443359375,b:-.382843017578125,c:-.3640899658203125,d:-.0085601806640625,tx:-26.85,ty:-25.15}},{type:"body",mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:1.9,ty:-42}},{type:"static",bodypart:36,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-16.75,ty:-28.25}},{type:"static",bodypart:0,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-25.95,ty:-43.95}},{type:"static",bodypart:0,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-10.25,ty:-44.2}},{type:"static",bodypart:3,mat:{a:.0090179443359375,b:-.382843017578125,c:-.3640899658203125,d:-.0085601806640625,tx:2.2,ty:-24.85}}],[{type:"static",bodypart:3,mat:{a:-.0090179443359375,b:-.382843017578125,c:.3640899658203125,d:-.0085601806640625,tx:31.7,ty:-25.15}},{type:"body",mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:2.95,ty:-42}},{type:"static",bodypart:36,mat:{a:.400299072265625,b:0,c:0,d:.400299072265625,tx:21.25,ty:-28.25}},{type:"static",bodypart:0,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:14.75,ty:-44.2}},{type:"static",bodypart:0,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:30.45,ty:-43.95}},{type:"static",bodypart:3,mat:{a:-.0090179443359375,b:-.382843017578125,c:.3640899658203125,d:-.0085601806640625,tx:2.65,ty:-23.8}}],[{type:"static",bodypart:47,mat:{a:.606903076171875,b:0,c:0,d:.606903076171875,tx:4.3,ty:-65.55}}],[{type:"static",bodypart:47,mat:{a:.606903076171875,b:0,c:0,d:.606903076171875,tx:4.3,ty:-65.55}}],[{type:"armroot",id:0,pos:{x:-26.25,y:-22.9}},{type:"body",mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:2.35,ty:-42}},{type:"static",bodypart:36,mat:{a:-.400299072265625,b:0,c:0,d:.400299072265625,tx:-16.3,ty:-28.25}},{type:"static",bodypart:0,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-25.5,ty:-43.95}},{type:"static",bodypart:0,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:-9.8,ty:-44.2}},{type:"armroot",id:1,pos:{x:23.3,y:-22.9}}],[{type:"armroot",id:0,pos:{x:29.35,y:-22.9}},{type:"body",mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:2.35,ty:-42}},{type:"static",bodypart:36,mat:{a:.400299072265625,b:0,c:0,d:.400299072265625,tx:21,ty:-28.25}},{type:"static",bodypart:0,mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:14.5,ty:-44.2}},{type:"static",bodypart:0,mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:30.2,ty:-43.95}},{type:"armroot",id:1,pos:{x:-20.2,y:-22.9}}],[{type:"armroot",id:0,pos:{x:-27.95,y:-22.9}},{type:"armroot",id:1,pos:{x:31.8,y:-22.9}},{type:"body",mat:{a:.3648529052734375,b:0,c:0,d:.3648529052734375,tx:2.35,ty:-42}},{type:"static",bodypart:36,mat:{a:-.1955413818359375,b:0,c:0,d:.400299072265625,tx:-25.8,ty:-29.65}},{type:"static",bodypart:0,mat:{a:-.193145751953125,b:0,c:0,d:.3648529052734375,tx:-30.55,ty:-43.05}}],[{type:"armroot",id:0,pos:{x:31.05,y:-22.9}},{type:"armroot",id:1,pos:{x:-27,y:-22.9}},{type:"body",mat:{a:-.3648529052734375,b:0,c:0,d:.3648529052734375,tx:2.35,ty:-42}},{type:"static",bodypart:36,mat:{a:.1955413818359375,b:0,c:0,d:.400299072265625,tx:30.5,ty:-29.65}},{type:"static",bodypart:0,mat:{a:.193145751953125,b:0,c:0,d:.3648529052734375,tx:35.25,ty:-43.05}}]]},{torsomat:{a:.2733306884765625,b:0,c:0,d:.273284912109375,tx:-26,ty:-49.75},legx:[-7.9,12.5],legy:[-12,-11.85],firemat:{a:-.4046630859375,b:.0060882568359375,c:.006805419921875,d:.5772552490234375,tx:-1.15,ty:-51},charimgmat:{a:.116455078125,b:0,c:0,d:.116455078125,tx:.4,ty:20.05},burstmat:{a:1.35589599609375,b:0,c:0,d:.9438323974609375,tx:2.55,ty:-22.5},defaultExpr:0,mouthType:0,frames:[[{type:"body",mat:{a:1,b:0,c:0,d:1,tx:95.1,ty:139.35}},{type:"static",bodypart:48,mat:{a:1,b:0,c:0,d:1,tx:93.2,ty:25.95}},{type:"static",bodypart:49,mat:{a:-2.3869781494140625,b:0,c:.0482177734375,d:2.29827880859375,tx:96.75,ty:73.45}}],[{type:"body",mat:{a:1,b:0,c:0,d:1,tx:95.1,ty:139.35}},{type:"dia",mat:{a:4.6165771484375,b:0,c:0,d:4.6165771484375,tx:97.65,ty:82.35}},{type:"static",bodypart:48,mat:{a:1,b:0,c:0,d:1,tx:93.2,ty:25.95}}],[{type:"body",mat:{a:-1,b:0,c:0,d:1,tx:95.1,ty:139.35}},{type:"static",bodypart:48,mat:{a:-1,b:0,c:0,d:1,tx:93.2,ty:25.95}},{type:"static",bodypart:49,mat:{a:2.3869781494140625,b:0,c:-.0482177734375,d:2.29827880859375,tx:93.45,ty:73.45}}],[{type:"body",mat:{a:1,b:0,c:0,d:1,tx:95.1,ty:139.35}},{type:"dia",mat:{a:-4.6165771484375,b:0,c:0,d:4.6165771484375,tx:97.65,ty:82.35}},{type:"static",bodypart:48,mat:{a:1,b:0,c:0,d:1,tx:93.2,ty:25.95}}],[{type:"body",mat:{a:1,b:0,c:0,d:1,tx:95.1,ty:139.35}},{type:"static",bodypart:48,mat:{a:1,b:0,c:0,d:1,tx:93.2,ty:25.95}},{type:"static",bodypart:50,mat:{a:-2.0886993408203125,b:0,c:-.0366058349609375,d:1.745025634765625,tx:97.05,ty:76.75}}],[{type:"body",mat:{a:1,b:0,c:0,d:1,tx:95.1,ty:139.35}},{type:"static",bodypart:48,mat:{a:1,b:0,c:0,d:1,tx:93.2,ty:25.95}},{type:"static",bodypart:50,mat:{a:2.0886993408203125,b:0,c:.0366058349609375,d:1.745025634765625,tx:89.1,ty:77.65}}],[],[],[{type:"body",mat:{a:1,b:0,c:0,d:1,tx:95.1,ty:139.35}},{type:"static",bodypart:40,mat:{a:1.5439453125,b:0,c:0,d:1.5439453125,tx:51.85,ty:40.95}},{type:"static",bodypart:40,mat:{a:-1.5439453125,b:0,c:0,d:1.5439453125,tx:134.55,ty:40.95}},{type:"static",bodypart:5,mat:{a:-2.0886993408203125,b:0,c:-.0366058349609375,d:1.745025634765625,tx:93,ty:77.2}}],[{type:"body",mat:{a:1,b:0,c:0,d:1,tx:95.1,ty:139.35}},{type:"static",bodypart:40,mat:{a:1.5439453125,b:0,c:0,d:1.5439453125,tx:58.25,ty:40.95}},{type:"static",bodypart:40,mat:{a:-1.5439453125,b:0,c:0,d:1.5439453125,tx:140.95,ty:40.95}},{type:"static",bodypart:5,mat:{a:2.0886993408203125,b:0,c:.0366058349609375,d:1.745025634765625,tx:99.8,ty:77.2}}],[],[],[],[]]},{torsomat:{a:.2268524169921875,b:0,c:0,d:.22625732421875,tx:-23.45,ty:-42.7},legx:[-10.15,16],legy:[-12.25,-11.7],firemat:{a:-.865478515625,b:.007171630859375,c:.014556884765625,d:.680572509765625,tx:0,ty:-60.15},charimgmat:{a:-.06329345703125,b:0,c:0,d:.0632781982421875,tx:-.6,ty:18.65},burstmat:{a:1.55078125,b:0,c:0,d:1.09588623046875,tx:1.55,ty:-36.75},defaultExpr:0,mouthType:1,frames:[[{type:"body",mat:{a:-1,b:0,c:0,d:1,tx:101.7,ty:139.35}},{type:"static",bodypart:39,mat:{a:-1.33612060546875,b:0,c:.0269927978515625,d:1.2864837646484375,tx:52.7,ty:-19.15}},{type:"static",bodypart:39,mat:{a:-1.33612060546875,b:0,c:.0269927978515625,d:1.2864837646484375,tx:153.3,ty:-19.15}},{type:"static",bodypart:51,mat:{a:-1.81903076171875,b:0,c:.0367431640625,d:1.7514495849609375,tx:99.65,ty:52.8}}],[{type:"body",mat:{a:-1,b:0,c:0,d:1,tx:101.7,ty:139.35}},{type:"static",bodypart:39,mat:{a:-1.33612060546875,b:0,c:.0269927978515625,d:1.2864837646484375,tx:52.7,ty:-19.15}},{type:"static",bodypart:39,mat:{a:-1.33612060546875,b:0,c:.0269927978515625,d:1.2864837646484375,tx:153.3,ty:-19.15}},{type:"dia",mat:{a:4.6165771484375,b:0,c:0,d:4.6165771484375,tx:104.55,ty:58.9}}],[{type:"body",mat:{a:1,b:0,c:0,d:1,tx:105.2,ty:139.35}},{type:"static",bodypart:39,mat:{a:1.33612060546875,b:0,c:-.0269927978515625,d:1.2864837646484375,tx:53.6,ty:-19.15}},{type:"static",bodypart:39,mat:{a:1.33612060546875,b:0,c:-.0269927978515625,d:1.2864837646484375,tx:154.2,ty:-19.15}},{type:"static",bodypart:51,mat:{a:1.81903076171875,b:0,c:-.0367431640625,d:1.7514495849609375,tx:107.25,ty:52.8}}],[{type:"body",mat:{a:1,b:0,c:0,d:1,tx:105.2,ty:139.35}},{type:"static",bodypart:39,mat:{a:-1.33612060546875,b:0,c:.0269927978515625,d:1.2864837646484375,tx:52.7,ty:-19.15}},{type:"static",bodypart:39,mat:{a:-1.33612060546875,b:0,c:.0269927978515625,d:1.2864837646484375,tx:153.3,ty:-19.15}},{type:"dia",mat:{a:-4.6165771484375,b:0,c:0,d:4.6165771484375,tx:104.55,ty:58.9}}],[{type:"body",mat:{a:-1,b:0,c:0,d:1,tx:101.7,ty:139.35}},{type:"static",bodypart:39,mat:{a:-1.33612060546875,b:0,c:.0269927978515625,d:1.2864837646484375,tx:52.7,ty:-19.15}},{type:"static",bodypart:39,mat:{a:-1.33612060546875,b:0,c:.0269927978515625,d:1.2864837646484375,tx:153.3,ty:-19.15}},{type:"static",bodypart:52,mat:{a:-1.81903076171875,b:0,c:.0367431640625,d:1.7514495849609375,tx:99.65,ty:52.8}}],[{type:"body",mat:{a:1,b:0,c:0,d:1,tx:105.2,ty:139.35}},{type:"static",bodypart:39,mat:{a:-1.33612060546875,b:0,c:.0269927978515625,d:1.2864837646484375,tx:52.7,ty:-19.15}},{type:"static",bodypart:39,mat:{a:-1.33612060546875,b:0,c:.0269927978515625,d:1.2864837646484375,tx:153.3,ty:-19.15}},{type:"static",bodypart:52,mat:{a:1.81903076171875,b:0,c:-.0367431640625,d:1.7514495849609375,tx:106.45,ty:52.8}}],[],[],[{type:"body",mat:{a:-1,b:0,c:0,d:1,tx:101.7,ty:139.35}},{type:"static",bodypart:40,mat:{a:1.5439453125,b:0,c:0,d:1.5439453125,tx:65,ty:-6.75}},{type:"static",bodypart:40,mat:{a:-1.5439453125,b:0,c:0,d:1.5439453125,tx:147.7,ty:-3.45}},{type:"static",bodypart:56,mat:{a:1.81903076171875,b:0,c:-.0367431640625,d:1.7514495849609375,tx:106.45,ty:52.8}}],[{type:"body",mat:{a:1,b:0,c:0,d:1,tx:105.2,ty:139.35}},{type:"static",bodypart:40,mat:{a:1.5439453125,b:0,c:0,d:1.5439453125,tx:54.95,ty:-3.45}},{type:"static",bodypart:40,mat:{a:-1.5439453125,b:0,c:0,d:1.5439453125,tx:137.65,ty:-3.45}},{type:"static",bodypart:56,mat:{a:-1.81903076171875,b:0,c:.0367431640625,d:1.7514495849609375,tx:96.2,ty:52.8}}],[],[],[],[]]},{torsomat:{a:.87811279296875,b:0,c:0,d:.87811279296875,tx:-.7,ty:-3},legx:[-4.45,7.7],legy:[-11.25,-11.25],firemat:{a:-.34619140625,b:.0060882568359375,c:.0058135986328125,d:.5772552490234375,tx:1.45,ty:-53.55},charimgmat:{a:-.112091064453125,b:0,c:0,d:.112091064453125,tx:8.05,ty:-5.8},burstmat:{a:.794342041015625,b:0,c:0,d:.952484130859375,tx:1.55,ty:-29.75},defaultExpr:0,mouthType:0,frames:[[{type:"static",bodypart:57,mat:{a:-.3065643310546875,b:0,c:0,d:.3065643310546875,tx:29.95,ty:-51.95}}],[{type:"anim",anim:4,offset:0,loop:!0,mat:{a:1,b:0,c:0,d:1,tx:2.5,ty:-2}}],[{type:"static",bodypart:57,mat:{a:.3065643310546875,b:0,c:0,d:.3065643310546875,tx:-25.35,ty:-51.95}}],[{type:"anim",anim:4,offset:0,loop:!0,mat:{a:-1,b:0,c:0,d:1,tx:2.25,ty:-2}}],[{type:"static",bodypart:57,mat:{a:-.305023193359375,b:-.0296630859375,c:-.0296630859375,d:.305023193359375,tx:32.55,ty:-49.1}}],[{type:"static",bodypart:57,mat:{a:.3050384521484375,b:-.0294647216796875,c:.0294647216796875,d:.3050384521484375,tx:-28,ty:-49.1}}],[{type:"static",bodypart:58,mat:{a:-.3065643310546875,b:0,c:0,d:.3065643310546875,tx:29.95,ty:-51.95}}],[{type:"static",bodypart:58,mat:{a:.3065643310546875,b:0,c:0,d:.3065643310546875,tx:-25.05,ty:-51.95}}],[{type:"static",bodypart:59,mat:{a:-.3065643310546875,b:0,c:0,d:.3065643310546875,tx:29.95,ty:-51.95}}],[{type:"static",bodypart:59,mat:{a:.3065643310546875,b:0,c:0,d:.3065643310546875,tx:-25.05,ty:-51.95}}],[{type:"static",bodypart:60,mat:{a:-.3065643310546875,b:0,c:0,d:.3065643310546875,tx:29.95,ty:-51.95}},{type:"armroot",id:0,pos:{x:-12,y:-14.25}},{type:"armroot",id:1,pos:{x:14.6,y:-15.75}}],[{type:"static",bodypart:60,mat:{a:.3065643310546875,b:0,c:0,d:.3065643310546875,tx:-25.05,ty:-51.95}},{type:"armroot",id:0,pos:{x:-10.85,y:-15.75}},{type:"armroot",id:1,pos:{x:15.75,y:-14.25}}],[{type:"armroot",id:0,pos:{x:-3.6,y:-15.6}},{type:"static",bodypart:61,mat:{a:-.3065643310546875,b:0,c:0,d:.3065643310546875,tx:29.95,ty:-51.95}},{type:"armroot",id:1,pos:{x:-15.6,y:-15.6}}],[{type:"armroot",id:0,pos:{x:6.95,y:-15.6}},{type:"static",bodypart:61,mat:{a:.3065643310546875,b:0,c:0,d:.3065643310546875,tx:-25.05,ty:-51.95}},{type:"armroot",id:1,pos:{x:8.05,y:-15.6}}]]},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{burstmat:{a:1.7895660400390625,b:0,c:0,d:1.207855224609375,tx:.8,ty:-39.25},charimgmat:{a:.3,b:0,c:0,d:.3,tx:0,ty:0}},{burstmat:{a:.952056884765625,b:0,c:0,d:1.207855224609375,tx:.15,ty:-39.65},charimgmat:{a:.3,b:0,c:0,d:.3,tx:0,ty:0}},{firemat:{a:-.34619140625,b:.0040283203125,c:.0058135986328125,d:.3830718994140625,tx:-1.25,ty:-27.6},burstmat:{a:1.0710906982421875,b:0,c:0,d:.906219482421875,tx:-.65,ty:-22.85},charimgmat:{a:.5,b:0,c:0,d:.5,tx:0,ty:0}},{firemat:{a:-.408905029296875,b:.0047607421875,c:.006866455078125,d:.452484130859375,tx:-1.4,ty:-35.25},burstmat:{a:1.4060821533203125,b:0,c:0,d:1.207855224609375,tx:-.75,ty:-31.25},charimgmat:{a:.4,b:0,c:0,d:.4,tx:0,ty:0}},{firemat:{a:-.39605712890625,b:.0052490234375,c:.0020904541015625,d:.15771484375,tx:.25,ty:-9.1},burstmat:{a:1.1382598876953125,b:0,c:0,d:.3983306884765625,tx:.1,ty:-8.45},charimgmat:{a:.4,b:0,c:0,d:.4,tx:0,ty:0}},{firemat:{a:-.4046478271484375,b:.00537109375,c:.00616455078125,d:.467559814453125,tx:0,ty:-36.95},burstmat:{a:1.1150665283203125,b:0,c:0,d:.85455322265625,tx:-.1,ty:-28.65},charimgmat:{a:.4,b:0,c:0,d:.4,tx:0,ty:0}},{firemat:{a:-.4213104248046875,b:.0055694580078125,c:.003631591796875,d:.2767333984375,tx:0,ty:-20.25},burstmat:{a:1.139404296875,b:0,c:0,d:.77362060546875,tx:.95,ty:-20.2},charimgmat:{a:.4,b:0,c:0,d:.4,tx:0,ty:0}},{firemat:{a:-.3904876708984375,b:.0051422119140625,c:.00531005859375,d:.406890869140625,tx:-.25,ty:-30.05},burstmat:{a:1.079010009765625,b:0,c:0,d:.906219482421875,tx:.1,ty:-27.5},charimgmat:{a:.4,b:0,c:0,d:.4,tx:0,ty:0}},{firemat:{a:-.5459136962890625,b:.0071868896484375,c:.0072479248046875,d:.5560760498046875,tx:-.3,ty:-42.4},burstmat:{a:1.5228729248046875,b:0,c:0,d:1.328765869140625,tx:-.35,ty:-40.85},charimgmat:{a:.3,b:0,c:0,d:.3,tx:0,ty:0}},{firemat:{a:-.371612548828125,b:.0048828125,c:.0054473876953125,d:.4189453125,tx:-.15,ty:-31.25},burstmat:{a:1.0906829833984375,b:0,c:0,d:.9201812744140625,tx:.7,ty:-30},charimgmat:{a:.4,b:0,c:0,d:.4,tx:0,ty:0}},{firemat:{a:-.390960693359375,b:.005126953125,c:.0054473876953125,d:.4189453125,tx:.1,ty:-33.75},burstmat:{a:1.031402587890625,b:0,c:0,d:.855499267578125,tx:.95,ty:-30.85},charimgmat:{a:.4,b:0,c:0,d:.4,tx:0,ty:0}},{firemat:{a:-.2586822509765625,b:.003387451171875,c:.0032958984375,d:.253692626953125,tx:.1,ty:-20.9},burstmat:{a:.7251434326171875,b:0,c:0,d:.5919189453125,tx:.15,ty:-19.4},charimgmat:{a:.3,b:0,c:0,d:.3,tx:0,ty:0}},{firemat:{a:-.1841278076171875,b:.002410888671875,c:.0059814453125,d:.46124267578125,tx:-.05,ty:-36.8},burstmat:{a:.6854095458984375,b:0,c:0,d:1.010223388671875,tx:.55,ty:-33.6},charimgmat:{a:.4,b:0,c:0,d:.4,tx:0,ty:0}},{firemat:{a:-.720306396484375,b:.009429931640625,c:.0023193359375,d:.1834716796875,tx:-.25,ty:-10.55},burstmat:{a:1.5430145263671875,b:0,c:0,d:.371612548828125,tx:-.35,ty:-8.2},charimgmat:{a:.3,b:0,c:0,d:.3,tx:0,ty:0}},{firemat:{a:-.2956695556640625,b:.00384521484375,c:.004364013671875,d:.34716796875,tx:-.25,ty:-27.4},burstmat:{a:.8918304443359375,b:0,c:0,d:.7522430419921875,tx:.15,ty:-24.4},charimgmat:{a:.4,b:0,c:0,d:.4,tx:0,ty:0}},{firemat:{a:-.27447509765625,b:.0035400390625,c:.006561279296875,d:.5229644775390625,tx:-.25,ty:-29.7},burstmat:{a:.8918304443359375,b:0,c:0,d:.94287109375,tx:.15,ty:-18.1},charimgmat:{a:.4,b:0,c:0,d:.4,tx:0,ty:0}},{firemat:{a:-.3960723876953125,b:.0052490234375,c:.0020904541015625,d:.15771484375,tx:.25,ty:-9.1},burstmat:{a:1.13824462890625,b:0,c:0,d:.3983154296875,tx:.1,ty:-8.45},charimgmat:{a:.4,b:0,c:0,d:.4,tx:0,ty:0}},{firemat:{a:-.6592254638671875,b:.0086212158203125,c:.0023193359375,d:.18426513671875,tx:.75,ty:-10.5},burstmat:{a:1.5430145263671875,b:0,c:0,d:.371612548828125,tx:-.35,ty:-6.95},charimgmat:{a:.3,b:0,c:0,d:.3,tx:0,ty:0}},{firemat:{a:-.23907470703125,b:.00311279296875,c:.0062713623046875,d:.49932861328125,tx:-.4,ty:-38.95},burstmat:{a:.784454345703125,b:0,c:0,d:.9769287109375,tx:.15,ty:-28.35},charimgmat:{a:.4,b:0,c:0,d:.4,tx:0,ty:0}},{firemat:{a:-.39166259765625,b:.005096435546875,c:.00311279296875,d:.249603271484375,tx:-.3,ty:-18.85},burstmat:{a:1.0699005126953125,b:0,c:0,d:.577911376953125,tx:.15,ty:-16.85},charimgmat:{a:.4,b:0,c:0,d:.4,tx:0,ty:0}},{firemat:{a:-.5117645263671875,b:.00665283203125,c:.0527801513671875,d:4.22344970703125,tx:-3.45,ty:-356.65},burstmat:{a:1.5361328125,b:0,c:0,d:7.588623046875,tx:0,ty:-286.65},charimgmat:{a:.1,b:0,c:0,d:.1,tx:0,ty:0}}],names=["Ruby","Book","Ice Cube","Match","Pencil","Bubble","Lego Brick","Waffle","Tune","","","","","","","","","","","","","","","","","","","","","","","","","","","HPRC 1","HPRC 2","Crate","Metal Box","Platform","Spike Ball","Package","Companian Cube","Rusty Apparatuses","Purple Face","Saw Blade","Spike Ball Jr.","Pillar","Large Platform","Blue Spike Ball","Not Gelatin","Acid Platform","Large Acid Platform","Green Block","Blue Block","Spike Wall"];let selectedTab=0,selectedBg=0;const tabNames=["Level Info","Characters / Objects","Tiles","Background","Dialogue","Options"];let charInfoHeight=40,diaInfoHeight=20;const charStateNames=["","Dead","Being Recovered","Deadly & Moving","Moving","Deadly","Carryable","","Non-Playable Character","Rescuable","Playable Character"],charStateNamesShort=["","D","BR","D&M","M","D","C","","NPC","R","P"],toolNames=["Draw Tool","Eraser Tool","Fill Rectangle Tool","Fill Tool","Eyedropper Tool","Selection Tool","Row Tool","Column Tool","","Copy","Undo / Redo","Clear"],tileNames=["Air","Red Ground Block","Downward Facing Gray Spikes","Upward Facing Gray Spikes","Right Facing Gray Spikes","Left Facing Gray Spikes","End Gate",'"E" Tree',"Dialogue Starter","Red Background Block","Green Ground Block","Green Background Block","Win Token","Spring Block","Left Conveyer","Heater","Right Conveyer","Gray Spike Ball","Upward One-Way Platform","Downward Facing Black Spikes","Upward Facing Black Spikes","Right Facing Black Spikes","Left Facing Black Spikes","Downward Facing Black Spikes with Support Cable","Vertical Support Cable","Vertical Support Cable Connected Right","Horizontal Support Cable","Top Left Support Cable Connector","Horizontal Support Cable Connected Down","Horizontal Support Cable Connected Up","Vertical Support Cable Connected Left","Yellow Switch Block Solid","Dark Yellow Switch Block Solid","Yellow Switch Block Passable","Dark Yellow Switch Block Passable","Yellow Lever Facing Left","Yellow Lever Facing Right","Blue Lever Facing Left","Blue Lever Facing Right","Green Background Block with Upward One-Way Platform","Yellow Button","Blue Button","Gray Grass","Gray Dirt","Right Facing One-Way Platform","Two-Way Gray Spikes Top Left","Two-Way Gray Spikes Top Right","Crumbling Rock","Conglomerate-Like Background Block","Lamp","Gray Gems","Blue Switch Block Solid","Dark Blue Switch Block Solid","Blue Switch Block Passable","Dark Blue Switch Block Passable","Conglomerate-Like Background Block with Upward One-Way Platform","Gray Block","Green Lever Facing Left","Green Lever Facing Right",'"V" Tree',"Dark Green Switch Block Solid","Green Switch Block Passable","Dark Green Switch Block Passable","Green Switch Platform Up Solid","Green Switch Platform Up Passable","Green Switch Block Solid","Spotlight","Black Block","Left Facing One-Way Platform","Downward One-Way Platform","Green Background Block with Left Facing One-Way Platform","Green Button","Black Spike Ball","Purple Ground Block",'"Wind Gust" Block',"Vertical Electric Barrier","Horiontal Electric Barrier","Purple Background Block","Yellow Switch Spike Ball Passable","Yellow Switch Spike Ball Solid",'"I" Tree',"Yellow Switch Platform Up Solid","Yellow Switch Platform Up Passable","One-Way Conveyer Left","One-Way Conveyer Left (not moving)","One-Way Conveyer Right","One-Way Conveyer Right (not moving)","Purple Background Block Slanted Bottom Left","Purple Background Block Slanted Bottom Right","Light Gray Vertical Support Cable","Light Gray Horizontal Support Cable","Light Gray Horizontal Support Cable Connected Down","Light Gray Horizontal Support Cable Connected Up","Wood Block","Wood Background Block","Danger Zone Background Block","Purple Background Block Slanted Top Right","Purple Background Block Slanted Top Left","Gray Metal Ground Block","Wooden Background Block... again?","Acid","Acid Glow","Yellow Metal Ground Block","Lava","Lava Glow","Red Metal Ground Block","Yellow Metal Background Block","Dark Gray Metal Ground Block","Conveyer Lever Facing Left","Conveyer Lever Facing Right","Picture","","","","","","","","","","","","","","","","","","","","Water","Brick Ground Block","Wall of Text","Blue Switch Platform Up Solid","Blue Switch Platform Up Passable"];let charDropdown=-1,charDropdownMS=-1,charDropdownType,diaDropdown=-1,diaDropdownType,lcPopUp=!1,lcPopUpType=0,tabHeight=30,tileTabScrollBar=0,charsTabScrollBar=0,diaTabScrollBar=0,bgsTabScrollBar=0,draggingScrollBar=!1,addButtonPressed=!1,duplicateChar=!1,reorderCharUp=!1,reorderCharDown=!1,reorderDiaUp=!1,reorderDiaDown=!1,levelLoadString="",lcMessageTimer=0,lcMessageText="";const exploreTabNames=["Levels","Levelpacks"],exploreTabWidths=[125,200];let power=1,jumpPower=11,qPress=!1,upPress=!1,csPress=!1,downPress=!1,leftPress=!1,rightPress=!1,recover=!1,recover2=0,recoverTimer=0,HPRC2=0,cornerHangTimer=0,goal=0,charsAtEnd=0,qPressTimer=0,transitionType=1,char=new Array(1),currentLevel=-1,control=0,wipeTimer=30,cutScene=0,cutSceneLine=0,bubWidth=500,bubHeight=100,bubMargin=40,bubSc=1,bubX=0,bubY=0,charDepth=0,cameraX=0,cameraY=0,shakeX=0,shakeY=0,menuScreen=-1,pmenuScreen=-1,exploreTab=0,explorePage=0,explorePageLevels=[],exploreLevelPageLevel,exploreUser,loggedInExploreUser5beamID=-1,exploreLevelTitlesTruncated,exploreLoading=!1,myLevel,myLevelChars,myLevelDialogue,myLevelInfo,myLevelNecessaryDeaths,scale=20,tool=0,selectedTile=0,mouseIsDown=!1,pmouseIsDown=!1,LCEndGateX=0,LCEndGateY=0,LCCoinX=0,LCCoinY=0,cardinal=[[0,-1],[0,1],[-1,0],[1,0]],diagonal=[[-1,-1],[1,-1],[1,1],[-1,1]],diagonal2=[[0,2],[0,3],[1,2],[1,3]];const direLetters=["U","D","L","R"];let undid=!1,copied=!1,tileClipboard=[[]],LCRect=[-1,-1,-1,-1],levelTimer=0,levelTimer2=0,bgXScale=0,bgYscale=0,stopX=0,stopY=0,toBounce=!1,toSeeCS=!0,csText="",currentLevelDisplayName="",tileShadows,tileBorders,HPRCBubbleFrame,HPRCText="",HPRCCrankRot=0,hprcCrankPos={x:-29.5,y:-23.7},hprcBubbleAnimationTimer=0,charDepths=[],tileDepths,doorLightX=[[27.5],[15,40],[10,27.5,45],[10,21.75,33.25,45],[4,16.25,27.5,38.75,50],[4,14,23,32,41,50]],doorLightFade=[],doorLightFadeDire=[];function toHMS(e){let t=Math.floor(e/36e5),a=Math.floor(e/6e4)%60,r=Math.floor(e/1e3)%60;e=Math.floor(e/100)%10;return t.toString().padStart(2,"0")+":"+a.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+"."+e}function mapRange(e,t,a,r,o){return r+(e-t)/(a-t)*(o-r)}let imgBgs=new Array(12),svgTiles=new Array(blockProperties.length),svgLevers=new Array(6),svgShadows=new Array(19),svgTileBorders=new Array(38),svgChars=new Array(charD.length),svgBodyParts=new Array(63),svgHPRCBubble=new Array(5),svgCSBubble,svgHPRCCrank,svgCoin,svgCoinGet=new Array(11),svgFire=new Array(18),svgBurst=new Array(13),svgAcidDrop=new Array(9),svgIceCubeMelt,svgCharsVB=new Array(charD.length),svgTilesVB=new Array(blockProperties.length),svgMenu0,svgMenu2,svgMenu6,svgMenu2border,svgMenu2borderimg,preMenuBG,svgTools=new Array(12),menu2_3Buttons=[new Path2D("M 104.5 10.05\nQ 104.5 0 94.5 0\nL 10 0\nQ 0 0 0 10.05\nL 0 27.3\nQ 0 37.3 10 37.3\nL 94.5 37.3\nQ 104.5 37.3 104.5 27.3\nL 104.5 10.05\nM 98.75 7.6\nL 98.75 21.65\nQ 98.75 26.2 96.2 28.45 93.65 30.7 89.15 30.7 84.55 30.7 82.05 28.45 79.55 26.25 79.55 21.65\nL 79.55 7.6 84.5 7.6 84.5 21.65\nQ 84.5 22.55 84.65 23.45 84.8 24.35 85.3 25\nL 86.7 26.1 89.15 26.55\nQ 91.75 26.55 92.8 25.35 93.8 24.15 93.8 21.65\nL 93.8 7.6 98.75 7.6\nM 70.55 7.6\nL 75.2 7.6 75.2 30.15 70.25 30.15 60.85 15.05 60.8 15.05 60.8 30.15 56.15 30.15 56.15 7.6 61.1 7.6 70.5 22.75 70.55 22.75 70.55 7.6\nM 40.75 16.6\nL 51.65 16.6 51.65 20.45 40.75 20.45 40.75 26 52.85 26 52.85 30.15 35.75 30.15 35.75 7.6 52.6 7.6 52.6 11.8 40.75 11.8 40.75 16.6\nM 24.4 7.6\nL 31.4 7.6 31.4 30.15 26.75 30.15 26.75 14.2 26.7 14.2 21.15 30.15 17.35 30.15 11.8 14.35 11.75 14.35 11.75 30.15 7.1 30.15 7.1 7.6 14.1 7.6 19.35 23.15 19.45 23.15 24.4 7.6 Z"),new Path2D("M 94.5 37.3\nQ 104.5 37.3 104.5 27.3\nL 104.5 10.05\nQ 104.5 0 94.5 0\nL 10 0\nQ 0 0 0 10.05\nL 0 27.3\nQ 0 37.3 10 37.3\nL 94.5 37.3\nM 92.9 6.5\nL 99.6 6.5 90.05 16.15 100.55 30.9 93.8 30.9 86.45 19.95 83.4 23.05 83.4 30.9 78 30.9 78 6.5 83.4 6.5 83.4 16.6 92.9 6.5\nM 67.15 11.65\nQ 66.45 11.05 65.55 10.75\nL 63.65 10.4\nQ 61.85 10.4 60.6 11.1 59.3 11.85 58.55 13 57.75 14.2 57.4 15.7 57.05 17.2 57.05 18.8 57.05 20.35 57.4 21.8 57.75 23.25 58.55 24.4 59.3 25.6 60.6 26.3 61.85 27 63.65 27 66.1 27 67.5 25.45 68.9 23.95 69.2 21.5\nL 74.4 21.5\nQ 74.2 23.8 73.35 25.65 72.45 27.5 71.05 28.8 69.65 30.1 67.8 30.8\nL 63.65 31.5\nQ 60.8 31.5 58.6 30.5 56.35 29.5 54.8 27.8 53.3 26.1 52.45 23.75 51.65 21.45 51.65 18.8 51.65 16.1 52.45 13.75 53.3 11.4 54.8 9.65 56.35 7.9 58.6 6.9 60.8 5.9 63.65 5.9 65.65 5.9 67.45 6.5 69.25 7.1 70.65 8.2 72.1 9.3 73 10.95 73.95 12.6 74.15 14.7\nL 68.95 14.7\nQ 68.85 13.8 68.35 13\nL 67.15 11.65\nM 50.6 30.9\nL 45 30.9 43.15 25.5 34.05 25.5 32.15 30.9 26.7 30.9 35.95 6.5 41.45 6.5 50.6 30.9\nM 22.35 7.8\nQ 23.35 8.5 23.9 9.65 24.5 10.85 24.5 12.55 24.5 14.35 23.65 15.6 22.8 16.85 21.15 17.65 23.45 18.3 24.55 19.9 25.65 21.55 25.65 23.8 25.65 25.7 24.95 27.05 24.2 28.4 23 29.25 21.8 30.1 20.2 30.5\nL 17.05 30.9 5.2 30.9 5.2 6.5 16.7 6.5 19.85 6.8\nQ 21.3 7.1 22.35 7.8\nM 19.2 20.85\nQ 18.15 20.05 16.4 20.05\nL 10.6 20.05 10.6 26.75 16.3 26.75 17.8 26.6 19.05 26.05 19.95 25.1 20.25 23.5\nQ 20.25 21.65 19.2 20.85\nM 19 12.1\nQ 18.65 11.5 18.15 11.2\nL 17 10.8 15.6 10.65 10.6 10.65 10.6 16.4 16 16.4\nQ 17.45 16.4 18.35 15.7 19.3 15 19.3 13.5\nL 19 12.1\nM 38.7 12.5\nL 38.65 12.5 35.45 21.45 41.75 21.45 38.7 12.5 Z"),new Path2D("M 104.5 27.3\nL 104.5 10.05\nQ 104.5 0 94.5 0\nL 10 0\nQ 0 0 0 10.05\nL 0 27.3\nQ 0 37.3 10 37.3\nL 94.5 37.3\nQ 104.5 37.3 104.5 27.3\nM 97.5 11.4\nL 85.2 11.4 85.2 16.35 96.5 16.35 96.5 20.35 85.2 20.35 85.2 26.1 97.75 26.1 97.75 30.4 80.05 30.4 80.05 7.05 97.5 7.05 97.5 11.4\nM 77.4 7.05\nL 77.4 11.4 70.4 11.4 70.4 30.4 65.25 30.4 65.25 11.4 58.3 11.4 58.3 7.05 77.4 7.05\nM 40.95 21.6\nL 41.1 23.45\nQ 41.25 24.35 41.8 25.1\nL 43.25 26.2 45.75 26.65\nQ 48.5 26.65 49.55 25.4 50.6 24.2 50.6 21.6\nL 50.6 7.05 55.7 7.05 55.7 21.6\nQ 55.7 26.3 53.05 28.65 50.4 30.95 45.75 30.95 41 30.95 38.4 28.65 35.8 26.35 35.8 21.6\nL 35.8 7.05 40.95 7.05 40.95 21.6\nM 26.55 13.85\nL 26.45 13.85 20.75 30.4 16.8 30.4 11.05 14.05 11 14.05 11 30.4 6.2 30.4 6.2 7.05 13.45 7.05 18.9 23.1 18.95 23.1 24.1 7.05 31.35 7.05 31.35 30.4 26.55 30.4 26.55 13.85 Z"),new Path2D("\nM 104.5 27.3\nL 104.5 10.05\nQ 104.5 0 94.5 0\nL 10 0\nQ 0 0 0 10.05\nL 0 27.3\nQ 0 37.3 10 37.3\nL 94.5 37.3\nQ 104.5 37.3 104.5 27.3\nM 86.35 6.35\nL 86.35 26.35 98.3 26.35 98.3 30.85 80.95 30.85 80.95 6.35 86.35 6.35\nM 64.1 6.35\nL 69.6 6.35 78.8 30.85 73.2 30.85 71.35 25.4 62.2 25.4 60.25 30.85 54.8 30.85 64.1 6.35\nM 52.8 6.35\nL 52.8 21.6\nQ 52.8 26.55 50.05 29 47.25 31.45 42.35 31.45 37.35 31.45 34.65 29 31.9 26.6 31.9 21.6\nL 31.9 6.35 37.3 6.35 37.3 21.6 37.45 23.55\nQ 37.65 24.5 38.2 25.25 38.75 26.05 39.7 26.45\nL 42.35 26.9\nQ 45.2 26.9 46.3 25.65 47.4 24.35 47.4 21.6\nL 47.4 6.35 52.8 6.35\nM 21.4 6.75\nQ 23.65 7.8 25.2 9.5 26.75 11.3 27.55 13.65 28.35 16 28.35 18.7 28.35 21.4 27.55 23.7 26.75 26 25.2 27.7\nL 28.25 30.5 25.75 33.15 22.25 30\nQ 21.05 30.7 19.6 31.05\nL 16.35 31.45\nQ 13.5 31.45 11.25 30.45 9.05 29.45 7.5 27.75 5.95 26 5.15 23.7 4.3 21.35 4.3 18.7 4.3 16 5.15 13.65 5.95 11.3 7.5 9.5 9.05 7.8 11.25 6.75 13.5 5.8 16.35 5.8 19.2 5.8 21.4 6.75\nM 21.45 24.35\nQ 22.15 23.4 22.55 22.05 23 20.65 23 18.7 23 17.1 22.65 15.6 22.25 14.05 21.45 12.9 20.7 11.7 19.4 11 18.15 10.3 16.35 10.3 14.5 10.3 13.25 11 12 11.7 11.2 12.9 10.4 14.05 10.05 15.6 9.7 17.1 9.7 18.7 9.7 20.25 10.05 21.7 10.4 23.2 11.2 24.35 12 25.5 13.25 26.2 14.5 26.9 16.35 26.9\nL 17.55 26.9 18.5 26.6 16.2 24.45 18.7 21.8 21.45 24.35\nM 66.85 12.4\nL 66.75 12.4 63.6 21.4 69.9 21.4 66.85 12.4 Z")],menu0ButtonSize={w:273,h:36.9,cr:6.65},menu2_3ButtonSize={w:104.5,h:37.3},levelButtonSize={w:100,h:40},menu0ButtonClicked=-1,onButton=!1,onTextBox=!1,editingTextBox=-1,textBoxCursorLoc=0,currentTextBoxAllowsLineBreaks=!1,mouseOnTabWindow=!1,menu2_3ButtonClicked=-1,levelButtonClicked=-1,showingNewGame2=!1,musicSound=new Audio("data/the fiber 16x loop.wav");function createImage(e){let t=new Image;return t.src=e,t}function getVB(e){e=atob(e.split(",")[1]);let t=new DOMParser,a=t.parseFromString(e,"image/svg+xml"),r=a.getElementsByTagName("svg")[0];return r.getAttribute("viewBox").split(" ").map(Number)}async function loadingScreen(){pixelRatio=window.devicePixelRatio,""===document.body.style.zoom&&1<pixelRatio&&pixelRatio<2&&(addedZoom=pixelRatio,document.body.style.zoom=1/pixelRatio*100+"%",pixelRatio=window.devicePixelRatio),canvas=document.getElementById("cnv"),ctx=canvas.getContext("2d"),canvas.style.width=cwidth+"px",canvas.style.height=cheight+"px",canvas.width=Math.floor(cwidth*pixelRatio),canvas.height=Math.floor(cheight*pixelRatio),ctx.scale(pixelRatio,pixelRatio),ctx.fillStyle="#999966",ctx.fillRect(0,0,cwidth,cheight),ctx.fillStyle="#000000",ctx.textAlign="center",ctx.textBaseline="middle",ctx.font="30px Helvetica",ctx.fillText("Loading...",cwidth/2,cheight/2);let e=await fetch("data/levels.txt");var t=await e.text(),a=(defaultLevelsString=t,levelsString=defaultLevelsString,loadLevels(),await(e=await fetch("data/images.json")).text()),a=JSON.parse(a);svgCSBubble=createImage(a["ui/csbubble/dia.svg"]),svgHPRCCrank=createImage(a["entities/e0035crank.svg"]),svgCoin=createImage(a["wintoken.svg"]),svgIceCubeMelt=createImage(a["effects/icecubemelt.svg"]),svgIceCubeMelt=createImage(a["effects/icecubemelt.svg"]);for(let e=0;e<imgBgs.length;e++)imgBgs[e]=createImage(a["bg/bg"+e.toString().padStart(4,"0")+".png"]);for(let t=0;t<blockProperties.length;t++){var r=t.toString().padStart(4,"0");if(1==blockProperties[t][16]||blockProperties[t][15]&&0==blockProperties[t][16])svgTiles[t]=createImage(a["blocks/b"+r+".svg"]),svgTilesVB[t]=getVB(svgTiles[t].src);else if(1<blockProperties[t][16]){svgTiles[t]=new Array(blockProperties[t][16]),svgTilesVB[t]=new Array(blockProperties[t][16]);for(let e=0;e<svgTiles[t].length;e++)svgTiles[t][e]=createImage(a["blocks/b"+r+"f"+e.toString().padStart(4,"0")+".svg"]),svgTilesVB[t][e]=getVB(svgTiles[t][e].src)}}for(let e=0;e<svgLevers.length;e++)svgLevers[e]=createImage(a["blocks/b"+e.toString().padStart(2,"0")+"lever.svg"]);for(let e=0;e<svgShadows.length;e++)svgShadows[e]=createImage(a["shadows/s"+e.toString().padStart(4,"0")+".svg"]);for(let e=0;e<svgTileBorders.length;e++)svgTileBorders[e]=createImage(a["borders/tb"+e.toString().padStart(4,"0")+".svg"]);for(let t=0;t<charD.length;t++){var o=t.toString().padStart(4,"0");if(!(charD[t][7]<1))if(1==charD[t][7])svgChars[t]=createImage(a["entities/e"+o+".svg"]),svgCharsVB[t]=getVB(svgChars[t].src);else{svgChars[t]=new Array(charD[t][7]),svgCharsVB[t]=new Array(charD[t][7]);for(let e=0;e<svgChars[t].length;e++)svgChars[t][e]=createImage(a["entities/e"+o+"f"+e.toString().padStart(4,"0")+".svg"]),svgCharsVB[t][e]=getVB(svgChars[t][e].src)}}for(let e=0;e<svgBodyParts.length;e++)svgBodyParts[e]=createImage(a["bodyparts/bp"+e.toString().padStart(4,"0")+".svg"]);for(let e=0;e<svgHPRCBubble.length;e++)svgHPRCBubble[e]=createImage(a["ui/hprcbubble/hprcbubble"+e.toString().padStart(4,"0")+".svg"]);for(let e=0;e<svgCoinGet.length;e++)svgCoinGet[e]=createImage(a["effects/wtgetf"+e.toString().padStart(4,"0")+".svg"]);for(let e=0;e<svgFire.length;e++)svgFire[e]=createImage(a["effects/fire"+e.toString().padStart(4,"0")+".svg"]);for(let e=0;e<svgBurst.length;e++)svgBurst[e]=createImage(a["effects/burst"+e.toString().padStart(4,"0")+".svg"]);for(let e=0;e<svgAcidDrop.length;e++)svgAcidDrop[e]=createImage(a["effects/aciddrop"+e.toString().padStart(4,"0")+".svg"]);svgMenu0=createImage(a["menu0.svg"]),svgMenu2=createImage(a["menu2.svg"]),svgMenu6=createImage(a["menu6.svg"]),svgMenu2border=createImage(a["menu2border.svg"]),svgMenu2borderimg=createImage(a["menu2borderimg.png"]),preMenuBG=createImage(a["premenubg.png"]);for(let e=0;e<svgTools.length;e++)svgTools[e]=createImage(a["lc/tool"+e.toString().padStart(4,"0")+".svg"]);setup()}function onRect(e,t,a,r,o,c){return a<e&&e<a+o&&r<t&&t<r+c}function setCursor(e){_cursor!=e&&(_cursor=e,document.body.style.cursor=_cursor)}function setHoverText(){canvas.getAttribute("title")!=hoverText&&(""==hoverText?canvas.removeAttribute("title"):canvas.setAttribute("title",hoverText))}function menuWatchA(){window.open("https://www.youtube.com/watch?v=4q77g4xo9ic")}function menuWatchC(){window.open("https://www.youtube.com/watch?v=YrsRLT3u0Cg")}function menuNewGame(){0!=levelProgress?showingNewGame2=!0:beginNewGame()}function menuNewGame2no(){showingNewGame2=!1}function menuNewGame2yes(){showingNewGame2=!1,beginNewGame()}function menuContGame(){menuScreen=2}function menuLevelCreator(){menuScreen=5,resetLevelCreator()}function menuExitLevelCreator(){menuScreen=0}function menuExplore(){menuScreen=6,setExplorePage(exploreTab=0)}function gotoExploreLevelPage(e){menuScreen=7,0==exploreTab?(exploreLevelPageLevel=explorePageLevels[e],drawExploreThumb(thumbBigctx,thumbBig.width,exploreLevelPageLevel.data,.4)):getExploreLevelpack(explorePageLevels[e].id)}function menuExploreBack(){menuScreen=6}function playExploreLevel(){0==exploreTab?(readExploreLevelString(exploreLevelPageLevel.data),testLevelCreator(),playMode=3):(loadLevelpack(),menuScreen=2)}function logInExplore(){loggedInExploreUser5beamID=-1,newWindow=window.open("https://discord.com/api/oauth2/authorize?client_id=747831622556057693&redirect_uri=https%3A%2F%2F5beam.zelo.dev%2Fapi%2Fauth%2Fcallback%2Fhtml5b&response_type=code&scope=identify","Window Name","height=750,width=450"),window.focus&&newWindow.focus()}function menu2Back(){menuScreen=0,cameraX=0,cameraY=0}function menu3Menu(){timer+=getTimer()-levelTimer2,saveGame(),exitLevel()}function beginNewGame(){clearVars(),saveGame(),menuScreen=2,cameraY=0,cameraX=0}function toggleSound(){musicSound.paused?musicSound.play():musicSound.pause()}function setQual(){highQual=!highQual,pixelRatio=highQual?window.devicePixelRatio:window.devicePixelRatio/2,canvas.width=cwidth*pixelRatio,canvas.height=cheight*pixelRatio}function exitLevel(){menuScreen=2}function playGame(){menuScreen=0,musicSound.play(),musicSound.loop=!0}function testLevelCreator(){if(0<myLevelChars[1].length){if(0==myLevelDialogue[1].length)for(let t=0;t<myLevel[1].length;t++)for(let e=0;e<myLevel[1][t].length;e++)8==myLevel[1][t][e]&&(myLevel[1][t][e]=0);playMode=2,currentLevel=-1,editingTextBox=-1,wipeTimer=30,menuScreen=3,toSeeCS=!0,transitionType=1,resetLevel()}}function exitTestLevel(){menuScreen=5,cameraX=0,cameraY=0,resetLevel(),resetLCOSC()}function exitExploreLevel(){menuScreen=7,cameraX=0,cameraY=0}function drawMenu0Button(e,t,a,r,o,c){let l="#ffffff";o?l="#b8b8b8":(!lcPopUp&&onRect(_xmouse,_ymouse,t,a,menu0ButtonSize.w,menu0ButtonSize.h)&&(onButton=!0,mouseIsDown?(l="#b8b8b8",menu0ButtonClicked=r):l="#d4d4d4"),mouseIsDown||menu0ButtonClicked!==r||(menu0ButtonClicked=-1,c())),drawRoundedRect(l,t,a,menu0ButtonSize.w,menu0ButtonSize.h,menu0ButtonSize.cr),ctx.font="bold 30px Helvetica",ctx.fillStyle="#666666",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText(e,t+menu0ButtonSize.w/2,a+1.1*menu0ButtonSize.h/2)}function drawMenu2_3Button(e,t,a,r){let o="#ffffff";onRect(_xmouse,_ymouse,t,a,menu2_3ButtonSize.w,menu2_3ButtonSize.h)?(onButton=!0,mouseIsDown&&(o="#cccccc",menu2_3ButtonClicked=e)):ctx.globalAlpha=.5,mouseIsDown||menu2_3ButtonClicked!==e||(menu2_3ButtonClicked=-1,r()),ctx.fillStyle=o,ctx.translate(t,a),ctx.fill(menu2_3Buttons[e]),ctx.translate(-t,-a),ctx.globalAlpha=1}function drawLevelButton(e,t,a,r,o){let c="#585858";2==o?c="#ff8000":3==o?c="#efe303":4==o&&(c="#00cc00"),1<o&&(onRect(_xmouse,_ymouse-cameraY,t,a,levelButtonSize.w,levelButtonSize.h)&&(_xmouse<587||_ymouse<469)&&(onButton=!0,mouseIsDown?(2==o?c="#d56a00":3==o?c="#c6bc02":4==o&&(c="#00a200"),levelButtonClicked=r):2==o?c="#ffaa55":3==o?c="#ffff99":4==o&&(c="#22ff22")),mouseIsDown||levelButtonClicked!==r||(levelButtonClicked=-1,(r<=levelProgress||99<r&&r<bonusProgress+100)&&(playLevel(r),white_alpha=100))),ctx.fillStyle=c,ctx.fillRect(t,a,levelButtonSize.w,levelButtonSize.h),ctx.lineWidth=2,ctx.strokeStyle="#000000",ctx.strokeRect(t,a,levelButtonSize.w,levelButtonSize.h),ctx.font="bold 41px Helvetica",ctx.fillStyle="#000000",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText(e,t+levelButtonSize.w/2,a+1.1*levelButtonSize.h/2)}function drawNewGame2Button(e,t,a,r,o,c){var l=107.5;onRect(_xmouse,_ymouse,t,a,l,l)&&(onButton=!0,mouseIsDown&&(menu0ButtonClicked=r)),mouseIsDown||menu0ButtonClicked!==r||(menu0ButtonClicked=-1,c()),drawRoundedRect(o,t,a,l,l,10),ctx.font="bold 40px Helvetica",ctx.fillStyle="#ffffff",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText(e,t+l/2,a+1.1*l/2)}function drawTextBox(a,r,o,e,t,c,l,i,h,n,s,d){ctx.fillStyle=n,ctx.fillRect(r,o,e,t),ctx.fillStyle=s,ctx.font=c+"px "+d,ctx.textAlign="left",ctx.textBaseline="top";let y=wrapText(a,r+l[0],o+l[1],e-l[0]-l[2],c);if(onRect(_xmouse,_ymouse,r,o,e,t)&&(onTextBox=!0,mouseIsDown&&!pmouseIsDown)){editingTextBox=i,5!=menuScreen||4!=selectedTab||lcPopUp||setUndo(),currentTextBoxAllowsLineBreaks=h;var m=Math.max(Math.floor((_ymouse-o-l[1])/c),0);if(m>=y.length)textBoxCursorLoc=a.length;else{let t=0;for(let e=0;e<m;e++)t+=y[e].length;for(var p=0;p<y[m].length&&!(ctx.measureText(y[m].slice(0,p)).width>=_xmouse-r-l[0]);p++);t+=p-1}inputText=a.slice(0,textBoxCursorLoc),textAfterCursorAtClick=a.slice(textBoxCursorLoc,a.length)}if(editingTextBox==i){if(textBoxCursorLoc=inputText.length,_keysDown[39]?rightPress||(textBoxCursorLoc=Math.max(inputText.length+1,0),inputText=a.slice(0,textBoxCursorLoc),textAfterCursorAtClick=a.slice(textBoxCursorLoc,a.length),rightPress=!0):rightPress=!1,_keysDown[37]?leftPress||(textBoxCursorLoc=Math.max(inputText.length-1,0),inputText=a.slice(0,textBoxCursorLoc),textAfterCursorAtClick=a.slice(textBoxCursorLoc,a.length),leftPress=!0):leftPress=!1,_keysDown[38]?upPress||(textBoxCursorLoc=0,inputText="",textAfterCursorAtClick=a,upPress=!0):upPress=!1,_keysDown[40]?downPress||(textBoxCursorLoc=a.length,inputText=a,textAfterCursorAtClick="",downPress=!0):downPress=!1,a=inputText+textAfterCursorAtClick,_frameCount%60<30){ctx.strokeStyle=s,ctx.lineWidth=2;let e=0,t=0;for(;e<y.length;){var x=t+y[e].length;if(x>textBoxCursorLoc||x==textBoxCursorLoc&&e==y.length-1)break;t=x,e++}e>=y.length&&e--;n=ctx.measureText(a.slice(t,textBoxCursorLoc)).width+r+l[0];ctx.beginPath(),ctx.moveTo(n,o+l[1]+c*e),ctx.lineTo(n,o+l[1]+c*(e+1)),ctx.stroke()}_keysDown[13]&&!_keysDown[16]&&(editingTextBox=-1)}return[a,y]}function drawRoundedRect(e,t,a,r,o,c){var t=t+c,l=a+c,r=r-c-c,o=o-c-c;ctx.beginPath(),ctx.fillStyle=e,ctx.arc(t,l,c,Math.PI,1.5*Math.PI,!1),ctx.arc(t+r,l,c,1.5*Math.PI,2*Math.PI,!1),ctx.arc(t+r,l+o,c,2*Math.PI,2.5*Math.PI,!1),ctx.arc(t,l+o,c,2.5*Math.PI,3*Math.PI,!1),ctx.lineTo(t-c,a),ctx.fill()}function drawMenu(){ctx.fillStyle="#666666",ctx.fillRect(0,0,cwidth,cheight),ctx.drawImage(svgMenu0,0,0),ctx.fillStyle="#ffffff",ctx.textBaseline="bottom",ctx.textAlign="left",ctx.font="20px Helvetica",ctx.fillText(version,5,cheight),99<levelProgress?drawMenu0Button("WATCH BFDIA 5c",665.55,303.75,0,!1,menuWatchC):drawMenu0Button("WATCH BFDIA 5a",665.55,303.75,0,!1,menuWatchA),showingNewGame2?(drawRoundedRect("#ffffff",665.5,81,273,72.95,15),ctx.font="20px Helvetica",ctx.fillStyle="#666666",ctx.textAlign="center",ctx.textBaseline="top",linebreakText("Are you sure you want to\nerase your saved progress\nand start a new game?",802,84.3,22),drawNewGame2Button("YES",680.4,169.75,5,"#993333",menuNewGame2yes),drawNewGame2Button("NO",815.9,169.75,6,"#1a4d1a",menuNewGame2no)):drawMenu0Button("NEW GAME",665.55,348.4,1,!1,menuNewGame),drawMenu0Button("CONTINUE GAME",665.55,393.05,2,0==levelProgress,menuContGame),drawMenu0Button("EXPLORE (pre-)",665.55,482.5,4,!1,menuExplore),drawMenu0Button("LEVEL CREATOR",665.55,437.7,3,!1,menuLevelCreator)}function drawLevelMapBorder(){ctx.save(),ctx.beginPath(),ctx.moveTo(0,0),ctx.lineTo(0,540),ctx.lineTo(960,540),ctx.lineTo(960,0),ctx.lineTo(0,0),ctx.moveTo(20,38.75),ctx.quadraticCurveTo(20.6,20.6,38.75,20),ctx.lineTo(921.25,20),ctx.quadraticCurveTo(939.4,20.6,940,38.75),ctx.lineTo(940,501.25),ctx.quadraticCurveTo(939.4,519.4,921.25,520),ctx.lineTo(38.75,520),ctx.quadraticCurveTo(20.6,519.4,20,501.25),ctx.lineTo(20,38.75),ctx.closePath(),ctx.clip(),ctx.drawImage(svgMenu2borderimg,0,0,cwidth,cheight),ctx.restore(),ctx.drawImage(svgMenu2border,0,0),drawMenu2_3Button(3,587,469,setQual),drawMenu2_3Button(2,705,469,toggleSound),drawMenu2_3Button(1,823,469,menu2Back)}function drawLevelMap(){ctx.drawImage(svgMenu2,0,0),ctx.fillStyle="#000000",ctx.textAlign="left",ctx.textBaseline="top",ctx.font="40px Helvetica",ctx.fillText("x "+coins,477.95,50.9),ctx.font="21px Helvetica",ctx.fillText(toHMS(timer),767.3,27.5),ctx.fillText(deathCount.toLocaleString(),767.3,55.9),ctx.textAlign="right",ctx.fillText("Time:",757.05,27.5),ctx.fillText("Deaths:",757.05,55.9),0<levelProgress&&(ctx.font="14px Helvetica",ctx.textAlign="right",ctx.fillText("Minimal deaths to complete level "+levelProgress+":",756.3,90.5),ctx.font="21px Helvetica",ctx.fillText("Unnecessary deaths:",756.3,116.8),ctx.textAlign="left",ctx.fillText(mdao[levelProgress-1],767.3,85.4),ctx.fillText((deathCount-mdao[levelProgress-1]).toLocaleString(),767.3,116.8));for(let r=0;r<133;r++){let e=r,t=(100<=e&&(e+=19),1),a=(gotCoin[r]?t=4:levelProgress==r?t=2:levelProgress>r?t=3:99<r&&r<bonusProgress+100&&(t=bonusesCleared[r-100]?3:2),"");drawLevelButton(a=100<=r?"B"+(r-99).toString().padStart(2,"0"):(r+1).toString().padStart(3,"0"),e%8*110+45,50*Math.floor(e/8)+160,r,t)}}function drawLevelButtons(){ctx.fillStyle="#ffffff",ctx.textAlign="left",ctx.textBaseline="top",ctx.font="bold 32px Helvetica",ctx.fillText(currentLevelDisplayName,12.85,489.45),drawMenu2_3Button(0,837.5,486.95,3==playMode?exitExploreLevel:2==playMode?exitTestLevel:menu3Menu)}function linebreakText(e,t,a,r){var o=e.split("\n");for(let e=0;e<o.length;e++)ctx.fillText(o[e],t,a+e*r)}function wrapText(e,t,a,o,r){let c=e.split(" "),l=[""];for(let r=0;r<c.length;r++){let t=c[r].split("\n"),a=!1;for(let e=0;e<t.length;e++)if(!a&&0<e&&l.push(""),a=!1,ctx.measureText(l[l.length-1]+t[e]).width>o)if(0==l[l.length-1].length){for(var i=0;i<t[e].length&&!(ctx.measureText(l[l.length-1]+t[e].charAt(i)).width>o);i++)l[l.length-1]+=t[e].charAt(i);l.push(""),1==t.length?(c[r]=c[r].slice(i,c[r].length),r--):(t[e]=t[e].slice(i,t[e].length),e--,a=!0)}else l.push(""),1==t.length?r--:(e--,a=!0);else l[l.length-1]+=t[e]+" "}for(let e=0;e<l.length;e++)ctx.fillText(l[e],t,a+r*e);return l}function binarySearch({max:e,getValue:t,match:a}){let r=0;for(;r<=e;){var o=Math.floor((r+e)/2),c=t(o);if(c===a)return o;c<a?r=o+1:e=o-1}return e}function fitString(t,a,e){var r=t.measureText(a).width,o=t.measureText("").width;if(r<=e||r<=o)return a;r=binarySearch({max:a.length,getValue:e=>t.measureText(a.substring(0,e)).width,match:e-o});return a.substring(0,r)+""}function playLevel(e){e==levelProgress?playMode=0:e<levelProgress&&(playMode=1),currentLevel=e,wipeTimer=30,menuScreen=3,toSeeCS=!0,transitionType=1,resetLevel()}function resetLevel(){if(HPRCBubbleFrame=0,tileDepths=[[],[],[],[]],2==playMode){charCount=myLevelChars[1].length,levelWidth=myLevel[1][0].length,levelHeight=myLevel[1].length,copyLevel(myLevel[1]),char=new Array(charCount),charCount2=0,HPRC1=HPRC2=1e6;for(let e=0;e<charCount;e++){var t=myLevelChars[1][e][0];char[e]=new Character(t,30*myLevelChars[1][e][1],30*myLevelChars[1][e][2],70+40*e,400-30*e,myLevelChars[1][e][3],charD[t][0],charD[t][1],charD[t][2],charD[t][2],charD[t][3],charD[t][4],charD[t][6],charD[t][8],t<35?charModels[t].defaultExpr:0),9==char[e].charState?(char[e].expr=1,char[e].dire=2,char[e].frame=1,char[e].legdire=0,char[e].diaMouthFrame=0):char[e].expr=charModels[char[e].id].defaultExpr,9<=char[e].charState&&charCount2++,36==t&&(HPRC1=e),35==t&&(HPRC2=e),3!=char[e].charState&&4!=char[e].charState||(char[e].speed=myLevelChars[1][e][4],char[e].motionString=generateMS(myLevelChars[1][e]))}cLevelDialogueChar=[],cLevelDialogueFace=[],cLevelDialogueText=[];for(let e=0;e<myLevelDialogue[1].length;e++)cLevelDialogueChar.push(myLevelDialogue[1][e].char),cLevelDialogueFace.push(myLevelDialogue[1][e].face),cLevelDialogueText.push(myLevelDialogue[1][e].text);currentLevelDisplayName=myLevelInfo.name}else if(3==playMode){charCount=myLevelChars[1].length,levelWidth=myLevel[1][0].length,levelHeight=myLevel[1].length,copyLevel(myLevel[1]),char=new Array(charCount),charCount2=0,HPRC1=HPRC2=1e6;for(let e=0;e<charCount;e++){var a=myLevelChars[1][e][0];char[e]=new Character(a,30*myLevelChars[1][e][1],30*myLevelChars[1][e][2],70+40*e,400-30*e,myLevelChars[1][e][3],charD[a][0],charD[a][1],charD[a][2],charD[a][2],charD[a][3],charD[a][4],charD[a][6],charD[a][8],a<35?charModels[a].defaultExpr:0),9==char[e].charState?(char[e].expr=1,char[e].dire=2,char[e].frame=1,char[e].legdire=0,char[e].diaMouthFrame=0):char[e].expr=charModels[char[e].id].defaultExpr,9<=char[e].charState&&charCount2++,36==a&&(HPRC1=e),35==a&&(HPRC2=e),3!=char[e].charState&&4!=char[e].charState||(char[e].speed=myLevelChars[1][e][4],char[e].motionString=generateMS(myLevelChars[1][e]))}cLevelDialogueChar=[],cLevelDialogueFace=[],cLevelDialogueText=[];for(let e=0;e<myLevelDialogue[1].length;e++)cLevelDialogueChar.push(myLevelDialogue[1][e].char),cLevelDialogueFace.push(myLevelDialogue[1][e].face),cLevelDialogueText.push(myLevelDialogue[1][e].text);currentLevelDisplayName=myLevelInfo.name}else{charCount=startLocations[currentLevel].length,levelWidth=levels[currentLevel][0].length,levelHeight=levels[currentLevel].length,copyLevel(levels[currentLevel]),charCount2=0,HPRC1=HPRC2=1e6;for(let e=0;e<charCount;e++){var r=startLocations[currentLevel][e][0];char[e]=new Character(r,30*startLocations[currentLevel][e][1]+30*startLocations[currentLevel][e][2]/100,30*startLocations[currentLevel][e][3]+30*startLocations[currentLevel][e][4]/100,70+40*e,400-30*e,startLocations[currentLevel][e][5],charD[r][0],charD[r][1],charD[r][2],charD[r][2],charD[r][3],charD[r][4],charD[r][6],charD[r][8],r<35?charModels[r].defaultExpr:0),9==char[e].charState?(char[e].expr=1,char[e].dire=2,char[e].frame=1,char[e].legdire=0,char[e].diaMouthFrame=0):char[e].expr=charModels[char[e].id].defaultExpr,9<=char[e].charState&&charCount2++,36==r&&(HPRC1=e),35==r&&(HPRC2=e),3!=char[e].charState&&4!=char[e].charState||(char[e].speed=10*startLocations[currentLevel][e][6][0]+startLocations[currentLevel][e][6][1],char[e].motionString=startLocations[currentLevel][e][6])}cLevelDialogueChar=dialogueChar[currentLevel],cLevelDialogueFace=dialogueFace[currentLevel],cLevelDialogueText=dialogueText[currentLevel],currentLevelDisplayName=99<currentLevel?"B"+(currentLevel-99).toString().padStart(2,"0")+". "+levelName[currentLevel]:(currentLevel+1).toString().padStart(3,"0")+". "+levelName[currentLevel]}charDepths=new Array(2*(charCount+1)).fill(-1);for(let e=0;e<charCount;e++)charDepths[2*e]=Math.floor(charCount-e-1);charDepths[2*(charCount-1)]=-1,charDepths[2*charCount]=0,charDepth=levelWidth*levelHeight+2*charCount,getTileDepths(),calculateShadowsAndBorders(),osc1.width=Math.floor(30*levelWidth*pixelRatio),osc1.height=Math.floor(30*levelHeight*pixelRatio),osctx1.setTransform(pixelRatio,0,0,pixelRatio,0,0),osc2.width=Math.floor(30*levelWidth*pixelRatio),osc2.height=Math.floor(30*levelHeight*pixelRatio),osctx2.setTransform(pixelRatio,0,0,pixelRatio,0,0),drawStaticTiles(),recover=!1,cornerHangTimer=0,charsAtEnd=0,control=0,cutScene=0,bgXScale=Math.max((10*(levelWidth-32)+960)/9.6,100),bgYScale=Math.max((10*(levelHeight-18)+540)/5.4,100),drawLevelBG(),cameraX=Math.min(Math.max(char[0].x-480,0),30*levelWidth-960),cameraY=Math.min(Math.max(char[0].y-270,0),30*levelHeight-540),gotThisCoin=!1,levelTimer=0,recoverTimer=0,levelTimer2=getTimer(),char[0].charState<=9&&changeControl(),doorLightFade=new Array(charCount2).fill(0),doorLightFadeDire=new Array(charCount2).fill(0)}function copyLevel(a){thisLevel=new Array(a.length),tileFrames=new Array(a.length),tileShadows=new Array(a.length),tileBorders=new Array(a.length);for(let t=0;t<levelHeight;t++){thisLevel[t]=new Array(a[t].length),tileFrames[t]=new Array(a[t].length),tileShadows[t]=new Array(a[t].length),tileBorders[t]=new Array(a[t].length);for(let e=0;e<levelWidth;e++){thisLevel[t][e]=a[t][e];var r=Math.ceil(blockProperties[thisLevel[t][e]][11]/6);tileFrames[t][e]={cf:0,playing:!1,rotation:1==r?-60:2==r?60:0},tileShadows[t][e]=[],tileBorders[t][e]=[]}}}function drawStaticTiles(){for(let e=0;e<tileDepths[0].length;e++)addTileMovieClip(tileDepths[0][e].x,tileDepths[0][e].y,osctx1);for(let a=0;a<levelHeight;a++)for(let t=0;t<levelWidth;t++){for(let e=0;e<tileShadows[a][t].length;e++)osctx2.drawImage(svgShadows[tileShadows[a][t][e]-1],30*t,30*a);for(let e=0;e<tileBorders[a][t].length;e++)osctx2.drawImage(svgTileBorders[tileBorders[a][t][e]-1],30*t,30*a)}}function drawLevelBG(){var e=Math.max(bgXScale,bgYScale);osc4.width=Math.floor(e/100*cwidth*pixelRatio),osc4.height=Math.floor(e/100*cheight*pixelRatio),osctx4.setTransform(pixelRatio,0,0,pixelRatio,0,0),osctx4.drawImage(imgBgs[2<=playMode?selectedBg:bgs[currentLevel]],0,0,e/100*cwidth,e/100*cheight)}function drawLevel(){ctx.drawImage(osc1,0,0,osc1.width/pixelRatio,osc1.height/pixelRatio);for(let e=0;e<tileDepths[1].length;e++)addTileMovieClip(tileDepths[1][e].x,tileDepths[1][e].y,ctx);ctx.drawImage(osc2,0,0,osc2.width/pixelRatio,osc2.height/pixelRatio);for(let e=0;e<tileDepths[2].length;e++)addTileMovieClip(tileDepths[2][e].x,tileDepths[2][e].y,ctx);drawCharacters();for(let e=0;e<tileDepths[3].length;e++)addTileMovieClip(tileDepths[3][e].x,tileDepths[3][e].y,ctx)}function drawCharacters(){for(let e=0;e<2*(charCount+1);e++){var a=charDepths[e];if(!(a<0)){var t,r,o=char[a].id;if(1<char[a].charState&&void 0!==svgChars[o]){if(0<=char[a].burstFrame&&(ctx.save(),r=svgBurst[char[a].burstFrame],t=charModels[char[a].id].burstmat,ctx.transform(t.a,t.b,t.c,t.d,t.tx+char[a].x,t.ty+char[a].y),ctx.drawImage(r,-r.width/2,-r.height/2),ctx.restore(),char[a].burstFrame++,char[a].burstFrame>svgBurst.length-1&&(char[a].burstFrame=-1)),ctx.save(),3<=char[a].charState){if(0<qTimer||1<=char[a].justChanged){let e=0;a==control&&0<qTimer&&(e=9-Math.pow(qTimer-4,2)),ctx.translate(0,-e)}char[a].justChanged--}if(2==char[a].charState&&(t=(60-recoverTimer)/60,ctx.transform(1,0,0,t,0,(1-t)*char[a].y)),char[a].deathTimer<30&&char[a].deathTimer%6<=2&&2<char[a].charState&&(ctx.globalAlpha=.3),34<o)1==charD[o][7]?drawPossiblyTintedImage(svgChars[o],char[a].x+svgCharsVB[o][0],char[a].y+svgCharsVB[o][1],char[a].temp):(r=_frameCount%charD[o][7],drawPossiblyTintedImage(svgChars[o][r],char[a].x+svgCharsVB[o][r][0],char[a].y+svgCharsVB[o][r][1],char[a].temp)),50==o?(char[a].acidDropTimer[0]<9&&ctx.drawImage(svgAcidDrop[char[a].acidDropTimer[0]],char[a].x-17.7,char[a].y-1.5),char[a].acidDropTimer[0]++,28<char[a].acidDropTimer[0]&&(Math.random()<.8?char[a].acidDropTimer[0]=9:char[a].acidDropTimer[0]=0)):51==o&&(char[a].acidDropTimer[0]<9&&ctx.drawImage(svgAcidDrop[char[a].acidDropTimer[0]],char[a].x-25.75,char[a].y+1.6,.7826*svgAcidDrop[0].width,.7826*svgAcidDrop[0].height),char[a].acidDropTimer[1]<9&&ctx.drawImage(svgAcidDrop[char[a].acidDropTimer[1]],char[a].x+18.3,char[a].y+6.7,.7826*svgAcidDrop[0].width,.7826*svgAcidDrop[0].height),char[a].acidDropTimer[0]++,char[a].acidDropTimer[1]++,28<char[a].acidDropTimer[0]&&(Math.random()<.8?char[a].acidDropTimer[0]=9:char[a].acidDropTimer[0]=0),28<char[a].acidDropTimer[1]&&(Math.random()<.8?char[a].acidDropTimer[1]=9:char[a].acidDropTimer[1]=0));else{var c=charModels[char[a].id];if(5!=char[a].id||4!=Math.floor(char[a].frame/2)){var o=0<char[a].legdire?1:-1;let e=[{a:.3648529052734375,b:0,c:char[a].leg1skew*o,d:.3814697265625,tx:0<o?-.75:.35,ty:-.35},{a:.3648529052734375,b:0,c:char[a].leg2skew*o,d:.3814697265625,tx:0<o?-.75:.35,ty:-.35}],t=[];var l=legFrames[char[a].leg1frame],l=("static"==l.type?t=[l.bodypart,l.bodypart]:"anim"==l.type&&(l.usesMats?(t=[l.bodypart,l.bodypart],e=[l.frames[Math.max(char[a].legAnimationFrame[0],0)%l.frames.length],l.frames[Math.max(char[a].legAnimationFrame[1],0)%l.frames.length]]):t=[l.frames[Math.max(char[a].legAnimationFrame[0],0)%l.frames.length],l.frames[Math.max(char[a].legAnimationFrame[1],0)%l.frames.length]]),ctx.save(),ctx.transform(o*e[0].a,e[0].b,o*e[0].c,e[0].d,char[a].x+c.legx[0]+e[0].tx,char[a].y+c.legy[0]+e[0].ty),svgBodyParts[t[0]]),l=(drawPossiblyTintedImage(l,-l.width/2,-l.height/2,char[a].temp),ctx.restore(),ctx.save(),ctx.transform(o*e[1].a,e[1].b,o*e[1].c,e[1].d,char[a].x+c.legx[1]+e[1].tx,char[a].y+c.legy[1]+e[1].ty),svgBodyParts[t[1]]);drawPossiblyTintedImage(l,-l.width/2,-l.height/2,char[a].temp),ctx.restore()}var i=c.frames[char[a].frame],h=(ctx.save(),0==char[a].frame||2==char[a].frame?bounceY(4/charModels[char[a].id].torsomat.a,13,char[a].poseTimer):0);ctx.transform(charModels[char[a].id].torsomat.a,charModels[char[a].id].torsomat.b,charModels[char[a].id].torsomat.c,charModels[char[a].id].torsomat.d,char[a].x+charModels[char[a].id].torsomat.tx,char[a].y+charModels[char[a].id].torsomat.ty);for(let e=0;e<i.length;e++)if(9<char[a].frame&&"armroot"==i[e].type){var n=0==i[e].id?10:20,s=-charModels[char[a].id].torsomat.tx+(char[HPRC2].x-char[a].x)+hprcCrankPos.x+n*Math.cos(Math.PI*recoverTimer/15-.2),n=-charModels[char[a].id].torsomat.ty+(char[HPRC2].y-char[a].y)+hprcCrankPos.y+n*Math.sin(Math.PI*recoverTimer/15-.2);ctx.strokeStyle="#000000",ctx.lineWidth=1.5,ctx.beginPath(),ctx.moveTo(i[e].pos.x,i[e].pos.y),ctx.lineTo(s,n),ctx.stroke(),ctx.fillStyle="#000000",ctx.beginPath(),ctx.arc(s,n,2.5,0,2*Math.PI,!1),ctx.fill()}else{let t=svgBodyParts[i[e].bodypart];if("body"==i[e].type&&(t=svgChars[char[a].id]),ctx.save(),ctx.transform(i[e].mat.a,i[e].mat.b,i[e].mat.c,i[e].mat.d,i[e].mat.tx,i[e].mat.ty+("anim"!=i[e].type?h:0)),"anim"==i[e].type){t=svgBodyParts[bodyPartAnimations[i[e].anim].bodypart];s=i[e].loop?(char[a].poseTimer+i[e].offset)%bodyPartAnimations[i[e].anim].frames.length:Math.min(char[a].poseTimer+i[e].offset,bodyPartAnimations[i[e].anim].frames.length-1),n=bodyPartAnimations[i[e].anim].frames[s];ctx.transform(n.a,n.b,n.c,n.d,n.tx,n.ty)}else if("dia"==i[e].type){let e=0;1==cutScene?(d=char[a].expr+2*charModels[char[a].id].mouthType,e=diaMouths[d].frameorder[char[a].diaMouthFrame],t=svgBodyParts[diaMouths[d].frames[e].bodypart],char[a].diaMouthFrame<diaMouths[d].frameorder.length-1&&char[a].diaMouthFrame++):t=svgBodyParts[diaMouths[char[a].expr+2*charModels[char[a].id].mouthType].frames[e].bodypart];var d=diaMouths[c.defaultExpr].frames[e].mat;ctx.transform(d.a,d.b,d.c,d.d,d.tx,d.ty)}drawPossiblyTintedImage(t,-t.width/2,-t.height/2,char[a].temp),ctx.restore()}ctx.restore(),char[a].poseTimer++,ctx.restore()}ctx.restore()}if(a==HPRC2&&(ctx.fillStyle="#00ff00",ctx.textAlign="center",ctx.font="6px Helvetica",ctx.fillText(HPRCText,char[a].x+12.65,char[a].y-39.6),o=svgHPRCCrank.height/2,ctx.save(),ctx.translate(char[a].x+hprcCrankPos.x,char[a].y+hprcCrankPos.y),ctx.rotate(HPRCCrankRot),ctx.drawImage(svgHPRCCrank,-o,-o),ctx.restore()),50<=char[a].temp&&5!=char[a].id){ctx.save();let e=svgFire[_frameCount%svgFire.length];2==char[a].id?e=svgIceCubeMelt:ctx.globalAlpha=.57;l=charModels[char[a].id].firemat;ctx.transform(l.a,l.b,l.c,l.d,l.tx+char[a].x,l.ty+char[a].y),ctx.drawImage(e,-e.width/2,-e.height/2),ctx.restore()}}}}function drawCutScene(){var a=cLevelDialogueChar[Math.min(cutSceneLine,cLevelDialogueChar.length-1)];if(!(50<=a&&a<99)){ctx.save(),ctx.transform(bubSc,0,0,bubSc,bubX,bubY);var r={x:-bubWidth/2,y:-bubHeight/2};ctx.drawImage(svgCSBubble,r.x,r.y);let e=386.55,t=106.7;if(99==a)e=488.25,t=4.25;else{ctx.fillStyle="#ce6fce",ctx.fillRect(r.x+10,r.y+10,80,80),ctx.save();let e=svgChars[char[a].id];Array.isArray(e)&&(e=e[0]);a=charModels[char[a].id].charimgmat;ctx.transform(2.6*a.a,a.b,a.c,2.6*a.d,a.tx+r.x+50,a.ty+r.y+50),ctx.drawImage(e,-e.width/2,-e.height/2),ctx.restore()}ctx.fillStyle="#000000",ctx.textAlign="left",ctx.font="21px Helvetica",wrapText(csText,r.x+t,r.y+4.25,e,23),ctx.restore(),2==cutScene?.1<bubSc&&(bubSc-=bubSc/4):bubSc<.99?bubSc+=(1-bubSc)/4:bubSc=1}}function drawHPRCBubbleCharImg(e,t,a){var r=charModels[char[e].id].charimgmat;ctx.save(),ctx.transform(r.a*t,r.b,r.c,r.d*t,r.tx*t/2+char[HPRC2].x+a,r.ty*t/2+char[HPRC2].y-107);let o=svgChars[char[e].id];Array.isArray(o)&&(o=o[0]),ctx.drawImage(o,-o.width/2,-o.height/2),ctx.restore()}function offSetLegs(e,t,a){char[e].leg1frame!=a?(char[e].legAnimationFrame[0]=0,char[e].legAnimationFrame[1]=Math.floor(t/2)):(char[e].legAnimationFrame[0]++,char[e].legAnimationFrame[1]++)}function bounceY(e,t,a){a=Math.sin(mapRange(a%t,0,2*t,0,Math.PI))*t*2;return(t<a?t-a+t:a)*e/t}function getTintedCanvasImage(e,t,a){return osc3.width=e.width*pixelRatio,osc3.height=e.height*pixelRatio,osctx3.setTransform(pixelRatio,0,0,pixelRatio,0,0),osctx3.save(),osctx3.fillStyle=a,osctx3.globalAlpha=t,osctx3.fillRect(0,0,osc3.width,osc3.height),osctx3.globalCompositeOperation="destination-atop",osctx3.globalAlpha=1,osctx3.drawImage(e,0,0),osctx3.restore(),osc3}function drawPossiblyTintedImage(e,t,a,r){0<r&&r<50?ctx.drawImage(getTintedCanvasImage(e,r/70,"rgb(255,"+(100-r)+","+(100-r)+")"),t,a,e.width,e.height):ctx.drawImage(e,t,a)}function setBody(t){char[t].leg1skew=0;let a,r=[char[t].leg2skew=0,0];if(char[t].legdire=char[t].dire/2-1,ifCarried(t)&&0==cornerHangTimer)offSetLegs(t,60,3),char[t].leg1frame=3,char[t].leg2frame=3;else if(char[t].dire%2==0&&char[t].onob){if(0<=char[t].standingOn){var o=char[t].standingOn;for(let e=1;e<=2;e++)(a=char[t].x+charModels[char[t].id].legx[e-1])>=char[o].x+char[o].w?r[e-1]=char[o].x+char[o].w-a:a<=char[o].x-char[o].w&&(r[e-1]=char[o].x-char[o].w-a)}else if(0==char[t].fricGoal)for(let e=1;e<=2;e++){var c,l;safeToStandAt(a=char[t].x+charModels[char[t].id].legx[e-1],char[t].y+1)?r[e-1]=0:(c=safeToStandAt(a-30,char[t].y+1),l=safeToStandAt(a+30,char[t].y+1),c&&(!l||a%30-10*(e-1.5)<30-a%30)&&!horizontalProp(t,-1,1,char[t].x-15,char[t].y)?r[e-1]=-a%30:l&&!horizontalProp(t,1,1,char[t].x+15,char[t].y)&&(r[e-1]=30-a%30))}41<=r[1]-r[0]&&(r[0]=r[1],r[1]-=3),r[0]>r[1]&&0<=r[1]?(char[t].leg1frame=0,char[t].leg2frame=0,char[t].leg1skew=r[0]/42,char[t].leg2skew=r[0]/42):r[0]>r[1]&&r[0]<=0?(char[t].leg1frame=0,char[t].leg2frame=0,char[t].leg1skew=r[1]/42,char[t].leg2skew=r[1]/42):r[0]<0&&0<r[1]?(char[t].leg1frame=0,char[t].leg2frame=0,char[t].leg1skew=r[0]/42,char[t].leg2skew=r[1]/42):0<r[1]&&0==r[0]?(char[t].leg1frame=0,char[t].leg2frame=0,char[t].leg1skew=.72,char[t].leg2skew=.72):r[0]<0&&0==r[1]?(char[t].leg1frame=0,char[t].leg2frame=0,char[t].leg1skew=-.72,char[t].leg2skew=-.72):(char[t].leg1frame=0,char[t].leg2frame=0,char[t].leg1skew=0,char[t].leg2skew=0)}else{char[t].dire%2==1&&char[t].onob&&offSetLegs(t,28,2),1<=char[t].submerged&&!char[t].onob&&(offSetLegs(t,20,4),char[t].leg1frame=4,char[t].leg2frame=4);for(let e=1;e<=2;e++)1<=char[t].submerged&&!char[t].onob||(char[t].onob?(char[t].leg1frame=2,char[t].leg2frame=2):(char[t].leg1frame=1,char[t].leg2frame=1))}1==cutScene&&cLevelDialogueChar[cutSceneLine]==t?char[t].setFrame(2*Math.ceil(char[t].dire/2)-1):t==control&&1<=recoverTimer?char[t].x-(char[HPRC2].x-33)<25?char[t].setFrame(Math.ceil(char[t].dire/2)+11):char[t].setFrame(Math.ceil(char[t].dire/2)+9):char[t].carry?char[t].setFrame(Math.ceil(char[t].dire/2)+5):char[t].onob||ifCarried(t)?char[t].setFrame(char[t].dire-1):char[t].setFrame(Math.ceil(char[t].dire/2)+3)}function getTileDepths(){for(let e=0;e<6;e++)switchable[e]=[];for(let t=0;t<levelHeight;t++)for(let e=0;e<levelWidth;e++)1<=thisLevel[t][e]&&(1<=blockProperties[thisLevel[t][e]][12]&&switchable[blockProperties[thisLevel[t][e]][12]-1].push([e,t]),(blockProperties[thisLevel[t][e]][14]?tileDepths[3]:1<=blockProperties[thisLevel[t][e]][11]?tileDepths[2]:blockProperties[thisLevel[t][e]][8]?tileDepths[1]:tileDepths[0]).push({x:e,y:t}),6==thisLevel[t][e]&&(locations[0]=e,locations[1]=t),12==thisLevel[t][e]&&(locations[2]=e,locations[3]=t,locations[4]=1e3,locations[5]=0))}function addTileMovieClip(t,a,r){var o=thisLevel[a][t];if(0<blockProperties[o][16]){if(1==blockProperties[o][16])0<blockProperties[o][11]&&void 0!==svgLevers[(blockProperties[o][11]-1)%6]&&(r.save(),r.translate(30*t+15,30*a+28),r.rotate(tileFrames[a][t].rotation*(Math.PI/180)),r.translate(30*-t-15,30*-a-28),r.drawImage(svgLevers[(blockProperties[o][11]-1)%6],30*t,30*a),r.restore()),r.drawImage(svgTiles[o],30*t+svgTilesVB[o][0],30*a+svgTilesVB[o][1]);else if(1<blockProperties[o][16]){let e=0;blockProperties[o][17]?e=blockProperties[o][18][_frameCount%blockProperties[o][18].length]:(e=tileFrames[a][t].cf,tileFrames[a][t].playing&&tileFrames[a][t].cf++,tileFrames[a][t].cf>=blockProperties[o][16]-1&&(tileFrames[a][t].playing=!1,tileFrames[a][t].cf=0)),r.drawImage(svgTiles[o][e],30*t+svgTilesVB[o][e][0],30*a+svgTilesVB[o][e][1])}}else if(6==o){var e=2==playMode?selectedBg:bgs[currentLevel];r.fillStyle=9==e||10==e?"#999999":"#505050",r.fillRect(30*(t-1),30*(a-3),60,120);for(let e=0;e<charCount2;e++)r.fillStyle="rgb("+mapRange(doorLightFade[e],0,1,40,0)+","+mapRange(doorLightFade[e],0,1,40,255)+","+mapRange(doorLightFade[e],0,1,40,0)+")",r.fillRect(30*(t-1)+doorLightX[Math.floor(e/6)==Math.floor((charCount2-1)/6)?(charCount2-1)%6:5][e%6],30*a-80+10*Math.floor(e/6),5,5),0!=doorLightFadeDire[e]&&(doorLightFade[e]=Math.max(Math.min(doorLightFade[e]+.0625*doorLightFadeDire[e],1),0),1!=doorLightFade[e]&&0!=doorLightFade[e]||(doorLightFadeDire[e]=0))}else 12==o&&(gotThisCoin?tileFrames[a][t].cf<svgCoinGet.length&&(r.drawImage(svgCoinGet[tileFrames[a][t].cf],30*t-21,30*a-21),tileFrames[a][t].cf++):locations[4]<200&&(r.save(),r.translate(30*t+15,30*a+15),e=.5235987756*Math.sin(_frameCount*Math.PI/20),r.transform(Math.cos(e),-Math.sin(e),Math.sin(e),Math.cos(e),0,0),r.globalAlpha=Math.max(Math.min((140-.7*locations[4])/100,1),0),r.drawImage(svgCoin,-15,-15,30,30),r.restore()))}function calculateShadowsAndBorders(){for(let r=0;r<levelHeight;r++)for(let a=0;a<levelWidth;a++)if(1<=thisLevel[r][a]){var e=thisLevel[r][a];if(6==e)for(let t=0;t<2&&0<=a-t;t++)for(let e=0;e<4&&0<=r-e;e++)setAmbientShadow(a-t,r-e);else if(110<=e&&e<=129)for(let t=0;t<3;t++)for(let e=0;e<2;e++)setAmbientShadow(a-t,r-e);else blockProperties[thisLevel[r][a]][10]&&setAmbientShadow(a,r);blockProperties[thisLevel[r][a]][13]&&setBorder(a,r,e)}}function setAmbientShadow(a,r){if(tileShadows[r][a]=[],!outOfRange(a,r)){let t=0;for(let e=0;e<4;e++){var o;outOfRange(a+cardinal[e][0],r+cardinal[e][1])||(o=blockProperties[thisLevel[r+cardinal[e][1]][a+cardinal[e][0]]][12],!blockProperties[thisLevel[r+cardinal[e][1]][a+cardinal[e][0]]][e]||0!=o&&6!=o||(t+=Math.pow(2,3-e)))}0<t&&tileShadows[r][a].push(t);for(let e=0;e<4;e++)outOfRange(a+diagonal[e][0],r+diagonal[e][1])||blockProperties[thisLevel[r][a+diagonal[e][0]]][opposite(e,0)]||blockProperties[thisLevel[r+diagonal[e][1]][a]][opposite(e,1)]||!blockProperties[thisLevel[r+diagonal[e][1]][a+diagonal[e][0]]][opposite(e,0)]||0!=blockProperties[thisLevel[r+diagonal[e][1]][a+diagonal[e][0]]][12]||!blockProperties[thisLevel[r+diagonal[e][1]][a+diagonal[e][0]]][opposite(e,1)]||0!=blockProperties[thisLevel[r+diagonal[e][1]][a+diagonal[e][0]]][12]||tileShadows[r][a].push(16+e)}}function setBorder(a,r,o){let c=0;if([98,102,105,107].includes(thisLevel[r][a])&&(c=19),tileBorders[r][a]=[],!outOfRange(a,r)){let t=0;for(let e=0;e<4;e++)outOfRange(a+cardinal[e][0],r+cardinal[e][1])||thisLevel[r+cardinal[e][1]][a+cardinal[e][0]]==o||(t+=Math.pow(2,3-e));0<t&&tileBorders[r][a].push(t+c);for(let e=0;e<4;e++)outOfRange(a+diagonal[e][0],r+diagonal[e][1])||thisLevel[r][a+diagonal[e][0]]!=o||thisLevel[r+diagonal[e][1]][a]!=o||thisLevel[r+diagonal[e][1]][a+diagonal[e][0]]==o||tileBorders[r][a].push(16+e+c)}}function opposite(e,t){return 0==t?3.5-Math.abs(e-1.5):1==t?Math.floor(e/2):void 0}function getCoin(e){!gotThisCoin&&7<=char[e].charState&&Math.floor((char[e].x-char[e].w)/30)<=locations[2]&&Math.ceil((char[e].x+char[e].w)/30)-1>=locations[2]&&Math.floor((char[e].y-char[e].h)/30)<=locations[3]&&Math.ceil(char[e].y/30)-1>=locations[3]&&(gotThisCoin=!0)}function setCamera(){levelWidth<=32?cameraX=15*levelWidth-480:char[control].x-cameraX<384?cameraX=Math.min(Math.max(cameraX+.12*(char[control].x-384-cameraX),0),30*levelWidth-960):576<=char[control].x-cameraX&&(cameraX=Math.min(Math.max(cameraX+.12*(char[control].x-576-cameraX),0),30*levelWidth-960)),levelHeight<=18?cameraY=15*levelHeight-270:char[control].y-cameraY<216?cameraY=Math.min(Math.max(cameraY+.12*(char[control].y-216-cameraY),0),30*levelHeight-540):324<=char[control].y-cameraY&&(cameraY=Math.min(Math.max(cameraY+.12*(char[control].y-324-cameraY),0),30*levelHeight-540))}function checkButton(r){if(char[r].onob){var e,o=Math.ceil(char[r].y/30);if(0<=o&&o<=levelHeight-1)for(let a=Math.floor((char[r].x-char[r].w)/30);a<=Math.floor((char[r].x+char[r].w)/30);a++)if(!outOfRange(a,o)&&13<=(e=blockProperties[thisLevel[o][a]][11])){1!=tileFrames[o][a].cf&&(leverSwitch(e-13),tileFrames[o][a].cf=1,tileFrames[o][a].playing=!1);let t=!0;for(let e=0;e<char[r].buttonsPressed.length;e++)char[r].buttonsPressed[e][0]==a&&char[r].buttonsPressed[e][1]==o&&(t=!1);t&&char[r].buttonsPressed.push([a,o])}}}function checkButton2(r,e){if(char[r].y<30*levelHeight+30)for(let t=char[r].buttonsPressed.length-1;0<=t;t--){var o=char[r].buttonsPressed[t][0],c=char[r].buttonsPressed[t][1];if(!char[r].onob||0<=char[r].standingOn||char[r].x<30*o-char[r].w||char[r].x>=30*o+30+char[r].w||e){let a=!0;for(let t=0;t<charCount;t++)if(t!=r)for(let e=0;e<char[t].buttonsPressed.length;e++)char[t].buttonsPressed[e][0]==o&&char[t].buttonsPressed[e][1]==c&&(a=!1);a&&(e?leverSwitch2(blockProperties[thisLevel[c][o]][11]-13,r):leverSwitch(blockProperties[thisLevel[c][o]][11]-13),tileFrames[c][o].cf=2,tileFrames[c][o].playing=!0);for(let e=0;e<char[r].buttonsPressed.length;e++)e>t&&(char[r].buttonsPressed[e][0]=char[r].buttonsPressed[e-1][0],char[r].buttonsPressed[e][1]=char[r].buttonsPressed[e-1][1]);char[r].buttonsPressed.pop()}}}function leverSwitch(t){for(let e=0;e<switchable[t].length;e++){var a=switchable[Math.min(t,5)][e][0],r=switchable[Math.min(t,5)][e][1];for(let e=0;e<switches[t].length;e++)thisLevel[r][a]==switches[t][2*e]?thisLevel[r][a]=switches[t][2*e+1]:thisLevel[r][a]==switches[t][2*e+1]&&(thisLevel[r][a]=switches[t][2*e])}for(let e=0;e<charCount;e++)char[e].justChanged=2,checkDeath(e)}function leverSwitch2(t,a){for(let e=0;e<switchable[t].length;e++){var r=switchable[Math.min(t,5)][e][0],o=switchable[Math.min(t,5)][e][1];for(let e=0;e<switches[t].length;e++)thisLevel[o][r]==switches[t][2*e]?thisLevel[o][r]=switches[t][2*e+1]:thisLevel[o][r]==switches[t][2*e+1]&&(thisLevel[o][r]=switches[t][2*e])}for(let e=0;e<charCount;e++)e!=a&&(char[e].justChanged=2,checkDeath(e))}function checkDeath(a){for(let t=Math.floor((char[a].y-char[a].h)/30);t<=Math.floor((char[a].y-.01)/30);t++)for(let e=Math.floor((char[a].x-char[a].w)/30);e<=Math.floor((char[a].x+char[a].w)/30);e++)outOfRange(e,t)||(blockProperties[thisLevel[t][e]][4]||blockProperties[thisLevel[t][e]][5]||blockProperties[thisLevel[t][e]][6]||blockProperties[thisLevel[t][e]][7])&&startDeath(a)}function heat(e){0==char[e].submerged&&(char[e].temp+=char[e].heatSpeed),char[e].justChanged=2,50<char[e].temp&&3!=char[e].id&&(startDeath(e),2==char[e].id&&extinguish(e)),1==char[e].heated&&unheat(e)}function unheat(e){!(exitTileHorizontal(e,-1)||exitTileHorizontal(e,1)||exitTileVertical(e,1)||exitTileVertical(e,-1))||somewhereHeated(e)||(char[e].heated=0)}function somewhereHeated(a){for(let t=Math.max(Math.floor((char[a].x-char[a].w)/30),0);t<=Math.min(Math.floor((char[a].x+char[a].w)/30),levelWidth-1);t++)for(let e=Math.max(Math.floor((char[a].y-char[a].h)/30),0);e<=Math.min(Math.floor(char[a].y/30),levelHeight-1);e++)if(15==thisLevel[e][t])return!0;return!1}function extinguish(t){for(let e=0;e<charCount;e++)5<=char[e].charState&&e!=t&&0<char[e].temp&&Math.abs(char[t].x-char[e].x)<char[t].w+char[e].w&&char[e].y>char[t].y-char[t].h&&char[e].y<char[t].y+char[e].h&&(char[e].temp=0)}function submerge(e){0<char[e].temp&&(char[e].temp=0);var t=somewhereSubmerged(e);char[e].submerged<=1&&2<=t&&(char[e].weight2-=.16,rippleWeight(e,.16,-1),char[e].vx*=.1,char[e].vy*=.1),char[e].submerged=t}function unsubmerge(t){if(exitTileHorizontal(t,-1)||exitTileHorizontal(t,1)||exitTileVertical(t,1)||exitTileVertical(t,-1)){let e=somewhereSubmerged(t);0==e&&1<=char[t].submerged&&(2==char[t].submerged&&exitTileVertical(t,-1)&&char[t].weight2<0&&!ifCarried(t)&&(char[t].vy=0,char[t].y=30*Math.ceil(char[t].y/30),e=1),char[t].weight2+=.16,rippleWeight(t,.16,1)),char[t].submerged=e}}function somewhereSubmerged(e){let a=0;for(let t=Math.floor((char[e].x-char[e].w)/30);t<=Math.floor((char[e].x+char[e].w)/30);t++){var r=Math.floor((char[e].y-char[e].h)/30),o=Math.floor(char[e].y/30);for(let e=r;e<=o;e++)!outOfRange(t,e)&&blockProperties[thisLevel[e][t]][14]&&(e==o?0==a&&(a=2):a=3)}return a}function newTileUp(e){return Math.floor((char[e].y-char[e].h)/30)<Math.floor((char[e].py-char[e].h)/30)}function newTileDown(e){return Math.ceil(char[e].y/30)>Math.ceil(char[e].py/30)}function newTileHorizontal(e,t){return Math.ceil(t*(char[e].x+char[e].w*t)/30)>Math.ceil(t*(char[e].px+char[e].w*t)/30)}function exitTileHorizontal(e,t){return Math.ceil(t*(char[e].x-char[e].w*t)/30)>Math.ceil(t*(char[e].px-char[e].w*t)/30)}function exitTileVertical(e,t){var a=.5*t+.5;return Math.ceil(t*(char[e].y-char[e].h*a)/30)>Math.ceil(t*(char[e].py-char[e].h*a)/30)}function allSolid(e){return blockProperties[e][0]&&blockProperties[e][1]&&blockProperties[e][2]&&blockProperties[e][3]}function solidAt(e,t){e=getBlockTypeAt(e,t);return"number"!=typeof e||blockProperties[e][0]&&blockProperties[e][1]&&blockProperties[e][2]&&blockProperties[e][3]}function solidCeiling(e,t){return blockProperties[getBlockTypeAt(e,t)][0]}function safeToStandAt(e,t){e=getBlockTypeAt(e,t);return"number"!=typeof e||blockProperties[e][1]&&!blockProperties[e][5]&&14!=e&&16!=e&&83!=e&&85!=e}function getBlockTypeAt(e,t){return thisLevel[Math.floor(t/30)][Math.floor(e/30)]}function verticalProp(e,t,a,r,o){var c=-.5*t+.5,l=Math.floor((o-char[e].h*c)/30);if(a<=3&&-1==t&&-1==l)return!0;if(4<=a&&a<=7)for(j=Math.floor((r-char[e].w)/30);j<=Math.floor((r+char[e].w-.01)/30);j++)if(!outOfRange(j,l)&&blockProperties[thisLevel[l][j]][a-4]&&!blockProperties[thisLevel[l][j]][a])return!1;for(j=Math.floor((r-char[e].w)/30);j<=Math.floor((r+char[e].w-.01)/30);j++)if(!outOfRange(j,l)&&blockProperties[thisLevel[l][j]][a]&&(1!=a||!ifCarried(e)||allSolid(thisLevel[l][j])))return!0;return!1}function horizontalProp(t,a,r,e,o){var c=Math.floor((e+char[t].w*a)/30);if(r<=3&&(-1==a&&c<=-1||1==a&&c>=levelWidth))return!0;if(4<=r&&r<=7)for(let e=Math.floor((o-char[t].h)/30);e<=Math.floor((o-.01)/30);e++)if(!outOfRange(c,e)&&!outOfRange(c-a,e)&&blockProperties[thisLevel[e][c]][r-4]&&!blockProperties[thisLevel[e][c-a]][r-4]&&!blockProperties[thisLevel[e][c]][r])return!1;for(j=Math.floor((o-char[t].h)/30);j<=Math.floor((o-.01)/30);j++)if(!outOfRange(c,j)&&blockProperties[thisLevel[j][c]][r])return!0;return!1}function verticalType(t,e,a,r){var e=-.5*e+.5,o=Math.floor((char[t].y-char[t].h*e)/30);let c=!1;for(let e=Math.floor((char[t].x-char[t].w)/30);e<=Math.floor((char[t].x+char[t].w-.01)/30);e++)outOfRange(e,o)||thisLevel[o][e]==a&&(r&&(tileFrames[o][e].playing=!0,tileFrames[o][e].cf=1),c=!0);return c}function horizontalType(t,e,a){var r=Math.floor((char[t].x+char[t].w*e)/30);for(let e=Math.floor((char[t].y-char[t].h)/30);e<=Math.floor((char[t].y-.01)/30);e++)if(!outOfRange(r,e)&&thisLevel[e][r]==a)return!0;return!1}function land(e,t,a){char[e].y=t,char[e].weight2<=0?char[e].vy=-Math.abs(a):(char[e].vy=a,char[e].onob=!0)}function land2(e,t){control<1e3&&(char[control].landTimer=0),stopCarrierY(e,t,!1)}function centered(e,t){return e%2==0?(t-e-2+t%2)/2:(e+t-1+t%2)/2}function onlyConveyorsUnder(t){var a=Math.floor(char[t].y/30+.5),r=Math.floor((char[t].x-char[t].w)/30),o=Math.floor((char[t].x+char[t].w-.01)/30);let c=0;for(let e=0;e<=o-r;e++){var l=centered(e,1+o-r)+r;if(!outOfRange(l,a)){l=thisLevel[a][l];if(blockProperties[l][1])if(14==l||83==l)0==c&&(c=-2.48);else if(16==l||85==l)0==c&&(c=2.48);else if(0==e||10==char[t].charState)return 0}}return c}function startCutScene(){if(0==cutScene)if(toSeeCS){cutScene=1;for(let e=cutSceneLine=0;e<char.length;e++)7<=char[e].charState&&char[e].id<35&&(char[e].diaMouthFrame=diaMouths[char[e].expr+2*charModels[char[e].id].mouthType].frameorder.length-1);displayLine(currentLevel,cutSceneLine),char[control].dire=2*Math.ceil(char[control].dire/2)}else{rescue();for(let e=0;e<cLevelDialogueChar.length;e++){var t=cLevelDialogueChar[e];50<=t&&t<60&&leverSwitch(t-50)}cutScene=3}}function endCutScene(){toSeeCS=!1,cutScene=2,rescue(),char[control].expr=charModels[char[control].id].defaultExpr}function rescue(){for(let e=0;e<charCount;e++)9==char[e].charState&&(char[e].charState=10,char[e].expr=charModels[char[e].id].defaultExpr)}function displayLine(e,t){let a=cLevelDialogueChar[t];if(50<=a&&a<60&&(leverSwitch(a-50),cutSceneLine++,t++,a=cLevelDialogueChar[t],cutSceneLine>=cLevelDialogueChar.length))endCutScene();else{let e;99==a?e=480:a<char.length&&(e=Math.min(Math.max(char[a].x,bubWidth/2+bubMargin),960-bubWidth/2-bubMargin),putDown(a)),bubSc=.1,bubX=e,bubY=270<char[control].y-cameraY?bubMargin+bubHeight/2:520-bubMargin-bubHeight/2,a<char.length&&(char[a].expr=cLevelDialogueFace[t]-2,char[a].diaMouthFrame=0),csText=cLevelDialogueText[t]}}function startDeath(e){30<=char[e].deathTimer&&(7<=char[e].charState||50<=char[e].temp)&&(ifCarried(e)&&(char[char[e].carriedBy].vy=0,char[char[e].carriedBy].vx=0,putDown(char[e].carriedBy)),char[e].pcharState=char[e].charState,checkButton2(e,!0),fallOff(e),char[e].deathTimer=20,char[e].leg1frame=1,char[e].leg2frame=1,char[e].leg1skew=0,char[e].leg2skew=0,char[e].frame=7+Math.ceil(char[e].dire/2))}function endDeath(e){putDown(e),char[e].temp=0,char[e].heated=0,char[e].charState=1,char[e].atEnd&&!quirksMode&&(doorLightFadeDire[charsAtEnd-1]=-1,charsAtEnd--,char[e].atEnd=!1),deathCount++,saveGame(),e==control&&changeControl()}function bounce(e){ifCarried(e)&&bounce(char[e].carriedBy),char[e].dire%2==0&&(char[e].fricGoal=0),char[e].jump(1.66*-jumpPower),char[e].onob=!1,char[e].y=30*Math.floor(char[e].y/30)-10}function bumpHead(e){0<=char[e].standingOn&&(char[e].onob=!1,char[char[e].standingOn].vy=0,fallOff(e))}function ifCarried(e){return 0<=char[e].carriedBy&&char[e].carriedBy<=190&&char[char[e].carriedBy].carry}function stopCarrierX(e,t){ifCarried(e)&&(char[char[e].carriedBy].x=t-xOff(e),char[char[e].carriedBy].vx=0)}function stopCarrierY(e,t,a){var r;ifCarried(e)&&(!char[char[e].carriedBy].onob||0<=char[char[e].carriedBy].standingOn&&0!=char[char[char[e].carriedBy].standingOn].vy)&&(0<=char[char[e].carriedBy].standingOn&&(char[char[char[e].carriedBy].standingOn].vy=0,fallOff(char[e].carriedBy)),0<=char[char[e].carriedBy].vy&&a&&!solidAt(char[char[e].carriedBy].x,char[e].y+15)&&(a=solidAt(char[char[e].carriedBy].x-char[char[e].carriedBy].w-15,char[e].y+15)||solidAt(char[char[e].carriedBy].x-char[char[e].carriedBy].w-45,char[e].y+15),r=solidAt(char[char[e].carriedBy].x+char[char[e].carriedBy].w+15,char[e].y+15)||solidAt(char[char[e].carriedBy].x+char[char[e].carriedBy].w+45,char[e].y+15),char[e].justChanged=2,char[char[e].carriedBy].justChanged=2,a&&r?putDown(char[e].carriedBy):a?char[char[e].carriedBy].vx+=power:r&&(char[char[e].carriedBy].vx-=power),30<++cornerHangTimer&&putDown(char[e].carriedBy)),-1!=char[e].carriedBy&&(char[char[e].carriedBy].vy=0,char[char[e].carriedBy].y=t+yOff(e),newTileDown(char[e].carriedBy)&&verticalProp(char[e].carriedBy,1,1,char[char[e].carriedBy].x,char[char[e].carriedBy].y)&&(char[char[e].carriedBy].y=30*Math.floor(char[char[e].carriedBy].y/30))))}function rippleWeight(e,t,a){0<=char[e].standingOn&&(char[char[e].standingOn].weight2+=t*a,1==char[char[e].standingOn].submerged&&char[char[e].standingOn].weight2<0&&(char[char[e].standingOn].submerged=2),2<=char[char[e].standingOn].submerged&&char[char[e].standingOn].weight2<0&&char[char[e].standingOn].onob&&(char[char[e].standingOn].onob=!1),rippleWeight(char[e].standingOn,t,a))}function onlyMovesOneBlock(e,t){var t=2*Math.floor((char[t].dire-1)/2)-1,a=Math.ceil(t*(char[e].x+char[e].w*t)/30),e=Math.ceil(t*(char[control].x+xOff2(control)+char[e].w*t)/30);return Math.abs(e-a)<=1}function putDown(e){char[e].carry&&(rippleWeight(e,char[char[e].carryObject].weight2,-1),char[e].weight2=char[e].weight,char[char[e].carryObject].weight2=char[char[e].carryObject].weight,char[e].carry=!1,char[e].justChanged=2,swapDepths(char[e].carryObject,2*(charCount-char[e].carryObject-1)),char[char[e].carryObject].carriedBy=-1,char[char[e].carryObject].stopMoving()),cornerHangTimer=0}function charThrow(e){char[e].weight2=char[e].weight,char[char[e].carryObject].weight2=char[char[e].carryObject].weight,char[char[e].carryObject].vy=-7.5,char[char[e].carryObject].vx=char[e].vx,char[e].dire<=2?char[char[e].carryObject].vx-=3:char[char[e].carryObject].vx+=3}function landOnObject(t){let a=1e4,r=0;for(let e=0;e<charCount;e++){var o;ifCarried(e)||6!=char[e].charState&&4!=char[e].charState||(o=Math.abs(char[t].x-char[e].x))<char[t].w+char[e].w&&char[t].y>=char[e].y-char[e].h&&(char[t].py<char[e].py-char[e].h||char[t].py==char[e].py-char[e].h&&0==char[t].vy)&&o-char[e].w<a&&(a=o-char[e].w,r=e)}a<1e4&&char[t].standingOn!=r&&(0<=char[t].standingOn&&fallOff(t),6!=char[r].charState||char[r].onob||(char[r].vy=inter(char[r].vy,char[t].vy,char[t].weight2/(char[r].weight2+char[t].weight2))),land(t,char[r].y-char[r].h,char[r].vy),char[r].onob&&land2(t,char[r].y-char[r].h),char[t].standingOn=r,char[r].stoodOnBy.push(t),rippleWeight(t,char[t].weight2,1),char[t].fricGoal=char[r].fricGoal,1==char[r].submerged&&0<=char[r].weight2&&(char[r].submerged=2,char[r].weight2-=.16))}function objectsLandOn(t){for(let e=0;e<charCount;e++)5<=char[e].charState&&char[e].standingOn!=t&&Math.abs(char[t].x-char[e].x)<char[t].w+char[e].w&&char[t].y-char[t].h<=char[e].y&&char[t].py-char[t].h>char[e].py&&(char[t].submerged<=1||!char[e].onob||2==char[e].submerged)&&(0<=char[e].standingOn&&fallOff(e),char[e].standingOn=t,char[t].stoodOnBy.push(e),land(e,char[t].y-char[t].h,char[e].vy),6==char[t].charState&&(char[t].vy=inter(char[t].vy,char[e].vy,char[e].weight2/(char[t].weight2+char[e].weight2))),char[e].vy=char[t].vy,rippleWeight(e,char[e].weight2,1),char[e].fricGoal=char[t].fricGoal)}function fallOff(a){if(0<=char[a].standingOn){let t=!1;1==char[char[a].standingOn].submerged?char[char[a].standingOn].submerged=2:rippleWeight(a,char[a].weight2,-1);var r=char[char[a].standingOn].stoodOnBy.length;for(let e=0;e<r;e++)(t=char[char[a].standingOn].stoodOnBy[e]==a?!0:t)&&e<=r-2&&(char[char[a].standingOn].stoodOnBy[e]=char[char[a].standingOn].stoodOnBy[e+1]);char[char[a].standingOn].stoodOnBy.pop(),char[a].standingOn=-1,char[a].onob=!1;for(let e;e<char[a].stoodOnBy.length;e++)fallOff(char[a].stoodOnBy[e])}}function aboveFallOff(t){if(1<=char[t].stoodOnBy.length)for(let e=0;e<char[t].stoodOnBy.length;e++)fallOff(char[t].stoodOnBy[e])}function changeControl(){7<=char[control].charState&&(char[control].stopMoving(),swapDepths(control,2*(charCount-control-1)),char[control].carry&&swapDepths(char[control].carryObject,2*(charCount-control-1)+1)),control=(control+1)%charCount;let e=0;for(;10!=char[control].charState&&e<charCount;)control=(control+1)%charCount,e++;(control=e==charCount?1e4:control)<1e3&&(ifCarried(control)&&putDown(char[control].carriedBy),swapDepths(control,2*charCount),char[control].carry&&swapDepths(char[control].carryObject,2*charCount+1),char[control].burstFrame=0,char[control].expr=charModels[char[control].id].defaultExpr)}function swapDepths(e,t){charDepths[charDepths.indexOf(e)]=charDepths[t],charDepths[t]=e}function nextDeadPerson(e,t){for(i2=(e+t+charCount)%charCount;1!=char[i2].charState;)i2=(i2+t+charCount)%charCount;return i2}function numberOfDead(){let t=0;for(let e=0;e<charCount;e++)1==char[e].charState&&t++;return t}function recoverCycle(e,t){let a=0,r=0==t?1:t;for(recover2=(recover2+r+charCount)%charCount;(1!=char[recover2].charState||char[recover2].pcharState<=6)&&a<charCount;)recover2=(recover2+r+charCount)%charCount,a++;a==charCount?(HPRCBubbleFrame=4,hprcBubbleAnimationTimer=0,recover=!1,recover2=0):1==numberOfDead()?HPRCBubbleFrame=2:(HPRCBubbleFrame=3,hprcBubbleAnimationTimer=t)}function near(e,t){var a=char[t].y-23-(char[e].y-char[e].h2/2);return Math.abs(a)<=char[t].h/2+char[e].h2/2&&Math.abs(char[e].x+xOff2(e)-char[t].x)<50}function near2(e,t){var a=char[t].y-23-(char[e].y-char[e].h2/2);return Math.abs(a)<=20&&Math.abs(char[e].x+xOff2(e)-char[t].x)<50}function xOff(e){return char[char[e].carriedBy].w*(2*Math.ceil(char[char[e].carriedBy].dire/2)-3)*.7}function xOff2(e){return char[e].w*(2*Math.ceil(char[e].dire/2)-3)*.7}function yOff(e){return 6==char[e].charState?char[char[e].carriedBy].h2:char[char[e].carriedBy].h2-13}function inter(e,t,a){return e+(t-e)*a}function calcDist(e){return Math.sqrt(Math.pow(char[e].x-30*locations[2]+15,2)+Math.pow(char[e].y-char[e].h/2-30*locations[3]+15,2))}function outOfRange(e,t){return e<0||t<0||e>levelWidth-1||t>levelHeight-1}function mouseOnGrid(){return _xmouse>=330-scale*levelWidth/2&&_xmouse<=330+scale*levelWidth/2&&_ymouse>=240-scale*levelHeight/2&&_ymouse<=240+scale*levelHeight/2}function resetLevelCreator(){levelAlreadySharedToExplore=!1,lcPopUp=!1,duplicateChar=!1,reorderCharUp=!1,reorderCharDown=!1,reorderDiaUp=!1,reorderDiaDown=!1,menuScreen=5,selectedTab=0,selectedBg=0,levelWidth=32,tool=0,levelHeight=18,clearMyWholeLevel(),myLevelNecessaryDeaths=0,charDropdown=-1,charsTabScrollBar=0,tileTabScrollBar=0,diaTabScrollBar=0,bgsTabScrollBar=0,lcMessageTimer=0,lcMessageText="",charCount2=0,charCount=0,myLevelDialogue=[[],[],[]],myLevelInfo={name:"Untitled",creator:"",desc:""},LCEndGateX=-1,LCEndGateY=-1,LCCoinX=-1,LCCoinY=-1,char=[],levelTimer=0,resetLCOSC()}function resetLCOSC(){osc1.width=Math.floor(cwidth*pixelRatio),osc1.height=Math.floor(cheight*pixelRatio),osctx1.setTransform(pixelRatio,0,0,pixelRatio,0,0),setLCBG();osc2.width=Math.floor(300*pixelRatio),osc2.height=Math.floor(110*Math.floor(imgBgs.length/2+1)*pixelRatio),osctx2.setTransform(pixelRatio,0,0,pixelRatio,0,0);for(let e=0;e<imgBgs.length;e++)osctx2.drawImage(imgBgs[e],14+e%2*110,56+110*Math.floor(e/2),96,54);osc3.width=Math.floor(cwidth*pixelRatio),osc3.height=Math.floor(cheight*pixelRatio),osctx3.setTransform(pixelRatio,0,0,pixelRatio,0,0),updateLCtiles()}function setLCBG(){osctx1.drawImage(imgBgs[selectedBg],-97,0,854,480)}function drawLCGrid(){scale=Math.min(640/levelWidth,460/levelHeight),ctx.lineWidth=scale/9,ctx.strokeStyle="#000000",ctx.globalAlpha=.5,ctx.beginPath();for(let e=0;e<=levelWidth;e++)ctx.moveTo(330-scale*levelWidth/2+e*scale,240-scale*levelHeight/2),ctx.lineTo(330-scale*levelWidth/2+e*scale,240+scale*levelHeight/2);for(let e=0;e<=levelHeight;e++)ctx.moveTo(330-scale*levelWidth/2,240-scale*levelHeight/2+e*scale),ctx.lineTo(330+scale*levelWidth/2,240-scale*levelHeight/2+e*scale);ctx.stroke(),ctx.globalAlpha=1}function drawLCTiles(){ctx.drawImage(osc3,0,0,cwidth,cheight);var o,c,l=330-scale*levelWidth/2,i=240-scale*levelHeight/2;for(let r=0;r<levelWidth;r++)for(let a=0;a<levelHeight;a++){let e=myLevel[1][a][r],t=(ctx.globalAlpha=1)<blockProperties[e][16];5==tool&&copied&&mouseOnGrid()&&(c=Math.floor((_xmouse-(330-scale*levelWidth/2))/scale),o=Math.floor((_ymouse-(240-scale*levelHeight/2))/scale),r>=c&&r<c+tileClipboard[0].length&&a>=o&&a<o+tileClipboard.length&&(clipboardTileCandidate=tileClipboard[a-o][r-c],_keysDown[18]&&0!=e||0==clipboardTileCandidate||(e=clipboardTileCandidate,ctx.globalAlpha=.5,t=!0))),t&&(o=1<blockProperties[e][16]?svgTiles[e][blockProperties[e][17]?_frameCount%blockProperties[e][16]:0]:svgTiles[e],c=1<blockProperties[e][16]?svgTilesVB[e][blockProperties[e][17]?_frameCount%blockProperties[e][16]:0]:svgTilesVB[e],ctx.drawImage(o,l+r*scale+scale*c[0]/30,i+a*scale+scale*c[1]/30,scale*c[2]/30,scale*c[3]/30))}}function drawLCRect(e,t,a,r){ctx.fillStyle="#ffff00",ctx.globalAlpha=.5,ctx.moveTo(e*scale+(330-scale*levelWidth/2),t*scale+(240-scale*levelHeight/2)),ctx.lineTo((a+1)*scale+(330-scale*levelWidth/2),t*scale+(240-scale*levelHeight/2)),ctx.lineTo((a+1)*scale+(330-scale*levelWidth/2),(r+1)*scale+(240-scale*levelHeight/2)),ctx.lineTo(e*scale+(330-scale*levelWidth/2),(r+1)*scale+(240-scale*levelHeight/2)),ctx.lineTo(e*scale+(330-scale*levelWidth/2),t*scale+(240-scale*levelHeight/2)),ctx.fill(),ctx.globalAlpha=1}function clearMyWholeLevel(){myLevel=new Array(3);for(let e=0;e<3;e++)clearMyLevel(e);myLevelChars=[[],[],[]]}function clearMyLevel(a){myLevel[a]=new Array(levelHeight);for(let t=0;t<levelHeight;t++){myLevel[a][t]=new Array(levelWidth);for(let e=0;e<levelWidth;e++)myLevel[a][t][e]=0}}function clearRectSelect(){LCRect=[-1,-1,-1,-1]}function fillTile(a,r,o,c){if(o!=c){let t=[[a,r]];for(;1<=t.length;){for(let e=0;e<4;e++){var l,i;3==e&&a==levelWidth-1||2==e&&0==a||1==e&&r==levelHeight-1||0==e&&0==r||(outOfRange(l=t[0][0]+cardinal[e][0],i=t[0][1]+cardinal[e][1])||myLevel[1][i][l]!=c||(t.push([l,i]),myLevel[1][i][l]=o))}t.shift()}updateLCtiles()}}function setUndo(){levelAlreadySharedToExplore=!1,LCSwapLevelData(1,0),undid=!1}function undo(){levelAlreadySharedToExplore=!1,LCSwapLevelData(1,2),LCSwapLevelData(0,1),LCSwapLevelData(2,0),undid=!undid,updateLCtiles(),levelTimer=0,char=new Array(myLevelChars[1].length);for(let e=0;e<myLevelChars[1].length;e++)char[e]=generateCharFromInfo(myLevelChars[1][e])}function copyRect(){if(copied)copied=!1;else if(5==tool&&-1!=LCRect[0]){var a=Math.min(LCRect[0],LCRect[2]),r=Math.min(LCRect[1],LCRect[3]),o=Math.max(LCRect[0],LCRect[2]),e=Math.max(LCRect[1],LCRect[3]);tileClipboard=new Array(e-r);for(let t=r;t<=e;t++){tileClipboard[t-r]=new Array(o-a);for(let e=a;e<=o;e++)tileClipboard[t-r][e-a]=myLevel[1][t][e]}LCRect=[-1,-1,-1,-1],copied=!0}}function LCSwapLevelData(a,r){myLevel[r]=new Array(myLevel[a].length);for(let t=0;t<myLevel[a].length;t++){myLevel[r][t]=new Array(myLevel[a][0].length);for(let e=0;e<myLevel[a][0].length;e++)myLevel[r][t][e]=myLevel[a][t][e]}1==r&&(levelHeight=myLevel[r].length,levelWidth=myLevel[r][0].length),myLevelChars[r]=new Array(myLevelChars[a].length);for(let e=0;e<myLevelChars[a].length;e++)myLevelChars[r][e]=cloneCharInfo(myLevelChars[a][e],!1);myLevelDialogue[r]=new Array(myLevelDialogue[a].length);for(let e=0;e<myLevelDialogue[a].length;e++){var t=myLevelDialogue[a][e];myLevelDialogue[r][e]={char:t.char,face:t.face,text:t.text,linecount:t.linecount}}}function mouseOnScreen(){return _xmouse<660&&_ymouse<480}function setSelectedTile(e){selectedTile=e,!blockProperties[selectedTile][9]||2!=tool&&3!=tool||(tool=1)}function closeToEdgeY(){var e=(_ymouse-(240-scale*levelHeight/2))/scale%1;return.25<Math.abs(e-.5)}function closeToEdgeX(){var e=(_xmouse-(330-scale*levelWidth/2))/scale%1;return.25<Math.abs(e-.5)}function removeLCTiles(){console.log("removeLCTiles")}function updateLCtiles(){scale=Math.min(640/levelWidth,460/levelHeight),osctx3.clearRect(0,0,osc3.width,osc3.height);let a=[33,34,53,54,61,62,64,82,134];var r=[!1,!1,!1,!1,!1,!1,!0,!0,!0],o=["#ffcc00","#d5aa00","#0066ff","#0051ca","#20df20","#1ab01a","#20df20","#ffcc00","#0066ff"],c=330-scale*levelWidth/2,l=240-scale*levelHeight/2;for(let t=0;t<levelWidth;t++)for(let e=0;e<levelHeight;e++){var i,h,n=myLevel[1][e][t];0<blockProperties[n][11]&&blockProperties[n][11]<13&&(osctx3.save(),osctx3.translate(c+(t+.5)*scale,l+(e+.9333)*scale),osctx3.rotate(blockProperties[n][11]<7?-1:1),osctx3.translate(-c-(t+.5)*scale,-l-(e+.9333)*scale),osctx3.drawImage(svgLevers[(blockProperties[n][11]-1)%6],c+t*scale,l+e*scale,scale,scale),osctx3.restore()),0<blockProperties[n][16]?1==blockProperties[n][16]&&(i=1<blockProperties[n][16]?svgTiles[n][blockProperties[n][17]?_frameCount%blockProperties[n][16]:0]:svgTiles[n],h=1<blockProperties[n][16]?svgTilesVB[n][blockProperties[n][17]?_frameCount%blockProperties[n][16]:0]:svgTilesVB[n],osctx3.drawImage(i,c+t*scale+scale*h[0]/30,l+e*scale+scale*h[1]/30,scale*h[2]/30,scale*h[3]/30)):6==n?(osctx3.fillStyle=9==selectedBg||10==selectedBg?"#999999":"#505050",osctx3.fillRect(c+(t-1)*scale,l+(e-3)*scale,2*scale,4*scale)):blockProperties[n][15]&&0<n&&(i=svgTiles[n],h=svgTilesVB[n],osctx3.drawImage(i,c+t*scale+scale*h[0]/30,l+e*scale+scale*h[1]/30,scale*h[2]/30,scale*h[3]/30)),-1!=a.indexOf(n)&&(osctx3.globalAlpha=.25,n=a.indexOf(n),osctx3.fillStyle=o[n],osctx3.fillRect(c+t*scale,l+e*scale,scale,r[n]?scale/3:scale),osctx3.globalAlpha=1)}}function setTool(e){2!=tool&&5!=tool||(clearRectSelect(),tool==e&&5==tool&&(copied=!1)),tool=e}function setEndGateLights(){LCEndGateX}function drawLCCharInfo(t,a){ctx.fillStyle="#626262",ctx.fillRect(665,a,240,charInfoHeight),ctx.fillStyle="#808080",ctx.fillRect(665,a,charInfoHeight,charInfoHeight),ctx.fillStyle="#808080",ctx.fillRect(905-1.5*charInfoHeight,a,1.5*charInfoHeight,charInfoHeight);var r=charModels[myLevelChars[1][t][0]].charimgmat;if(void 0!==r){let e=svgChars[myLevelChars[1][t][0]];Array.isArray(e)&&(e=e[0]);var o=charInfoHeight/32;ctx.save(),ctx.transform(r.a*o,r.b,r.c,r.d*o,r.tx*o/2+665+charInfoHeight/2,r.ty*o/2+a+charInfoHeight/2),ctx.drawImage(e,-e.width/2,-e.height/2),ctx.restore()}if(ctx.fillStyle="#ffffff",ctx.fillText(twoDecimalPlaceNumFormat(Math.max(myLevelChars[1][t][1],0))+", "+twoDecimalPlaceNumFormat(Math.max(myLevelChars[1][t][2],0)),665+charInfoHeight+5,a+charInfoHeight/2),ctx.fillText(charStateNamesShort[myLevelChars[1][t][3]],905-1.5*charInfoHeight+5,a+charInfoHeight/2),3==myLevelChars[1][t][3]||4==myLevelChars[1][t][3]){ctx.fillStyle="#808080",ctx.fillRect(665,a+charInfoHeight,charInfoHeight,diaInfoHeight),ctx.fillStyle="#ffffff",ctx.fillText(char[t].speed.toString().padStart(2,"0"),670,a+charInfoHeight+.5*diaInfoHeight);var c=mouseOnTabWindow&&!lcPopUp&&-1==charDropdown&&!duplicateChar&&!reorderCharUp&&!reorderCharDown&&!addButtonPressed,l=(c&&onRect(_xmouse,_ymouse+charsTabScrollBar,665,a+charInfoHeight,charInfoHeight,diaInfoHeight)&&(onButton=!0,hoverText="Movement Speed",mouseIsDown&&!pmouseIsDown&&(setUndo(),charDropdown=-t-3,charDropdownType=3,valueAtClick=char[t].speed)),1<myLevelChars[1][t][5].length);for(let e=0;e<myLevelChars[1][t][5].length;e++)ctx.fillStyle="#626262",ctx.fillRect(665+charInfoHeight,a+charInfoHeight+diaInfoHeight*e,100-charInfoHeight,diaInfoHeight),ctx.fillStyle="#ffffff",ctx.fillText(direLetters[myLevelChars[1][t][5][e][0]],665+charInfoHeight+5,a+charInfoHeight+diaInfoHeight*(e+.5),240-charInfoHeight,charInfoHeight),ctx.fillText(myLevelChars[1][t][5][e][1],665+1.5*charInfoHeight+5,a+charInfoHeight+diaInfoHeight*(e+.5),240-charInfoHeight,charInfoHeight),c&&(onRect(_xmouse,_ymouse+charsTabScrollBar,665+charInfoHeight,a+charInfoHeight+diaInfoHeight*e,120-charInfoHeight,diaInfoHeight)?(_xmouse<665+1.5*charInfoHeight?(onButton=!0,hoverText="Direction",mouseIsDown&&!pmouseIsDown&&(setUndo(),charDropdown=-t-3,charDropdownType=4,charDropdownMS=e)):_xmouse<665+charInfoHeight+100-charInfoHeight?(onButton=!0,hoverText="Block Count",mouseIsDown&&!pmouseIsDown&&(setUndo(),charDropdown=-t-3,charDropdownType=5,charDropdownMS=e,valueAtClick=myLevelChars[1][t][5][e][1])):l&&(onButton=!0,mouseIsDown&&!pmouseIsDown&&(setUndo(),myLevelChars[1][t][5].splice(e,1),char[t].motionString=generateMS(myLevelChars[1][t]),levelTimer=0,resetCharPositions())),l&&drawRemoveButton(665+charInfoHeight+100-charInfoHeight,a+charInfoHeight+diaInfoHeight*e,diaInfoHeight,3)):0<e&&onRect(_xmouse,_ymouse+charsTabScrollBar,665+charInfoHeight+120-charInfoHeight,a+charInfoHeight+diaInfoHeight*(e-.5),diaInfoHeight,diaInfoHeight)&&(drawAddButton(665+charInfoHeight+120-charInfoHeight,a+charInfoHeight+diaInfoHeight*(e-.5),diaInfoHeight,3),onButton=!0,hoverText="Insert Into Path",mouseIsDown&&!pmouseIsDown&&(setUndo(),myLevelChars[1][t][5].splice(e,0,[0,1]),char[t].motionString=generateMS(myLevelChars[1][t]),levelTimer=0,resetCharPositions())),e==myLevelChars[1][t][5].length-1&&(drawAddButton(905-1.5*charInfoHeight,a+charInfoHeight+diaInfoHeight*e,diaInfoHeight,3),onRect(_xmouse,_ymouse+charsTabScrollBar,905-1.5*charInfoHeight,a+charInfoHeight+diaInfoHeight*e,diaInfoHeight,diaInfoHeight)&&(onButton=!0,hoverText="Add to Path",mouseIsDown&&!pmouseIsDown&&(setUndo(),myLevelChars[1][t][5].push([0,1]),char[t].motionString=generateMS(myLevelChars[1][t]),levelTimer=0,resetCharPositions()))))}if(mouseOnTabWindow&&!lcPopUp&&-1==charDropdown&&!addButtonPressed&&onRect(_xmouse,_ymouse+charsTabScrollBar,665,a,260,charInfoHeight))if(duplicateChar){if(mouseIsDown&&!pmouseIsDown){setUndo(),char.splice(t+1,0,cloneChar(char[t])),myLevelChars[1].splice(t+1,0,cloneCharInfo(myLevelChars[1][t],!0));for(let e=myLevelDialogue[1].length-1;0<=e;e--)myLevelDialogue[1][e].char<50&&myLevelDialogue[1][e].char>t&&myLevelDialogue[1][e].char++;duplicateChar=!1}}else if(reorderCharDown){if(mouseIsDown&&!pmouseIsDown){if(t<myLevelChars[1].length-1){setUndo(),[char[t],char[t+1]]=[char[t+1],char[t]],[myLevelChars[1][t],myLevelChars[1][t+1]]=[myLevelChars[1][t+1],myLevelChars[1][t]];for(let e=myLevelDialogue[1].length-1;0<=e;e--)myLevelDialogue[1][e].char<50&&(myLevelDialogue[1][e].char==t?myLevelDialogue[1][e].char++:myLevelDialogue[1][e].char==t+1&&myLevelDialogue[1][e].char--)}reorderCharDown=!1}}else if(reorderCharUp){if(mouseIsDown&&!pmouseIsDown){if(0<t){setUndo(),[char[t],char[t-1]]=[char[t-1],char[t]],[myLevelChars[1][t],myLevelChars[1][t-1]]=[myLevelChars[1][t-1],myLevelChars[1][t]];for(let e=myLevelDialogue[1].length-1;0<=e;e--)myLevelDialogue[1][e].char<50&&(myLevelDialogue[1][e].char==t?myLevelDialogue[1][e].char--:myLevelDialogue[1][e].char==t-1&&myLevelDialogue[1][e].char++)}reorderCharUp=!1}}else if(ctx.fillStyle="#ee3333",drawRemoveButton(905,a+charInfoHeight/2-10,20,3),onRect(_xmouse,_ymouse+charsTabScrollBar,665,a,charInfoHeight,charInfoHeight))onButton=!0,hoverText="ID",mouseIsDown&&!pmouseIsDown&&(setUndo(),charDropdown=-t-3,charDropdownType=0);else if(onRect(_xmouse,_ymouse+charsTabScrollBar,905-1.5*charInfoHeight,a,1.5*charInfoHeight,charInfoHeight))onButton=!0,hoverText="State",mouseIsDown&&!pmouseIsDown&&(charDropdown=-t-3,charDropdownType=1);else if(_xmouse<905)onButton=!0,hoverText="Start Location",mouseIsDown&&!pmouseIsDown&&(setUndo(),charDropdown=-t-3,charDropdownType=2);else if(onRect(_xmouse,_ymouse+charsTabScrollBar,905,a+charInfoHeight/2-10,20,20)&&(onButton=!0,mouseIsDown&&!pmouseIsDown)){setUndo(),char.splice(t,1),myLevelChars[1].splice(t,1);for(let e=myLevelDialogue[1].length-1;0<=e;e--)myLevelDialogue[1][e].char<50&&(myLevelDialogue[1][e].char==t?myLevelDialogue[1].splice(e,1):myLevelDialogue[1][e].char>t&&myLevelDialogue[1][e].char--)}}function drawLCDiaInfo(e,t){if(ctx.fillStyle="#808080",ctx.fillRect(665,t,3*diaInfoHeight,diaInfoHeight*myLevelDialogue[1][e].linecount),ctx.fillStyle="#ffffff",50<=myLevelDialogue[1][e].char&&myLevelDialogue[1][e].char<99){var a=[myLevelDialogue[1][e].text,["lever switch"]];switch(myLevelDialogue[1][e].char){case 50:ctx.fillStyle="#ffcc00";break;case 51:ctx.fillStyle="#0066ff";break;case 52:ctx.fillStyle="#20df20";break;case 53:ctx.fillStyle="#ff0000";break;case 54:ctx.fillStyle="#9933ff";break;case 55:ctx.fillStyle="#505050"}ctx.fillRect(665+3*diaInfoHeight,t,240-3*diaInfoHeight,diaInfoHeight),ctx.fillStyle="#ffffff",ctx.font=diaInfoHeight+"px Helvetica",ctx.textAlign="left",ctx.textBaseline="top",ctx.fillText("lever switch",665+3*diaInfoHeight+5,t)}else a=drawTextBox(myLevelDialogue[1][e].text,665+3*diaInfoHeight,t,240-3*diaInfoHeight,diaInfoHeight*myLevelDialogue[1][e].linecount,20,[5,0,0,0],e,!1,"#626262","#ffffff","Helvetica");myLevelDialogue[1][e].text=a[0],myLevelDialogue[1][e].linecount=a[1].length,ctx.fillText(2==myLevelDialogue[1][e].face?"H":"S",665+2*diaInfoHeight+5,t),ctx.fillText(myLevelDialogue[1][e].char.toString().padStart(2,"0"),670,t),mouseOnTabWindow&&!lcPopUp&&-1==diaDropdown&&!addButtonPressed&&onRect(_xmouse,_ymouse-diaTabScrollBar,665,t,260,diaInfoHeight*myLevelDialogue[1][e].linecount)&&(reorderDiaDown?mouseIsDown&&!pmouseIsDown&&(e<myLevelDialogue[1].length-1&&(setUndo(),[myLevelDialogue[1][e],myLevelDialogue[1][e+1]]=[myLevelDialogue[1][e+1],myLevelDialogue[1][e]]),reorderDiaDown=!1,editingTextBox=-1):reorderDiaUp?mouseIsDown&&!pmouseIsDown&&(0<e&&(setUndo(),[myLevelDialogue[1][e],myLevelDialogue[1][e-1]]=[myLevelDialogue[1][e-1],myLevelDialogue[1][e]]),reorderDiaUp=!1,editingTextBox=-1):(ctx.fillStyle="#ee3333",drawRemoveButton(905,t+diaInfoHeight*myLevelDialogue[1][e].linecount/2-10,20,3),onRect(_xmouse,_ymouse-diaTabScrollBar,665,t,2*diaInfoHeight,diaInfoHeight*myLevelDialogue[1][e].linecount)?(onButton=!0,hoverText="Character",mouseIsDown&&!pmouseIsDown&&(diaDropdown=-e-3,diaDropdownType=1,editingTextBox=-1)):onRect(_xmouse,_ymouse-diaTabScrollBar,665+2*diaInfoHeight,t,diaInfoHeight,diaInfoHeight*myLevelDialogue[1][e].linecount)?(onButton=!0,hoverText="Face",mouseIsDown&&!pmouseIsDown&&(diaDropdown=-e-3,diaDropdownType=0,editingTextBox=-1)):_xmouse<905&&_xmouse>665+3*diaInfoHeight?mouseIsDown&&!pmouseIsDown&&(diaDropdown=-e-3,diaDropdownType=2):onRect(_xmouse,_ymouse-diaTabScrollBar,905,t+diaInfoHeight*myLevelDialogue[1][e].linecount/2-10,20,20)&&(onButton=!0,mouseIsDown&&!pmouseIsDown&&(setUndo(),myLevelDialogue[1].splice(e,1),editingTextBox=-1))))}function drawLCChars(){ctx.save();var e,t=scale/30;ctx.transform(t,0,0,t,330-scale*levelWidth/2,240-scale*levelHeight/2);for(let a=char.length-1;0<=a;a--){if(char[a].placed||charDropdown==a&&2==charDropdownType){if(char[a].placed||(ctx.globalAlpha=.5),char[a].id<35){var r,o=charModels[char[a].id],c=9==char[a].charState?-1:1,l=legFrames[0],l=[l.bodypart,l.bodypart],i=(ctx.save(),ctx.transform(.3648529052734375*c,0,0,.3648529052734375,char[a].x+o.legx[0]+.35,char[a].y+o.legy[0]-.35),svgBodyParts[l[0]]),i=(ctx.drawImage(i,-i.width/2,-i.height/2),ctx.restore(),ctx.save(),ctx.transform(.3648529052734375*c,0,0,.3648529052734375,char[a].x+o.legx[1]+.35,char[a].y+o.legy[1]-.35),svgBodyParts[l[1]]),h=(ctx.drawImage(i,-i.width/2,-i.height/2),ctx.restore(),o.frames[1==c?3:1]);ctx.save(),ctx.transform(charModels[char[a].id].torsomat.a,charModels[char[a].id].torsomat.b,charModels[char[a].id].torsomat.c,charModels[char[a].id].torsomat.d,char[a].x+charModels[char[a].id].torsomat.tx,char[a].y+charModels[char[a].id].torsomat.ty);for(let t=0;t<h.length;t++){let e=svgBodyParts[h[t].bodypart];"body"==h[t].type&&(e=svgChars[char[a].id]),ctx.save(),ctx.transform(h[t].mat.a,h[t].mat.b,h[t].mat.c,h[t].mat.d,h[t].mat.tx,h[t].mat.ty),"anim"==h[t].type?(e=svgBodyParts[bodyPartAnimations[h[t].anim].bodypart],r=h[t].loop?_frameCount%bodyPartAnimations[h[t].anim].frames.length:0,r=bodyPartAnimations[h[t].anim].frames[r],ctx.transform(r.a,r.b,r.c,r.d,r.tx,r.ty)):"dia"==h[t].type&&(e=svgBodyParts[diaMouths[(9==char[a].charState?1:char[a].dExpr)+2*charModels[char[a].id].mouthType].frames[0].bodypart],r=diaMouths[o.defaultExpr].frames[0].mat,ctx.transform(r.a,r.b,r.c,r.d,r.tx,r.ty)),ctx.drawImage(e,-e.width/2,-e.height/2),ctx.restore()}ctx.restore()}else i=1==charD[char[a].id][7]?(e=svgCharsVB[char[a].id],svgChars[char[a].id]):(l=_frameCount%charD[char[a].id][7],e=svgCharsVB[char[a].id][l],svgChars[char[a].id][l]),ctx.drawImage(i,char[a].x+e[0],char[a].y+e[1],e[2],e[3]);ctx.globalAlpha=1}!char[a].placed||3!=char[a].charState&&4!=char[a].charState||(c=Math.floor(levelTimer/char[a].speed)%(char[a].motionString.length-2),char[a].vx=cardinal[char[a].motionString[2+c]][0]*(30/char[a].speed),char[a].vy=cardinal[char[a].motionString[2+c]][1]*(30/char[a].speed),char[a].px=char[a].x,char[a].py=char[a].y,char[a].charMove())}ctx.restore()}function resetLCChar(e){if(3==myLevelChars[1][e][3]||4==myLevelChars[1][e][3])if(0==char[e].motionString.length){for(;myLevelChars[1][e].length<6;)myLevelChars[1][e].push([]);myLevelChars[1][e][4]=10,myLevelChars[1][e][5]=[[3,1],[2,1]],char[e].speed=myLevelChars[1][e][4],char[e].motionString=generateMS(myLevelChars[1][e])}else myLevelChars[1][e][4]=char[e].speed,myLevelChars[1][e][5]=generateMSOtherFormatted(e);else for(;4<myLevelChars[1][e].length;)myLevelChars[1][e].pop();var t=myLevelChars[1][e][0];char[e].id=t,char[e].x=char[e].px=30*+myLevelChars[1][e][1].toFixed(2),char[e].y=char[e].py=30*+myLevelChars[1][e][2].toFixed(2),char[e].charState=myLevelChars[1][e][3],char[e].w=charD[t][0],char[e].h=charD[t][1],char[e].weight=charD[t][2],char[e].weight2=charD[t][2],char[e].h2=charD[t][3],char[e].friction=charD[t][4],char[e].heatSpeed=charD[t][6],char[e].hasArms=charD[t][8],char[e].dExpr=t<35?charModels[t].defaultExpr:0}function cloneChar(e){let t=new Character(e.id,0,0,0,0,e.charState,e.w,e.h,e.weight,e.weight2,e.h2,e.friction,e.heatSpeed,e.hasArms,e.dExpr);return t.placed=!1,t.speed=e.speed,t.motionString=Object.values(e.motionString),t}function cloneCharInfo(t,e){let a=[t[0],e?-1:t[1],e?-1:t[2],t[3]];if(6==t.length){a.push(t[4]),a.push([]);for(let e=0;e<t[5].length;e++)a[5].push([t[5][e][0],t[5][e][1]])}return a}function generateCharFromInfo(e){var t=e[0];let a=new Character(t,30*e[1],30*e[2],30*e[1],30*e[2],e[3],charD[t][0],charD[t][1],charD[t][2],charD[t][2],charD[t][3],charD[t][4],charD[t][6],charD[t][8],t<35?charModels[t].defaultExpr:0);return-1!=e[1]&&-1!=e[2]||(a.placed=!1),6==e.length&&(a.speed=e[4],a.motionString=generateMS(e)),a}function copyLevelString(){navigator.clipboard.writeText(generateLevelString()).then(function(){lcMessageTimer=1,lcMessageText="Level string successfuly copied to clipboard!"},function(e){lcMessageTimer=1,lcMessageText="There was an error while copying the level string.",console.error("Could not copy text: ",e)})}function generateLevelString(){longMode=!1;for(let t=0;t<levelHeight;t++){for(let e=0;e<levelWidth;e++)120<myLevel[1][t][e]&&(longMode=!0);a+="\r\n"}var a="\r\n",a=(a+=""==myLevelInfo.name?"Untitled level":myLevelInfo.name+"\r\n")+(levelWidth.toString().padStart(2,"0")+","+levelHeight.toString().padStart(2,"0")+","+char.length.toString().padStart(2,"0")+","+selectedBg.toString().padStart(2,"0")+","+(longMode?"H":"L")+"\r\n");if(longMode)for(let t=0;t<levelHeight;t++){for(let e=0;e<levelWidth;e++)120<myLevel[1][t][e]?a+="/":a+=".",a+=tileCharFromID(myLevel[1][t][e]);a+="\r\n"}else for(let t=0;t<levelHeight;t++){for(let e=0;e<levelWidth;e++)a+=tileCharFromID(myLevel[1][t][e]);a+="\r\n"}for(let e=0;e<char.length;e++)a+=myLevelChars[1][e][0].toString().padStart(2,"0")+","+twoDecimalPlaceNumFormat(myLevelChars[1][e][1])+","+twoDecimalPlaceNumFormat(myLevelChars[1][e][2])+","+myLevelChars[1][e][3].toString().padStart(2,"0"),3!=myLevelChars[1][e][3]&&4!=myLevelChars[1][e][3]||(a+=" "+char[e].motionString.map(String).join("")),a+="\r\n";a+=myLevelDialogue[1].length.toString().padStart(2,"0")+"\r\n";for(let e=0;e<myLevelDialogue[1].length;e++)a+=myLevelDialogue[1][e].char.toString().padStart(2,"0")+(2==myLevelDialogue[1][e].face?"H":"S")+" "+myLevelDialogue[1][e].text+"\r\n";return a+=myLevelNecessaryDeaths.toString().padStart(6,"0")+"\r\n"}function openLevelLoader(){lcPopUp=!0,lcPopUpType=0,levelLoadString="",canvas.setAttribute("contenteditable",!0)}function readLevelString(e){setUndo();let a=e.split("\r\n"),c=(1==a.length&&(a=e.split("\n")),0);for(;c<a.length&&""==a[c];)c++;if(!(c>=a.length||(myLevelInfo.name=a[c],++c>=a.length))){e=a[c].split(",");if(e.length<5)setLCMessage("Error while loading from string:\nFewer than 5 comma separated values in the line below the title.");else if(levelWidth=Math.max(parseInt(e[0],10),1),levelHeight=Math.max(parseInt(e[1],10),1),charCount=parseInt(e[2],10),((selectedBg=parseInt(e[3],10))>imgBgs.length||isNaN(selectedBg))&&(selectedBg=0),setLCBG(),longMode="H"==e[4],++c>=a.length||isNaN(levelWidth)||isNaN(levelHeight)||isNaN(charCount)||50<charCount)levelWidth=myLevel[1][0].length,levelHeight=myLevel[1].length,charCount=0,myLevelChars[1].length=0,char.length=0,setLCMessage("Error while loading from string:\n"+(c>=a.length?"no tile map was provided.":"one or more values in the level's metadata was invalid."));else{if(myLevelChars[1]=new Array(charCount),char=new Array(charCount),myLevel[1]=new Array(levelHeight),longMode)for(let t=0;t<levelHeight;t++){myLevel[1][t]=new Array(levelWidth);for(let e=0;e<levelWidth;e++)c+t>=a.length||2*e+1>=a[c+t].length?myLevel[1][t][e]=0:(myLevel[1][t][e]=111*tileIDFromChar(a[c+t].charCodeAt(2*e))+tileIDFromChar(a[c+t].charCodeAt(2*e+1)),(myLevel[1][t][e]>blockProperties.length||myLevel[1][t][e]<0)&&(myLevel[1][t][e]=0))}else for(let t=0;t<levelHeight;t++){myLevel[1][t]=new Array(levelWidth);for(let e=0;e<levelWidth;e++)c+t>=a.length||e>=a[c+t].length?myLevel[1][t][e]=0:(myLevel[1][t][e]=tileIDFromChar(a[c+t].charCodeAt(e)),(myLevel[1][t][e]>blockProperties.length||myLevel[1][t][e]<0)&&(myLevel[1][t][e]=0))}if(setCoinAndDoorPos(),updateLCtiles(),(c+=levelHeight)>=a.length)charCount=0,myLevelChars[1].length=0,char.length=0,setLCMessage("Error while loading from string:\nno entity data was provided.");else{for(let o=levelTimer=0;o<myLevelChars[1].length;o++){if(c+o>=a.length)return myLevelChars[1].length=o,char.length=o,void setLCMessage("Error while loading from string:\nnumber of entities did not match the provided count.");let r=a[c+o].split(",").join(" ").split(" ");if(myLevelChars[1][o]=[0,-1,-1,10],3<r.length){if(isNaN(parseInt(r[0],10))||isNaN(parseFloat(r[1],10))||isNaN(parseFloat(r[2],10))||isNaN(parseInt(r[3],10)))return myLevelChars[1].length=o,char.length=o,void setLCMessage("Error while loading from string:\na data value in one entity's data parsed to NaN.");myLevelChars[1][o][0]=Math.max(Math.min(parseInt(r[0],10),charD.length),0),myLevelChars[1][o][1]=parseFloat(r[1],10),myLevelChars[1][o][2]=parseFloat(r[2],10),myLevelChars[1][o][3]=Math.max(Math.min(parseInt(r[3],10),10),3)}let e=myLevelChars[1][o][0];if(charD[e][7]<1&&(e=e<35?8:37),char[o]=new Character(e,30*+myLevelChars[1][o][1].toFixed(2),30*+myLevelChars[1][o][2].toFixed(2),70+40*o,400-30*o,myLevelChars[1][o][3],charD[e][0],charD[e][1],charD[e][2],charD[e][2],charD[e][3],charD[e][4],charD[e][6],charD[e][8],e<35?charModels[e].defaultExpr:0),(myLevelChars[1][o][1]<0||myLevelChars[1][o][2]<0)&&(char[o].placed=!1),3==myLevelChars[1][o][3]||4==myLevelChars[1][o][3])if(5==r.length){myLevelChars[1][o][4]=parseInt(r[4].slice(0,2),10),myLevelChars[1][o][5]=[];let t=r[4].charCodeAt(2)-48,a=1;for(let e=2;e<r[4].length-1;e++)t!=r[4].charCodeAt(e+1)-48?(myLevelChars[1][o][5].push([Math.min(Math.max(t,0),3),a]),a=1,t=r[4].charCodeAt(e+1)-48):a++;myLevelChars[1][o][5].push([t,a]),char[o].motionString=generateMS(myLevelChars[1][o]),char[o].speed=myLevelChars[1][o][4]}else myLevelChars[1][o][3]=6}if((c+=myLevelChars[1].length)>=a.length)setLCMessage("Error while loading from string:\nnumber of dialogue lines was not provided.");else{myLevelDialogue[1]=new Array(parseInt(a[c],10)),c++;for(let e=0;e<myLevelDialogue[1].length;e++){if(c+e>=a.length)return myLevelDialogue[1].length=e,void setLCMessage("Error while loading from string:\nnumber of dialogue lines did not match the provided count.");myLevelDialogue[1][e]={char:0,face:2,text:""},myLevelDialogue[1][e].char=parseInt(a[c+e].slice(0,2),10),isNaN(myLevelDialogue[1][e].char)&&(myLevelDialogue[1][e].char=99),myLevelDialogue[1][e].face="S"==a[c+e].charAt(2)?3:2,myLevelDialogue[1][e].text=a[c+e].substring(4)}(c+=myLevelDialogue[1].length)>=a.length?setLCMessage("Error while loading from string:\nnecessary deaths was not provided.\n(but everything else loaded so it's probably fine)"):myLevelNecessaryDeaths=parseInt(a[c],10)}}}}}function readExploreLevelString(e){myLevelChars=new Array(3),myLevel=new Array(3),myLevelDialogue=new Array(3),myLevelInfo={name:"Untitled"};let a=e.split("\r\n"),c=(1==a.length&&(a=e.split("\n")),0);for(;c<a.length&&(""==a[c]||"loadedLevels="==a[c]);)c++;if(!(c>=a.length||(myLevelInfo.name=a[c],++c>=a.length))){e=a[c].split(",");if(5==e.length)if(levelWidth=Math.max(parseInt(e[0],10),1),levelHeight=Math.max(parseInt(e[1],10),1),charCount=parseInt(e[2],10),((selectedBg=parseInt(e[3],10))>imgBgs.length||isNaN(selectedBg))&&(selectedBg=0),longMode="H"==e[4],++c>=a.length||isNaN(levelWidth)||isNaN(levelHeight)||isNaN(charCount)||50<charCount)levelWidth=myLevel[1][0].length,levelHeight=myLevel[1].length,charCount=0,myLevelChars[1].length=0,char.length=0;else{if(myLevelChars[1]=new Array(charCount),char=new Array(charCount),myLevel[1]=new Array(levelHeight),longMode)for(let t=0;t<levelHeight;t++){myLevel[1][t]=new Array(levelWidth);for(let e=0;e<levelWidth;e++)c+t>=a.length||2*e+1>=a[c+t].length?myLevel[1][t][e]=0:(myLevel[1][t][e]=111*tileIDFromChar(a[c+t].charCodeAt(2*e))+tileIDFromChar(a[c+t].charCodeAt(2*e+1)),(myLevel[1][t][e]>blockProperties.length||myLevel[1][t][e]<0)&&(myLevel[1][t][e]=0))}else for(let t=0;t<levelHeight;t++){myLevel[1][t]=new Array(levelWidth);for(let e=0;e<levelWidth;e++)c+t>=a.length||e>=a[c+t].length?myLevel[1][t][e]=0:(myLevel[1][t][e]=tileIDFromChar(a[c+t].charCodeAt(e)),(myLevel[1][t][e]>blockProperties.length||myLevel[1][t][e]<0)&&(myLevel[1][t][e]=0))}if((c+=levelHeight)>=a.length)charCount=0,myLevelChars[1].length=0,char.length=0;else{for(let o=levelTimer=0;o<myLevelChars[1].length;o++){if(c+o>=a.length)return myLevelChars[1].length=o,void(char.length=o);let r=a[c+o].split(",").join(" ").split(" ");if(myLevelChars[1][o]=[0,-1,-1,10],3<r.length){if(isNaN(parseInt(r[0],10))||isNaN(parseFloat(r[1],10))||isNaN(parseFloat(r[2],10))||isNaN(parseInt(r[3],10)))return myLevelChars[1].length=o,void(char.length=o);myLevelChars[1][o][0]=Math.max(Math.min(parseInt(r[0],10),charD.length),0),myLevelChars[1][o][1]=parseFloat(r[1],10),myLevelChars[1][o][2]=parseFloat(r[2],10),myLevelChars[1][o][3]=Math.max(Math.min(parseInt(r[3],10),10),3)}let e=myLevelChars[1][o][0];if(charD[e][7]<1&&(e=e<35?8:37),char[o]=new Character(e,30*+myLevelChars[1][o][1].toFixed(2),30*+myLevelChars[1][o][2].toFixed(2),70+40*o,400-30*o,myLevelChars[1][o][3],charD[e][0],charD[e][1],charD[e][2],charD[e][2],charD[e][3],charD[e][4],charD[e][6],charD[e][8],e<35?charModels[e].defaultExpr:0),(myLevelChars[1][o][1]<0||myLevelChars[1][o][2]<0)&&(char[o].placed=!1),3==myLevelChars[1][o][3]||4==myLevelChars[1][o][3])if(5==r.length){myLevelChars[1][o][4]=parseInt(r[4].slice(0,2),10),myLevelChars[1][o][5]=[];let t=r[4].charCodeAt(2)-48,a=1;for(let e=2;e<r[4].length-1;e++)t!=r[4].charCodeAt(e+1)-48?(myLevelChars[1][o][5].push([Math.min(Math.max(t,0),3),a]),a=1,t=r[4].charCodeAt(e+1)-48):a++;myLevelChars[1][o][5].push([t,a]),char[o].motionString=generateMS(myLevelChars[1][o]),char[o].speed=myLevelChars[1][o][4]}else myLevelChars[1][o][3]=6}if(!((c+=myLevelChars[1].length)>=a.length)){myLevelDialogue[1]=new Array(parseInt(a[c],10)),c++;for(let e=0;e<myLevelDialogue[1].length;e++){if(c+e>=a.length)return void(myLevelDialogue[1].length=e);myLevelDialogue[1][e]={char:0,face:2,text:""},myLevelDialogue[1][e].char=parseInt(a[c+e].slice(0,2),10),isNaN(myLevelDialogue[1][e].char)&&(myLevelDialogue[1][e].char=99),myLevelDialogue[1][e].face="S"==a[c+e].charAt(2)?3:2,myLevelDialogue[1][e].text=a[c+e].substring(4)}(c+=myLevelDialogue[1].length)>=a.length||(myLevelNecessaryDeaths=parseInt(a[c],10))}}}}}function setLCMessage(e){lcMessageTimer=1,lcMessageText=e,console.log(e)}function tileCharFromID(e){let t;return t=93==e?8364:e<=80?e+46:e<=102?e+80:e+81,120<e&&(t-=146),String.fromCharCode(t)}function tileIDFromChar(e){return 8364==e?93:e<=126?e-46:e<=182?e-80:e-81}function twoDecimalPlaceNumFormat(e){return(Math.round(100*e)/100).toFixed(2).padStart(5,"0")}function generateMS(e){let a=[];a.push(Math.floor(e[4]/10)),a.push(e[4]%10);var r=e[5];for(let t=0;t<r.length;t++)for(let e=0;e<r[t][1];e++)a.push(r[t][0]);return a}function generateMSOtherFormatted(t){let a=[],r=char[t].motionString[2],o=1;for(let e=2;e<char[t].motionString.length-1;e++)r!=char[t].motionString[e+1]?(a.push([r,o]),o=1,r=char[t].motionString[e+1]):o++;return a.push([r,o]),a}function resetCharPositions(){for(let e=0;e<myLevelChars[1].length;e++)char[e].x=30*myLevelChars[1][e][1],char[e].y=30*myLevelChars[1][e][2]}function setCoinAndDoorPos(){LCEndGateX=LCEndGateY=LCCoinX=LCCoinY=-1;for(let t=0;t<myLevel[1].length;t++)for(let e=0;e<myLevel[1][t].length;e++)6==myLevel[1][t][e]&&(-1==LCEndGateX&&-1==LCEndGateY?(LCEndGateX=e,LCEndGateY=t):myLevel[1][t][e]=0),12==myLevel[1][t][e]&&(-1==LCCoinX&&-1==LCCoinY?(LCCoinX=e,LCCoinY=t):myLevel[1][t][e]=0)}function drawAddButton(e,t,a,r){ctx.strokeStyle="#606060",ctx.lineWidth=3,e+=r,t+=r,a-=2*r,ctx.beginPath(),ctx.moveTo(e+a/2,t),ctx.lineTo(e+a/2,t+a),ctx.moveTo(e,t+a/2),ctx.lineTo(e+a,t+a/2),ctx.stroke()}function drawDuplicateButton(e,t,a,r){ctx.strokeStyle="#606060",ctx.lineWidth=3,e+=r,t+=r,a-=2*r,ctx.strokeRect(e+a/3,t+a/3,2*a/3,2*a/3),ctx.beginPath(),ctx.moveTo(e+a/3,t+2*a/3),ctx.lineTo(e,t+2*a/3),ctx.lineTo(e,t),ctx.lineTo(e+2*a/3,t),ctx.lineTo(e+2*a/3,t+a/3),ctx.stroke()}function drawUpButton(e,t,a,r){ctx.strokeStyle="#606060",ctx.lineWidth=3,e+=r,t+=r,a-=2*r,ctx.beginPath(),ctx.moveTo(e+a/2,t+a),ctx.lineTo(e+a/2,t),ctx.moveTo(e,t+a/2),ctx.lineTo(e+a/2,t),ctx.lineTo(e+a,t+a/2),ctx.stroke()}function drawDownButton(e,t,a,r){ctx.strokeStyle="#606060",ctx.lineWidth=3,e+=r,t+=r,a-=2*r,ctx.beginPath(),ctx.moveTo(e+a/2,t),ctx.lineTo(e+a/2,t+a),ctx.moveTo(e,t+a/2),ctx.lineTo(e+a/2,t+a),ctx.lineTo(e+a,t+a/2),ctx.stroke()}function drawMinusButton(e,t,a,r){ctx.strokeStyle="#606060",ctx.lineWidth=3,e+=r,t+=r,a-=2*r,ctx.beginPath(),ctx.moveTo(e,t+a/2),ctx.lineTo(e+a,t+a/2),ctx.stroke()}function drawRemoveButton(e,t,a,r){ctx.strokeStyle="#ee3333",ctx.lineWidth=3,e+=r,t+=r,a-=2*r,ctx.beginPath(),ctx.moveTo(e,t),ctx.lineTo(e+a,t+a),ctx.moveTo(e+a,t),ctx.lineTo(e,t+a),ctx.stroke()}function truncateLevelTitles(){ctx.font="20px Helvetica",exploreLevelTitlesTruncated=new Array(explorePageLevels.length);for(let e=0;e<exploreLevelTitlesTruncated.length;e++)exploreLevelTitlesTruncated[e]=fitString(ctx,explorePageLevels[e].title,195.3)}function drawExploreLevel(e,t,a){onRect(_xmouse,_ymouse,e,t,208,155)?(onButton=!0,ctx.fillStyle="#404040",mouseIsDown&&!pmouseIsDown&&gotoExploreLevelPage(a)):ctx.fillStyle="#333333",ctx.fillRect(e,t,208,155),ctx.drawImage(thumbs[a],e+8,t+8,192,108),ctx.fillStyle="#ffffff",ctx.textBaseline="top",ctx.textAlign="left",ctx.font="20px Helvetica",ctx.fillText(exploreLevelTitlesTruncated[a],e+6.35,t+119.4),ctx.fillStyle="#999999",ctx.font="10px Helvetica",ctx.fillText("by "+explorePageLevels[a].creator.name,e+7,t+138.3)}function setExplorePage(e){getLevelPage(explorePage=e,exploreTab)}function setExploreThumbs(){for(let e=0;e<explorePageLevels.length;e++)drawExploreThumb(thumbsctx[e],thumbs[e].width,explorePageLevels[e].data,.2)}function drawExploreThumb(r,t,o,c){if(1!=exploreTab||6!=menuScreen){r.clearRect(0,0,t*pixelRatio/c,.5625*t*pixelRatio/c);let a=o.split("\r\n"),e=(1==a.length&&(a=o.split("\n")),0);for(;e<a.length&&(""==a[e]||"loadedLevels="==a[e]);)e++;var t=(a=a.splice(e))[1].split(","),l=parseInt(t[0]),i=parseInt(t[1]);if(r.drawImage(imgBgs[parseInt(t[3])],0,0,cwidth,cheight),"H"==t[4])for(let t=0;t<Math.min(i,18);t++)for(let e=0;e<Math.min(l,32);e++)exploreDrawThumbTile(r,e,t,111*tileIDFromChar(a[t+2].charCodeAt(2*e))+tileIDFromChar(a[t+2].charCodeAt(2*e+1)),c);else for(let t=0;t<Math.min(i,18);t++)for(let e=0;e<Math.min(l,32);e++)exploreDrawThumbTile(r,e,t,tileIDFromChar(a[t+2].charCodeAt(e)),c)}}function exploreDrawThumbTile(e,t,a,r,o){0<blockProperties[r][16]?1==blockProperties[r][16]?(0<blockProperties[r][11]&&void 0!==svgLevers[(blockProperties[r][11]-1)%6]&&(e.save(),e.translate(30*t+15,30*a+28),e.rotate((1==Math.ceil(blockProperties[r][11]/6)?-60:60)*(Math.PI/180)),e.translate(30*-t-15,30*-a-28),e.drawImage(svgLevers[(blockProperties[r][11]-1)%6],30*t,30*a),e.restore()),e.drawImage(svgTiles[r],30*t+svgTilesVB[r][0],30*a+svgTilesVB[r][1])):1<blockProperties[r][16]&&e.drawImage(svgTiles[r][0],30*t+svgTilesVB[r][0][0],30*a+svgTilesVB[r][0][1]):6==r&&(e.fillStyle="#505050",e.fillRect(30*(t-1),30*(a-3),60,120))}function drawExploreLoadingText(){ctx.font="bold 35px Helvetica",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillStyle="#ffffff",ctx.fillText("loading...",cwidth/2,cheight/2)}function drawArrow(e,t,a,r,o){ctx.beginPath(),ctx.moveTo(e+a*(1==o?1:3==o?0:.5),t+r*(2==o?1:0==o?0:.5)),ctx.lineTo(e+a*(1!=o),t+r*(2!=o)),ctx.lineTo(e+a*(3==o),t+r*(0==o)),ctx.fill()}function shareToExplore(){postExploreLevel(myLevelInfo.name,myLevelInfo.desc,generateLevelString())}function mousemove(e){_xmouse=e.pageX*addedZoom-canvas.getBoundingClientRect().left,_ymouse=e.pageY*addedZoom-canvas.getBoundingClientRect().top}function mousedown(e){if(mouseIsDown=!0,lastClickX=_xmouse,lastClickY=_ymouse,onRect(_xmouse,_ymouse,0,0,cwidth,cheight)?document.querySelectorAll(".bottomtext").forEach(e=>e.classList.add("unselectable")):document.querySelectorAll(".bottomtext").forEach(e=>e.classList.remove("unselectable")),5==menuScreen)if(660<_xmouse)clearRectSelect();else if(!(Math.abs(_ymouse-510)<=20&&Math.abs(_xmouse-330)<=300)&&2==selectedTab){4!=tool&&setUndo();var t,a=Math.floor((_xmouse-(330-scale*levelWidth/2))/scale),r=Math.floor((_ymouse-(240-scale*levelHeight/2))/scale);if(!mouseOnScreen()||2!=tool&&(5!=tool||copied)||(LCRect[0]=LCRect[2]=Math.min(Math.max(a,0),levelWidth-1),LCRect[1]=LCRect[3]=Math.min(Math.max(r,0),levelHeight-1)),mouseOnGrid())if(3==tool)blockProperties[selectedTile][9]?setTool(0):(t=myLevel[1][r][a],fillTile(a,r,selectedTile,t));else if(4==tool)selectedTab=2,setTool(0),setSelectedTile(myLevel[1][r][a]);else if(5==tool){if(copied)for(let t=0;t<tileClipboard.length&&r+t<levelHeight;t++)for(let e=0;e<tileClipboard[t].length&&a+e<levelWidth;e++){var o=tileClipboard[t][e];_keysDown[18]&&0!=myLevel[1][r+t][a+e]||0==o||6==o||12==o||(myLevel[1][r+t][a+e]=o)}updateLCtiles()}else if(6==tool){let r=0;if(closeToEdgeY()||2<=levelHeight){r=closeToEdgeY()?1:-1,removeLCTiles();var c=Math.round((_ymouse-(240-scale*levelHeight/2))/scale);levelHeight+=r,myLevel[1]=new Array(levelHeight);let a=0;for(let t=0;t<levelHeight;t++){a=t<c?t:Math.max(t-r,0),myLevel[1][t]=new Array(levelWidth);for(let e=0;e<levelWidth;e++)myLevel[1][t][e]=myLevel[0][a][e]}for(let e=0;e<myLevelChars[1].length;e++)myLevelChars[1][e][2]>c&&(myLevelChars[1][e][2]+=r,resetCharPositions());setCoinAndDoorPos(),updateLCtiles()}}else if(7==tool){var l;_xmouse,scale,levelWidth,scale;if(sizeChange=0,closeToEdgeX()||2<=levelWidth){sizeChange=closeToEdgeX()?1:-1,removeLCTiles(),l=Math.round((_xmouse-(330-scale*levelWidth/2))/scale),levelWidth+=sizeChange,myLevel[1]=new Array(levelHeight);let a=0;for(let t=0;t<levelHeight;t++){myLevel[1][t]=new Array(levelWidth);for(let e=x3=0;e<levelWidth;e++)a=e<l?e:Math.max(e-sizeChange,0),myLevel[1][t][e]=myLevel[0][t][a]}for(let e=0;e<myLevelChars[1].length;e++)myLevelChars[1][e][1]>l&&(myLevelChars[1][e][1]+=sizeChange,resetCharPositions());setCoinAndDoorPos(),updateLCtiles()}}}}function mouseup(e){if(mouseIsDown=!1,5==menuScreen&&!blockProperties[selectedTile][9]&&2==tool&&-1!=LCRect[0]){for(y=Math.min(LCRect[1],LCRect[3]);y<=Math.max(LCRect[1],LCRect[3]);){for(x=Math.min(LCRect[0],LCRect[2]);x<=Math.max(LCRect[0],LCRect[2]);)myLevel[1][y][x]=selectedTile,x++;y++}clearRectSelect(),updateLCtiles()}}function keydown(e){_keysDown[e.keyCode||e.charCode]=!0,0<=editingTextBox&&e.keyCode&&(currentTextBoxAllowsLineBreaks&&controlOrCommandPress&&"v"==e.key?navigator.clipboard.readText().then(e=>{inputText+=e}).catch(e=>console.log(e)):1==e.key.length?inputText+=e.key:"Backspace"==e.key?inputText=inputText.slice(0,-1):currentTextBoxAllowsLineBreaks&&("Enter"==e.key||"Return"==e.key)&&e.shiftKey&&(inputText+="\n")),(e.metaKey||e.ctrlKey)&&(controlOrCommandPress=!0),5!=menuScreen||lcPopUp||-1!=editingTextBox||(_xmouse<660&&2==selectedTab&&("1"==e.key||"p"==e.key||"d"==e.key?setTool(0):"2"==e.key||"e"==e.key?setTool(1):"3"==e.key||"r"==e.key?setTool(2):"4"==e.key||"f"==e.key?setTool(3):"5"==e.key||"i"==e.key?setTool(4):"6"==e.key||"s"==e.key?setTool(5):"7"==e.key||"h"==e.key?setTool(6):"8"!=e.key&&"j"!=e.key||setTool(7)),"z"==e.key&&controlOrCommandPress&&undo())}function keyup(e){_keysDown[e.keyCode||e.charCode]=!1,(e.metaKey||e.ctrlKey)&&(controlOrCommandPress=!1)}function handlePaste(a){if(canvas.getAttribute("contenteditable")){let e,t;a.stopPropagation(),a.preventDefault(),t=(e=a.clipboardData||window.clipboardData).getData("Text"),0<=editingTextBox&&currentTextBoxAllowsLineBreaks&&(inputText+=t)}}function setup(){(osc1=document.createElement("canvas")).width=cwidth,osc1.height=cheight,osctx1=osc1.getContext("2d"),(osc2=document.createElement("canvas")).width=cwidth,osc2.height=cheight,osctx2=osc2.getContext("2d"),(osc3=document.createElement("canvas")).width=cwidth,osc3.height=cheight,osctx3=osc3.getContext("2d"),(osc4=document.createElement("canvas")).width=cwidth,osc4.height=cheight,osctx4=osc4.getContext("2d");for(let e=0;e<thumbs.length;e++)thumbs[e]=document.createElement("canvas"),thumbs[e].width=Math.floor(192*pixelRatio),thumbs[e].height=Math.floor(108*pixelRatio),thumbsctx[e]=thumbs[e].getContext("2d"),thumbsctx[e].scale(.2*pixelRatio,.2*pixelRatio);(thumbBig=document.createElement("canvas")).width=Math.floor(384*pixelRatio),thumbBig.height=Math.floor(216*pixelRatio),(thumbBigctx=thumbBig.getContext("2d")).scale(.4*pixelRatio,.4*pixelRatio),window.addEventListener("mousemove",mousemove),window.addEventListener("mousedown",mousedown),window.addEventListener("mouseup",mouseup),window.addEventListener("keydown",keydown),window.addEventListener("keyup",keyup),canvas.addEventListener("paste",handlePaste),rAF60fps()}function draw(){switch(onButton=!1,hoverText="",onTextBox=!1,ctx.clearRect(0,0,canvas.width,canvas.height),2!=menuScreen&&3!=menuScreen||ctx.translate(Math.floor(cameraX+shakeX),Math.floor(cameraY+shakeY)),menuScreen){case-1:ctx.drawImage(preMenuBG,0,0,cwidth,cheight),drawMenu0Button("START GAME",(cwidth-menu0ButtonSize.w)/2,(cheight-menu0ButtonSize.h)/2,0,!1,playGame);break;case 0:drawMenu();break;case 2:drawLevelMap(),(_xmouse<587||_ymouse<469)&&(_ymouse<=180?cameraY=Math.min(Math.max(cameraY+.1*(180-_ymouse),-1080),0):360<=_ymouse&&(cameraY=Math.min(Math.max(cameraY-.1*(_ymouse-360),-1080),0)));break;case 3:if(ctx.drawImage(osc4,-Math.floor((Math.max(cameraX,0)+shakeX)/1.5+(cameraX<0?cameraX/3:0)),-Math.floor((Math.max(cameraY,0)+shakeY)/1.5+(cameraY<0?cameraY/3:0)),osc4.width/pixelRatio,osc4.height/pixelRatio),drawLevel(),30==wipeTimer&&(0==transitionType?(quirksMode||(timer+=getTimer()-levelTimer2),resetLevel()):charsAtEnd>=charCount2&&(2!=playMode&&gotThisCoin&&!gotCoin[currentLevel]&&(gotCoin[currentLevel]=!0,coins++,bonusProgress=Math.floor(.33*coins)),timer+=getTimer()-levelTimer2,0==playMode&&currentLevel<99?(currentLevel++,quirksMode||(toSeeCS=!0),levelProgress=currentLevel,resetLevel()):3==playMode?exitExploreLevel():2==playMode?exitTestLevel():(exitLevel(),99<currentLevel&&(bonusesCleared[currentLevel-100]=!0)),saveGame())),1==cutScene||2==cutScene)_keysDown[13]||_keysDown[16]?(csPress||1!=cutScene||(++cutSceneLine>=cLevelDialogueChar.length?endCutScene():displayLine(currentLevel,cutSceneLine)),csPress=!0):(csPress=!1,2==cutScene&&(cutScene=3));else if(control<1e3){if(recover?(char[control].justChanged=2,0==recoverTimer&&(leftPress=!!_keysDown[37]&&(leftPress||recoverCycle(HPRC2,-1),!0),rightPress=!!_keysDown[39]&&(rightPress||recoverCycle(HPRC2,1),!0))):(0==cornerHangTimer&&(_keysDown[37]?char[control].moveHorizontal(-power):_keysDown[39]&&char[control].moveHorizontal(power)),_keysDown[37]||_keysDown[39]||char[control].stopMoving()),_keysDown[38]){if(!upPress)if(recover&&0==recoverTimer)recoverTimer=60,char[recover2].charState=2,char[recover2].x=char[HPRC1]?char[HPRC1].x:0,char[recover2].y=char[HPRC1]?char[HPRC1].y-20:0,char[recover2].vx=0,char[recover2].vy=-1,char[recover2].frame=3,char[recover2].leg1frame=1,char[recover2].leg2frame=1,char[recover2].legdire=1,HPRCBubbleFrame=0,goal=30*Math.round((char[HPRC1]?char[HPRC1].x:0)/30);else if(char[control].hasArms&&!recover&&30<=char[control].deathTimer)if(char[control].carry)putDown(control),charThrow(control);else for(let e=0;e<charCount;e++)if(e!=control&&near(control,e)&&6<=char[e].charState&&char[control].standingOn!=e&&onlyMovesOneBlock(e,control)){char[e].carry&&putDown(e),ifCarried(e)&&putDown(char[e].carriedBy),char[control].carry=!0,swapDepths(char[control].carryObject=e,2*charCount+1),char[e].carriedBy=control,char[e].weight2=char[e].weight,char[control].weight2=char[e].weight+char[control].weight,rippleWeight(control,char[e].weight2,1),fallOff(e),aboveFallOff(e),char[e].justChanged=2,char[control].justChanged=2,1==char[e].submerged&&(char[e].submerged=0),char[e].onob&&char[control].y-char[e].y>yOff(e)&&(char[control].y=char[e].y+yOff(e),char[control].onob=!1,char[e].onob=!0);break}upPress=!0}else upPress=!1;downPress=!!_keysDown[40]&&(downPress||(char[control].carry?putDown(control):recover?0==recoverTimer&&(recover=!1,HPRCBubbleFrame=0):HPRC2<1e4&&near2(control,HPRC2)&&char[control].hasArms&&char[control].onob&&(char[control].stopMoving(),char[control].x>=char[HPRC2].x-33?char[control].dire=2:char[control].dire=4,recover=!0,recover2=charCount-1,recoverCycle(HPRC2,0))),!0),qPress=!!_keysDown[90]&&(qPress||recover||(changeControl(),qTimer=6),!0),_keysDown[32]?(char[control].onob||3==char[control].submerged)&&2<char[control].landTimer&&!recover&&(3==char[control].submerged?char[control].swimUp(.14/char[control].weight2):char[control].jump(-jumpPower),char[control].onob=!1,fallOff(control)):char[control].landTimer=80}_keysDown[82]&&0==wipeTimer&&(wipeTimer=1,transitionType=0),locations[4]=1e3;for(let t=0;t<charCount;t++){var o;if(5<=char[t].charState){if(char[t].landTimer=char[t].landTimer+1,char[t].carry&&char[char[t].carryObject].justChanged<char[t].justChanged&&(char[char[t].carryObject].justChanged=char[t].justChanged),-1==char[t].standingOn?char[t].onob&&5<=char[t].charState&&(char[t].fricGoal=onlyConveyorsUnder(t)):char[t].fricGoal=char[char[t].standingOn].vx,char[t].applyForces(char[t].weight2,control==t,.7*jumpPower),30<=char[t].deathTimer&&char[t].charMove(),3==char[t].id&&50<char[t].temp)for(let e=0;e<charCount;e++)5<=char[e].charState&&e!=t&&Math.abs(char[t].x-char[e].x)<char[t].w+char[e].w&&char[e].y>char[t].y-char[t].h&&char[e].y<char[t].y+char[e].h&&(char[e].heated=2,heat(e))}else 3<=char[t].charState&&(o=Math.floor(levelTimer/char[t].speed)%(char[t].motionString.length-2),char[t].vx=cardinal[char[t].motionString[2+o]][0]*(30/char[t].speed),char[t].vy=cardinal[char[t].motionString[2+o]][1]*(30/char[t].speed),char[t].px=char[t].x,char[t].py=char[t].y,char[t].charMove());if(3==char[t].charState||5==char[t].charState)for(let e=0;e<charCount;e++)7<=char[e].charState&&e!=t&&Math.abs(char[t].x-char[e].x)<char[t].w+char[e].w&&char[e].y>char[t].y-char[t].h&&char[e].y<char[t].y+char[e].h&&startDeath(e);if(1<=char[t].justChanged){if(1<=char[t].standingOn&&4==char[char[t].standingOn].charState&&(char[t].justChanged=2),1<=char[t].stoodOnBy.length)for(let e=0;e<char[t].stoodOnBy.length;e++)char[char[t].stoodOnBy[e]].y=char[t].y-char[t].h,char[char[t].stoodOnBy[e]].vy=char[t].vy;else!char[t].carry&&2<=char[t].submerged&&(char[t].weight2=char[t].weight-.16);5<=char[t].charState&&!ifCarried(t)&&((0<char[t].vy||0==char[t].vy&&0!=char[t].vx)&&landOnObject(t),char[t].vy<0&&(4==char[t].charState||6==char[t].charState)&&!ifCarried(t)&&objectsLandOn(t))}7<=char[t].charState&&9!=char[t].charState&&!gotThisCoin&&((o=calcDist(t))<locations[4]&&(locations[4]=o,locations[5]=t))}let e;gotThisCoin||(e=140-.7*locations[4]),2!=playMode&&gotCoin[currentLevel]&&(e=Math.max(e,30));for(let a=0;a<charCount;a++){if(0==char[a].vy&&0==char[a].vx&&char[a].x==char[a].px&&char[a].py==char[a].y||(char[a].justChanged=2),2==char[a].charState){var c=(60- --recoverTimer)/60;char[a].x=inter(char[HPRC1]?char[HPRC1].x:0,goal,c),recoverTimer<=0&&(recoverTimer=0,recover=!1,char[recover2].dire=4,char[recover2].charState=char[recover2].pcharState,char[recover2].deathTimer=30,char[recover2].x=goal,char[recover2].px=char[recover2].x,char[recover2].py=char[recover2].y,char[recover2].justChanged=2,checkDeath(a))}else if(1<=char[a].justChanged&&5<=char[a].charState){for(let t=Math.floor((char[a].y-char[a].h)/30);t<=Math.floor(char[a].y/30);t++)for(let e=Math.floor((char[a].x-char[a].w)/30);e<=Math.floor((char[a].x+char[a].w-.01)/30);e++){var l;outOfRange(e,t)||1<=blockProperties[thisLevel[t][e]][11]&&blockProperties[thisLevel[t][e]][11]<=12&&Math.floor(char[a].x/30)==e&&((l=5*(char[a].x-30*Math.floor(char[a].x/30)-15))<tileFrames[t][e].rotation&&char[a].vx<0||l>tileFrames[t][e].rotation&&0<char[a].vx)&&((l<0&&0<tileFrames[t][e].rotation||0<l&&tileFrames[t][e].rotation<0)&&leverSwitch((blockProperties[thisLevel[t][e]][11]-1)%6),tileFrames[t][e].rotation=l)}checkButton2(a,!1),ifCarried(a)&&(char[a].vx=char[char[a].carriedBy].vx,char[a].vy=char[char[a].carriedBy].vy,char[char[a].carriedBy].x+xOff(a)>=char[a].x+20?char[a].x+=20:char[char[a].carriedBy].x+xOff(a)<=char[a].x-20?char[a].x-=20:char[a].x=char[char[a].carriedBy].x+xOff(a),char[char[a].carriedBy].y-yOff(a)>=char[a].y+20?char[a].y+=20:char[char[a].carriedBy].y-yOff(a)<=char[a].y-20?char[a].y-=20:char[a].y=char[char[a].carriedBy].y-yOff(a),char[a].dire=2*Math.ceil(char[char[a].carriedBy].dire/2)),0<=char[a].standingOn&&(char[a].y=char[char[a].standingOn].y-char[char[a].standingOn].h,char[a].vy=char[char[a].standingOn].vy),stopX=0,stopY=0,toBounce=!1,newTileHorizontal(a,1)&&(horizontalType(a,1,8)&&10==char[a].charState&&startCutScene(),horizontalProp(a,1,7,char[a].x,char[a].y)&&7<=char[a].charState?startDeath(a):char[a].x>char[a].px&&horizontalProp(a,1,3,char[a].x,char[a].y)&&(stopX=1)),newTileHorizontal(a,-1)&&(horizontalType(a,-1,8)&&10==char[a].charState&&startCutScene(),horizontalProp(a,-1,6,char[a].x,char[a].y)&&7<=char[a].charState?startDeath(a):char[a].x<char[a].px&&horizontalProp(a,-1,2,char[a].x,char[a].y)&&(stopX=-1)),newTileDown(a)&&(verticalType(a,1,8,!1)&&10==char[a].charState&&startCutScene(),verticalType(a,1,13,!0)?toBounce=!0:verticalProp(a,1,5,char[a].px,char[a].y)&&7<=char[a].charState?startDeath(a):char[a].y>char[a].py&&verticalProp(a,1,1,char[a].px,char[a].y)&&(stopY=1)),newTileUp(a)&&(verticalType(a,-1,8,!1)&&10==char[a].charState&&startCutScene(),verticalProp(a,-1,4,char[a].x,char[a].y)&&7<=char[a].charState?startDeath(a):char[a].y<char[a].py&&verticalProp(a,-1,0,char[a].px,char[a].y)&&(stopY=-1)),0!=stopX&&0!=stopY&&(1==stopY&&(y=30*Math.floor(char[a].y/30)),-1==stopY&&(y=30*Math.ceil((char[a].y-char[a].h)/30)+char[a].h),horizontalProp(a,stopX,stopX/2+2.5,char[a].x,y)?(1==stopX&&(x=30*Math.floor((char[a].x+char[a].w)/30)-char[a].w),-1==stopX&&(x=30*Math.ceil((char[a].x-char[a].w)/30)+char[a].w),verticalProp(a,stopY,stopY/2+.5,x,char[a].y)||(stopY=0)):stopX=0),0!=stopX&&(char[a].fricGoal=0,2<=char[a].submerged&&(ifCarried(j=a)&&(j=char[a].carriedBy),char[j].dire%2==1&&(char[j].swimUp(.14/char[j].weight2),0<=char[j].standingOn&&fallOff(a),char[j].onob=!1)),5==char[a].id&&startDeath(a),1==stopX?x=30*Math.floor((char[a].x+char[a].w)/30)-char[a].w:-1==stopX&&(x=30*Math.ceil((char[a].x-char[a].w)/30)+char[a].w),char[a].x=x,char[a].vx=0,stopCarrierX(a,x)),0!=stopY&&(1==stopY?(y=30*Math.floor(char[a].y/30),ifCarried(a)||(cornerHangTimer=0),fallOff(a),land(a,y,0),land2(a,y),checkButton(a)):-1==stopY&&(5==char[a].id&&startDeath(a),3==char[a].id&&50<char[a].temp&&(char[a].temp=0),y=30*Math.ceil((char[a].y-char[a].h)/30)+char[a].h,char[a].y=y,char[a].vy=0,bumpHead(a),ifCarried(a)&&bumpHead(char[a].carriedBy)),stopCarrierY(a,y,1==stopY)),(newTileHorizontal(a,1)||newTileHorizontal(a,-1))&&(verticalType(a,1,13,!0)&&(toBounce=!0),(horizontalProp(a,1,14,char[a].x,char[a].y)||horizontalProp(a,-1,14,char[a].x,char[a].y))&&submerge(a),(horizontalType(a,1,15)||horizontalType(a,-1,15))&&(char[a].heated=1),checkButton(a)),newTileUp(a)&&(verticalProp(a,-1,14,char[a].x,char[a].y)&&submerge(a),verticalType(a,-1,15,!1)&&(char[a].heated=1)),newTileDown(a)&&(verticalProp(a,1,14,char[a].x,char[a].y)&&submerge(a),verticalType(a,1,15,!1)&&(char[a].heated=1)),2<=char[a].submerged&&0<=char[a].standingOn&&char[a].weight2<0&&fallOff(a),2<=char[a].submerged&&unsubmerge(a),1<=char[a].heated?heat(a):(3!=char[a].id||char[a].temp<=50)&&(0<=char[a].temp?(char[a].temp-=char[a].heatSpeed,char[a].justChanged=2):char[a].temp=0),2==char[a].heated&&(char[a].heated=0),0<=char[a].standingOn?(j=char[a].standingOn,(Math.abs(char[a].x-char[j].x)>=char[a].w+char[j].w||ifCarried(j))&&fallOff(a)):char[a].onob&&(ifCarried(a)||-1!=char[a].standingOn||(char[a].y=30*Math.round(char[a].y/30)),verticalProp(a,1,1,char[a].x,char[a].y)||(char[a].onob=!1,aboveFallOff(a),ifCarried(a)&&(cornerHangTimer=0)),7<=char[a].charState&&verticalProp(a,1,5,char[a].x,char[a].y)&&startDeath(a))}5<=char[a].charState&&(char[a].px=char[a].x,char[a].py=char[a].y,1<=char[a].justChanged&&5<=char[a].charState&&(toBounce&&bounce(a),getCoin(a)),char[a].deathTimer<30?(5==char[a].id&&7<=char[a].deathTimer&&(char[a].deathTimer=6),char[a].deathTimer--,char[a].deathTimer<=0&&endDeath(a)):7<=char[a].charState&&char[a].id<35&&(1<=char[a].justChanged||0==levelTimer)&&setBody(a),a==HPRC2&&(HPRCText=recover?0==recoverTimer?"enter name":40<recoverTimer?names[char[recover2].id]:10<recoverTimer?"Keep going":"Done":"",HPRCCrankRot=12*recoverTimer*(Math.PI/180),1==(HPRCBubbleFrame=!recover&&HPRCBubbleFrame<=2?control<1e4&&near(control,a)&&1<=numberOfDead()&&char[control].hasArms?1:0:HPRCBubbleFrame)?ctx.drawImage(svgHPRCBubble[0],char[a].x-svgHPRCBubble[0].width/2,char[a].y-128+bounceY(9,30,_frameCount)):2==HPRCBubbleFrame?(ctx.drawImage(svgHPRCBubble[1],char[a].x-svgHPRCBubble[1].width/2,char[a].y-150),drawHPRCBubbleCharImg(recover2,1,0)):3==HPRCBubbleFrame?(ctx.drawImage(svgHPRCBubble[2],char[a].x-svgHPRCBubble[2].width/2,char[a].y-150),0<hprcBubbleAnimationTimer?(drawHPRCBubbleCharImg(nextDeadPerson(recover2,-1),inter(1,.6,hprcBubbleAnimationTimer/16),inter(0,-31.45,hprcBubbleAnimationTimer/16)),drawHPRCBubbleCharImg(recover2,inter(.6,1,hprcBubbleAnimationTimer/16),inter(31.45,0,hprcBubbleAnimationTimer/16)),drawHPRCBubbleCharImg(nextDeadPerson(recover2,1),inter(.25,.6,hprcBubbleAnimationTimer/16),inter(44.75,31.45,hprcBubbleAnimationTimer/16)),16<++hprcBubbleAnimationTimer&&(hprcBubbleAnimationTimer=0)):hprcBubbleAnimationTimer<0?(drawHPRCBubbleCharImg(nextDeadPerson(recover2,-1),inter(.25,.6,-hprcBubbleAnimationTimer/16),inter(-44.75,-31.45,-hprcBubbleAnimationTimer/16)),drawHPRCBubbleCharImg(recover2,inter(.6,1,-hprcBubbleAnimationTimer/16),inter(-31.45,0,-hprcBubbleAnimationTimer/16)),drawHPRCBubbleCharImg(nextDeadPerson(recover2,1),inter(1,.6,-hprcBubbleAnimationTimer/16),inter(0,31.45,-hprcBubbleAnimationTimer/16)),--hprcBubbleAnimationTimer<-16&&(hprcBubbleAnimationTimer=0)):(drawHPRCBubbleCharImg(nextDeadPerson(recover2,-1),.6,-31.45),drawHPRCBubbleCharImg(recover2,1,0),drawHPRCBubbleCharImg(nextDeadPerson(recover2,1),.6,31.45))):4==HPRCBubbleFrame&&hprcBubbleAnimationTimer<=64&&(30<hprcBubbleAnimationTimer&&(ctx.globalAlpha=(64-hprcBubbleAnimationTimer)/33),ctx.drawImage(svgHPRCBubble[3],char[a].x-svgHPRCBubble[3].width/2,char[a].y-120),ctx.globalAlpha=1,ctx.drawImage(svgHPRCBubble[4],char[a].x-svgHPRCBubble[4].width/2,char[a].y-120),hprcBubbleAnimationTimer++)),char[a].y>30*levelHeight+160&&7<=char[a].charState&&startDeath(a),10==char[a].charState&&1<=char[a].justChanged&&(Math.abs(char[a].x-30*locations[0])<=30&&Math.abs(char[a].y-(30*locations[1]+10))<=50?(char[a].atEnd||(charsAtEnd++,doorLightFadeDire[charsAtEnd-1]=1,charsAtEnd>=charCount2&&(wipeTimer=1,transitionType=0==playMode?1:2)),char[a].atEnd=!0):(char[a].atEnd&&(doorLightFadeDire[charsAtEnd-1]=-1,charsAtEnd--),char[a].atEnd=!1)),a==control&&setCamera())}qTimer--,x=-cameraX,y=-cameraY,wipeTimer<60&&(x+=(Math.random()-.5)*(30-Math.abs(wipeTimer-30)),y+=(Math.random()-.5)*(30-Math.abs(wipeTimer-30))),control<1e4&&0<char[control].temp&&char[control].temp<=50&&(x+=(Math.random()-.5)*char[control].temp*.2,y+=(Math.random()-.5)*char[control].temp*.2),shakeX=x-cameraX,shakeY=y-cameraY,levelTimer++;break;case 5:ctx.fillStyle="#ffffff",ctx.fillRect(0,0,960,540),ctx.drawImage(osc1,0,0,cwidth,cheight),ctx.fillStyle="#aeaeae",ctx.fillRect(0,480,660,60),ctx.fillStyle="#cccccc",ctx.fillRect(660,0,300,540);var i=cheight-tabHeight*tabNames.length,h=(selectedTab+1)*tabHeight;switch(mouseOnTabWindow=onRect(_xmouse,_ymouse,660,(selectedTab+1)*tabHeight,300,i),selectedTab){case 0:ctx.textAlign="right",ctx.textBaseline="top",ctx.font="18px Helvetica",ctx.fillStyle="#000000",ctx.fillText("Name:",770,10+h),ctx.fillText("Creator:",770,60+h),ctx.fillText("Description:",770,110+h),myLevelInfo.name=drawTextBox(myLevelInfo.name,785,10+h,160,40,18,[5,2,2,2],0,!1,"#e0e0e0","#000000","Helvetica")[0],myLevelInfo.creator=drawTextBox(myLevelInfo.creator,785,60+h,160,40,18,[5,2,2,2],1,!1,"#e0e0e0","#000000","Helvetica")[0],myLevelInfo.desc=drawTextBox(myLevelInfo.desc,785,110+h,160,220,14,[5,2,2,2],2,!0,"#e0e0e0","#000000","Helvetica")[0],!mouseIsDown||pmouseIsDown||onTextBox||(editingTextBox=-1);break;case 1:let t=(selectedTab+1)*tabHeight+5,a=[];for(let e=0;e<myLevelChars[1].length;e++)a.push(t),t+=charInfoHeight+5,3!=myLevelChars[1][e][3]&&4!=myLevelChars[1][e][3]||(t+=diaInfoHeight*myLevelChars[1][e][5].length);var n=i/(T=Math.max(t,a[myLevelChars[1].length-1]+2*charInfoHeight))*i,s=(selectedTab+1)*tabHeight+charsTabScrollBar/(T==i?1:T-i)*(i-n);draggingScrollBar||lcPopUp||!onRect(_xmouse,_ymouse,cwidth-20,s,10,n)?ctx.fillStyle="#dddddd":(onButton=!0,ctx.fillStyle="#e8e8e8",mouseIsDown&&!pmouseIsDown&&(draggingScrollBar=!0,valueAtClick=_ymouse-s)),draggingScrollBar&&(onButton=!1,ctx.fillStyle="#a0a0a0",charsTabScrollBar=Math.floor(Math.max(Math.min((_ymouse-valueAtClick-h)/(i-n)*(T-i),T-i),0)),mouseIsDown||(draggingScrollBar=!1)),ctx.fillRect(cwidth-20,s,10,n),ctx.save(),ctx.translate(0,-charsTabScrollBar),ctx.textAlign="left",ctx.textBaseline="middle",ctx.font="20px Helvetica";for(let e=0;e<Math.min(myLevelChars[1].length,a.length);e++)(duplicateChar||reorderCharUp||reorderCharDown)&&onRect(_xmouse,_ymouse+charsTabScrollBar,665,a[e],260,charInfoHeight)&&(ctx.fillStyle="#e8e8e8",ctx.fillRect(660,a[e]-5,270,charInfoHeight+10)),drawLCCharInfo(e,a[e]),e==charDropdown&&(charDropdownY=a[e]);if(addButtonPressed=!1,!lcPopUp&&onRect(_xmouse,_ymouse,665,cheight-(tabNames.length-selectedTab-1)*tabHeight-20,15,15)&&(myLevelChars[1].length<50&&(onButton=!0,hoverText="Add New Character or Object",mouseIsDown&&!pmouseIsDown&&(duplicateChar=!1,reorderCharUp=!1,reorderCharDown=!1,setUndo(),myLevelChars[1].push([0,-1,-1,10]),m=myLevelChars[1].length-1,p=myLevelChars[1][m][0],char.push(new Character(p,0,0,70+40*m,400-30*m,myLevelChars[1][m][3],charD[p][0],charD[p][1],charD[p][2],charD[p][2],charD[p][3],charD[p][4],charD[p][6],charD[p][8],p<35?charModels[p].defaultExpr:0)),char[char.length-1].placed=!1)),addButtonPressed=!0),!lcPopUp&&onRect(_xmouse,_ymouse,685,cheight-(tabNames.length-selectedTab-1)*tabHeight-20,15,15)&&(myLevelChars[1].length<50&&(onButton=!0,hoverText="Duplicate Character or Object",mouseIsDown&&!pmouseIsDown&&(reorderCharUp=!1,reorderCharDown=!1,duplicateChar=!0)),addButtonPressed=!0),duplicateChar&&!addButtonPressed&&mouseIsDown&&!pmouseIsDown&&(duplicateChar=!1),!lcPopUp&&onRect(_xmouse,_ymouse,705,cheight-(tabNames.length-selectedTab-1)*tabHeight-20,15,15)&&(myLevelChars[1].length<50&&(onButton=!0,hoverText="Move Character or Object Up",mouseIsDown&&!pmouseIsDown&&(duplicateChar=!1,reorderCharDown=!1,reorderCharUp=!0)),addButtonPressed=!0),reorderCharUp&&!addButtonPressed&&mouseIsDown&&!pmouseIsDown&&(reorderCharUp=!1),!lcPopUp&&onRect(_xmouse,_ymouse,725,cheight-(tabNames.length-selectedTab-1)*tabHeight-20,15,15)&&(myLevelChars[1].length<50&&(onButton=!0,hoverText="Move Character or Object Down",mouseIsDown&&!pmouseIsDown&&(duplicateChar=!1,reorderCharUp=!1,reorderCharDown=!0)),addButtonPressed=!0),reorderCharDown&&!addButtonPressed&&mouseIsDown&&!pmouseIsDown&&(reorderCharDown=!1),0<=(charDropdown=-2==charDropdown?-1:charDropdown)){if(0==charDropdownType){if(_keysDown[16])for(myLevelChars[1][charDropdown][0]--,myLevelChars[1][charDropdown][0]<0&&(myLevelChars[1][charDropdown][0]=charD.length-1);0==charD[myLevelChars[1][charDropdown][0]][7];)myLevelChars[1][charDropdown][0]--,myLevelChars[1][charDropdown][0]<0&&(myLevelChars[1][charDropdown][0]=charD.length-1);else for(myLevelChars[1][charDropdown][0]++,myLevelChars[1][charDropdown][0]>charD.length-1&&(myLevelChars[1][charDropdown][0]=0);0==charD[myLevelChars[1][charDropdown][0]][7];)myLevelChars[1][charDropdown][0]++,myLevelChars[1][charDropdown][0]>charD.length-1&&(myLevelChars[1][charDropdown][0]=0);myLevelChars[1][charDropdown][3]=charD[myLevelChars[1][charDropdown][0]][9],3!=myLevelChars[1][charDropdown][3]&&4!=myLevelChars[1][charDropdown][3]||(levelTimer=0,resetCharPositions()),resetLCChar(charDropdown),charDropdown=-2}else if(1==charDropdownType){ctx.fillStyle="#ffffff";var d=12.5;ctx.fillRect(905-3.5*charInfoHeight,charDropdownY+charInfoHeight,3.5*charInfoHeight,87.5),ctx.textBaseline="top",ctx.textAlign="right",ctx.font=d+"px Helvetica",ctx.fillStyle="#000000";let t=0;for(let e=3;e<charStateNames.length;e++)""!=charStateNames[e]&&(mouseOnTabWindow&&!lcPopUp&&onRect(_xmouse,_ymouse+charsTabScrollBar,905-3.5*charInfoHeight,charDropdownY+charInfoHeight+t*d,3.5*charInfoHeight,d)&&(ctx.fillStyle="#dddddd",ctx.fillRect(905-3.5*charInfoHeight,charDropdownY+charInfoHeight+t*d,3.5*charInfoHeight,d),ctx.fillStyle="#000000",mouseIsDown&&!addButtonPressed&&(setUndo(),myLevelChars[1][charDropdown][3]=e)),ctx.fillText(charStateNames[e],904,charDropdownY+charInfoHeight+t*d),t++)}else if(2==charDropdownType){var m=Math.min(Math.max(_xmouse-(330-scale*levelWidth/2),0),levelWidth*scale),p=Math.min(Math.max(_ymouse-(240-scale*levelHeight/2),0),levelHeight*scale);myLevelChars[1][charDropdown][1]=mapRange(m,0,levelWidth*scale,0,levelWidth),myLevelChars[1][charDropdown][2]=mapRange(p,0,levelHeight*scale,0,levelHeight),_keysDown[16]&&(myLevelChars[1][charDropdown][1]=Math.round(2*myLevelChars[1][charDropdown][1])/2,myLevelChars[1][charDropdown][2]=Math.round(2*myLevelChars[1][charDropdown][2])/2),char[charDropdown].x=char[charDropdown].px=30*+myLevelChars[1][charDropdown][1].toFixed(2),char[charDropdown].y=char[charDropdown].py=30*+myLevelChars[1][charDropdown][2].toFixed(2)}else if(3==charDropdownType){m=.5*(valueAtClick+(lastClickY-_ymouse));char[charDropdown].speed=100<m?100:100*-Math.log(1-m/100),char[charDropdown].speed=Math.floor(Math.max(Math.min(char[charDropdown].speed,99),1)),myLevelChars[1][charDropdown][4]=char[charDropdown].speed,levelTimer=0,resetCharPositions(),!mouseIsDown&&pmouseIsDown&&(char[charDropdown].motionString=generateMS(myLevelChars[1][charDropdown]),charDropdown=-2)}else if(4==charDropdownType){let e=myLevelChars[1][charDropdown][5][charDropdownMS][0]+1;3<e&&(e=0),myLevelChars[1][charDropdown][5][charDropdownMS][0]=e,char[charDropdown].motionString=generateMS(myLevelChars[1][charDropdown]),levelTimer=0,resetCharPositions(),charDropdown=-2}else 5==charDropdownType&&(myLevelChars[1][charDropdown][5][charDropdownMS][1]=Math.floor(Math.max(Math.min(valueAtClick+.3*(lastClickY-_ymouse),32),1)),!mouseIsDown&&pmouseIsDown&&(char[charDropdown].motionString=generateMS(myLevelChars[1][charDropdown]),levelTimer=0,resetCharPositions(),charDropdown=-2));0<=charDropdown&&mouseIsDown&&!pmouseIsDown&&!addButtonPressed&&(p=char[charDropdown].charState,resetLCChar(charDropdown),2==charDropdownType?(char[charDropdown].placed=!0,levelTimer=0,resetCharPositions()):1==charDropdownType&&(3==char[charDropdown].charState||4==char[charDropdown].charState?3!=p&&4!=p&&(char[charDropdown].speed=myLevelChars[1][charDropdown][4],char[charDropdown].motionString=generateMS(myLevelChars[1][charDropdown])):(char[charDropdown].speed=0,char[charDropdown].motionString=[])),charDropdown=-2)}charDropdown<-2&&(charDropdown=-charDropdown-3),ctx.restore(),ctx.fillStyle="#cccccc",ctx.fillRect(660,cheight-(tabNames.length-selectedTab-1)*tabHeight-25,85,25),drawAddButton(665,cheight-(tabNames.length-selectedTab-1)*tabHeight-20,15,0),drawDuplicateButton(685,cheight-(tabNames.length-selectedTab-1)*tabHeight-20,15,1),drawUpButton(705,cheight-(tabNames.length-selectedTab-1)*tabHeight-20,15,1),drawDownButton(725,cheight-(tabNames.length-selectedTab-1)*tabHeight-20,15,1);break;case 2:let r=0;var g,b,u,f,v,w,C;ctx.save(),ctx.translate(0,-tileTabScrollBar),b=mouseOnTabWindow&&!lcPopUp?(g=_ymouse+tileTabScrollBar-h,b=_xmouse-660,g%53<13||b%53<13?g=-1:(g=Math.floor((g-13)/53),Math.floor((b-13)/53))):g=-1;for(let e=0;e<blockProperties.length;e++)blockProperties[e][15]&&(e==selectedTile&&(ctx.fillStyle="#a0a0a0",ctx.fillRect(673+r%5*53-6.5,(selectedTab+1)*tabHeight+13+53*Math.floor(r/5)-6.5,53,53)),r%5==b&&Math.floor(r/5)==g&&(hoverText=tileNames[e],e!=selectedTile&&(onButton=!0,ctx.fillStyle="#dddddd",ctx.fillRect(673+r%5*53-6.5,(selectedTab+1)*tabHeight+13+53*Math.floor(r/5)-6.5,53,53),mouseIsDown&&!pmouseIsDown&&(setSelectedTile(e),2!=tool&&3!=tool&&setTool(0)))),6==e?(ctx.fillStyle="#505050",ctx.fillRect(673+r%5*53+10,(selectedTab+1)*tabHeight+13+53*Math.floor(r/5),20,40)):(u=1<blockProperties[e][16]?svgTiles[e][blockProperties[e][17]?_frameCount%blockProperties[e][16]:0]:svgTiles[e],(f=1<blockProperties[e][16]?svgTilesVB[e][blockProperties[e][17]?_frameCount%blockProperties[e][16]:0]:svgTilesVB[e])[2]<=60?(v=40/30,C=673+r%5*53,w=(selectedTab+1)*tabHeight+13+53*Math.floor(r/5),0<blockProperties[e][11]&&blockProperties[e][11]<13&&(ctx.save(),ctx.translate(20+C,w+28*v),ctx.rotate(blockProperties[e][11]<7?-1:1),ctx.translate(-C-20,-w-28*v),ctx.drawImage(svgLevers[(blockProperties[e][11]-1)%6],C,w,40,40),ctx.restore()),ctx.drawImage(u,C+f[0]*v,w+f[1]*v,f[2]*v,f[3]*v)):(C=40/f[2],ctx.drawImage(u,673+r%5*53-f[2]*C/2+20,(selectedTab+1)*tabHeight+13+53*Math.floor(r/5)-f[3]*C/2+20,f[2]*C,f[3]*C))),r++);ctx.restore();n=i/(T=13+53*Math.floor((r-1)/5+1))*i,s=h+tileTabScrollBar/(T-i)*(i-n);draggingScrollBar||lcPopUp||!onRect(_xmouse,_ymouse,cwidth-20,s,10,n)?ctx.fillStyle="#dddddd":(onButton=!0,ctx.fillStyle="#e8e8e8",mouseIsDown&&!pmouseIsDown&&(draggingScrollBar=!0,valueAtClick=_ymouse-s)),draggingScrollBar&&(onButton=!1,ctx.fillStyle="#a0a0a0",tileTabScrollBar=Math.floor(Math.max(Math.min((_ymouse-valueAtClick-h)/(i-n)*(T-i),T-i),0)),mouseIsDown||(draggingScrollBar=!1)),ctx.fillRect(cwidth-20,s,10,n);break;case 3:var L=110;ctx.save(),ctx.translate(0,-bgsTabScrollBar);for(var D=0;D<imgBgs.length;D++)D==selectedBg?(ctx.fillStyle="#a0a0a0",ctx.fillRect(674+D%2*L-7,56+h+Math.floor(D/2)*L-28,110,110)):mouseOnTabWindow&&!lcPopUp&&onRect(_xmouse,_ymouse+bgsTabScrollBar,674+D%2*L,56+h+Math.floor(D/2)*L,96,54)&&(onButton=!0,ctx.fillStyle="#dddddd",ctx.fillRect(674+D%2*L-7,56+h+Math.floor(D/2)*L-28,110,110),mouseIsDown&&!pmouseIsDown&&(selectedBg=D,setLCBG(),updateLCtiles()));ctx.drawImage(osc2,660,h,osc2.width/pixelRatio,osc2.height/pixelRatio),ctx.restore();n=i/(T=56+Math.floor((D-1)/2+1)*L)*i,s=(selectedTab+1)*tabHeight+bgsTabScrollBar/(T-i)*(i-n);draggingScrollBar||lcPopUp||!onRect(_xmouse,_ymouse,cwidth-20,s,10,n)?ctx.fillStyle="#dddddd":(onButton=!0,ctx.fillStyle="#e8e8e8",mouseIsDown&&!pmouseIsDown&&(draggingScrollBar=!0,valueAtClick=_ymouse-s)),draggingScrollBar&&(onButton=!1,ctx.fillStyle="#a0a0a0",bgsTabScrollBar=Math.floor(Math.max(Math.min((_ymouse-valueAtClick-h)/(i-n)*(T-i),T-i),0)),mouseIsDown||(draggingScrollBar=!1)),ctx.fillRect(cwidth-20,s,10,n);break;case 4:var T=5;for(let e=0;e<myLevelDialogue[1].length;e++)T+=diaInfoHeight*myLevelDialogue[1][e].linecount+5;n=i/T*i,s=(selectedTab+1)*tabHeight+diaTabScrollBar/(T==i?1:T-i)*(i-n);draggingScrollBar||lcPopUp||!onRect(_xmouse,_ymouse,cwidth-20,s,10,n)?ctx.fillStyle="#dddddd":(onButton=!0,ctx.fillStyle="#e8e8e8",mouseIsDown&&!pmouseIsDown&&(draggingScrollBar=!0,valueAtClick=_ymouse-s)),draggingScrollBar&&(onButton=!1,ctx.fillStyle="#a0a0a0",diaTabScrollBar=Math.floor(Math.max(Math.min((_ymouse-valueAtClick-h)/(i-n)*(T-i),T-i),0)),mouseIsDown||(draggingScrollBar=!1)),ctx.fillRect(cwidth-20,s,10,n);let o=(selectedTab+1)*tabHeight+5-diaTabScrollBar;for(let e=0;e<myLevelDialogue[1].length&&((reorderDiaUp||reorderDiaDown)&&onRect(_xmouse,_ymouse-diaTabScrollBar,665,o,260,diaInfoHeight*myLevelDialogue[1][e].linecount)&&(ctx.fillStyle="#e8e8e8",ctx.fillRect(660,o-5,270,diaInfoHeight*myLevelDialogue[1][e].linecount+10)),drawLCDiaInfo(e,o),!(e>=myLevelDialogue[1].length));e++)o+=diaInfoHeight*myLevelDialogue[1][e].linecount+5;if(addButtonPressed=!1,!lcPopUp&&onRect(_xmouse,_ymouse,665,cheight-(tabNames.length-selectedTab-1)*tabHeight-20,15,15)&&(onButton=!0,hoverText="Add New Dialogue Line",mouseIsDown&&!pmouseIsDown&&(reorderDiaDown=!1,reorderDiaUp=!1,editingTextBox=-1,setUndo(),myLevelDialogue[1].push({char:99,face:2,text:"Enter text",linecount:1})),addButtonPressed=!0),!lcPopUp&&onRect(_xmouse,_ymouse,685,cheight-(tabNames.length-selectedTab-1)*tabHeight-20,15,15)&&(myLevelChars[1].length<50&&(onButton=!0,hoverText="Move Dialogue Line Up",mouseIsDown&&!pmouseIsDown&&(reorderDiaDown=!1,reorderDiaUp=!0,editingTextBox=-1)),addButtonPressed=!0),reorderDiaUp&&!addButtonPressed&&mouseIsDown&&!pmouseIsDown&&(reorderDiaUp=!1),!lcPopUp&&onRect(_xmouse,_ymouse,705,cheight-(tabNames.length-selectedTab-1)*tabHeight-20,15,15)&&(myLevelChars[1].length<50&&(onButton=!0,hoverText="Move Dialogue Line Down",mouseIsDown&&!pmouseIsDown&&(reorderDiaUp=!1,reorderDiaDown=!0,editingTextBox=-1)),addButtonPressed=!0),reorderDiaDown&&!addButtonPressed&&mouseIsDown&&!pmouseIsDown&&(reorderDiaDown=!1),0<=(diaDropdown=-2==diaDropdown?-1:diaDropdown)){if(0==diaDropdownType)setUndo(),2==myLevelDialogue[1][diaDropdown].face?myLevelDialogue[1][diaDropdown].face=3:3==myLevelDialogue[1][diaDropdown].face&&(myLevelDialogue[1][diaDropdown].face=2),diaDropdown=-2;else if(1==diaDropdownType){setUndo();let t=[99,55,52,51,50];for(let e=myLevelChars[1].length-1;0<=e;e--)6<myLevelChars[1][e][3]&&t.push(e);let e=t.indexOf(myLevelDialogue[1][diaDropdown].char);_keysDown[16]?++e>=t.length&&(e=0):--e<0&&(e=t.length-1),myLevelDialogue[1][diaDropdown].char=t[e],diaDropdown=-2}else 2==diaDropdownType&&_keysDown[13]&&(diaDropdown=-2);0<=diaDropdown&&mouseIsDown&&!pmouseIsDown&&!addButtonPressed&&(diaDropdown=-2)}diaDropdown<-2&&(diaDropdown=-diaDropdown-3),ctx.fillStyle="#cccccc",ctx.fillRect(660,cheight-(tabNames.length-selectedTab-1)*tabHeight-25,65,25),drawAddButton(665,cheight-(tabNames.length-selectedTab-1)*tabHeight-20,15,0),drawUpButton(685,cheight-(tabNames.length-selectedTab-1)*tabHeight-20,15,1),drawDownButton(705,cheight-(tabNames.length-selectedTab-1)*tabHeight-20,15,1);break;case 5:drawMenu0Button("COPY LEVEL",673,10+h,11,!1,copyLevelString),drawMenu0Button("LOAD LEVEL",673,60+h,14,!1,openLevelLoader),drawMenu0Button("TEST LEVEL",673,110+h,10,!1,testLevelCreator),drawMenu0Button("EXIT",673,160+h,15,!1,menuExitLevelCreator),drawMenu0Button("SHARE TO EXPLORE",673,210+h,16,!enableExperimentalFeatures,shareToExplore),ctx.fillStyle="#000000",ctx.textAlign="center",ctx.textBaseline="top",ctx.font="25px Helvetica",ctx.fillText("Necessary Deaths:",660+(cwidth-660)/2,270+h);ctx.fillStyle="#808080",ctx.fillRect(660+(cwidth-660-100)/2,300+h,100,25),drawMinusButton(660+(cwidth-660-100)/2-35,300+h,25,3),onRect(_xmouse,_ymouse,660+(cwidth-660+100)/2+10,300+h,25,25)&&myLevelNecessaryDeaths<999999&&mouseIsDown&&!pmouseIsDown&&myLevelNecessaryDeaths++,drawAddButton(660+(cwidth-660+100)/2+10,300+h,25,3),onRect(_xmouse,_ymouse,660+(cwidth-660-100)/2-35,300+h,25,25)&&0<myLevelNecessaryDeaths&&mouseIsDown&&!pmouseIsDown&&myLevelNecessaryDeaths--,ctx.fillStyle="#ffffff",ctx.textAlign="center",ctx.textBaseline="top",ctx.fillText(myLevelNecessaryDeaths.toString().padStart(6,"0"),660+(cwidth-660)/2,300+h)}ctx.textAlign="left",ctx.font="25px Helvetica",ctx.textBaseline="middle";for(let e=0;e<tabNames.length;e++){e%2==0?ctx.fillStyle="#808080":ctx.fillStyle="#626262";var S=e>selectedTab?cheight-(tabNames.length-e)*tabHeight:e*tabHeight;ctx.fillRect(660,S,300,tabHeight),ctx.fillStyle="#ffffff",ctx.fillText(tabNames[e],664,S+.6*tabHeight),!lcPopUp&&onRect(_xmouse,_ymouse,660,S,300,tabHeight)&&(onButton=!0,mouseIsDown&&!pmouseIsDown&&(selectedTab=e,draggingScrollBar=!1,duplicateChar=!1,reorderCharUp=!1,reorderCharDown=!1,reorderDiaUp=!1,reorderDiaDown=!1,editingTextBox=-1))}for(let e=0;e<12;e++)8!=e&&(e==tool||9==e&&copied?ctx.fillStyle="#999999":ctx.fillStyle="#666666",ctx.fillRect(35+50*e,490,40,40),ctx.drawImage(svgTools[10==e&&undid?8:e],35+50*e,490),!lcPopUp&&480<_ymouse&&onRect(_xmouse,_ymouse,35+50*e,490,40,40)&&(onButton=!0,hoverText=toolNames[e],mouseIsDown&&!pmouseIsDown&&(e<8?(setTool(e),(selectedTab=2)!=tool&&3!=tool||!blockProperties[selectedTile][9]||setSelectedTile(0)):9==e?copyRect():10==e?undo():11==e&&(setUndo(),clearMyLevel(1),updateLCtiles()))));drawLCTiles(),drawLCGrid(),drawLCChars();let t=_xmouse,a=_ymouse;if(_keysDown[16]&&(Math.abs(_ymouse-lastClickY)>Math.abs(_xmouse-lastClickX)?t=lastClickX:a=lastClickY),x=Math.floor((t-(330-scale*levelWidth/2))/scale),y=Math.floor((a-(240-scale*levelHeight/2))/scale),mouseIsDown){if(2==selectedTab&&tool<=1&&mouseOnGrid()&&0<=(D=1==tool?0:selectedTile)&&D<blockProperties.length){let e=!1;myLevel[1][y][x]!=D&&(myLevel[1][y][x]=D,e=!0),6!=D||x==LCEndGateX&&y==LCEndGateY||(-1!=LCEndGateY&&(myLevel[1][LCEndGateY][LCEndGateX]=0),LCEndGateX=x,LCEndGateY=y,setEndGateLights(),e=!0),12!=D||x==LCCoinX&&y==LCCoinY||(-1!=LCCoinY&&(myLevel[1][LCCoinY][LCCoinX]=0),LCCoinX=x,LCCoinY=y,e=!0),e&&updateLCtiles()}2!=tool&&(5!=tool||copied)||-1==LCRect[0]||!mouseOnGrid()||x==LCRect[2]&&y==LCRect[3]||(LCRect[2]=Math.min(Math.max(x,0),levelWidth-1),LCRect[3]=Math.min(Math.max(y,0),levelHeight-1))}if(-1!=LCRect[0]&&drawLCRect(Math.min(LCRect[0],LCRect[2]),Math.min(LCRect[1],LCRect[3]),Math.max(LCRect[0],LCRect[2]),Math.max(LCRect[1],LCRect[3])),2==selectedTab&&mouseOnGrid())if(6==tool){let e,t;ctx.lineWidth=2*scale/9,t=closeToEdgeY()?(ctx.strokeStyle="#008000",e=Math.round((_ymouse-(240-scale*levelHeight/2))/scale),0):(ctx.strokeStyle="#800000",e=Math.floor((_ymouse-(240-scale*levelHeight/2))/scale),.5),ctx.beginPath(),ctx.moveTo(330-scale*levelWidth/2,240-scale*levelHeight/2+scale*(e+t)),ctx.lineTo(330+scale*levelWidth/2,240-scale*levelHeight/2+scale*(e+t)),ctx.stroke()}else if(7==tool){let e,t;ctx.lineWidth=2*scale/9,t=closeToEdgeX()?(ctx.strokeStyle="#008000",e=Math.round((_xmouse-(330-scale*levelWidth/2))/scale),0):(ctx.strokeStyle="#800000",e=Math.floor((_xmouse-(330-scale*levelWidth/2))/scale),.5),ctx.beginPath(),ctx.moveTo(330-scale*levelWidth/2+scale*(e+t),240-scale*levelHeight/2),ctx.lineTo(330-scale*levelWidth/2+scale*(e+t),240+scale*levelHeight/2),ctx.stroke()}if(lcPopUp&&0==lcPopUpType&&(ctx.globalAlpha=.2,ctx.fillStyle="#000000",ctx.fillRect(0,0,cwidth,cheight),ctx.globalAlpha=1,B=750,M=540,ctx.fillStyle="#eaeaea",ctx.fillRect((cwidth-B)/2,(cheight-M)/2,B,M),!mouseIsDown||pmouseIsDown||onRect(_xmouse,_ymouse,(cwidth-B)/2,(cheight-M)/2,B,M)||(lcPopUp=!1,editingTextBox=-1,levelLoadString="",canvas.setAttribute("contenteditable",!1)),ctx.fillStyle="#000000",ctx.font="20px Helvetica",ctx.textBaseline="top",ctx.textAlign="left",ctx.fillText("Paste your level's string here:",(cwidth-B)/2+10,(cheight-M)/2+5),levelLoadString=drawTextBox(levelLoadString,(cwidth-B)/2+10,(cheight-M)/2+30,730,460,8,[5,5,5,5],2,!0,"#ffffff","#000000","monospace")[0],ctx.font="18px Helvetica",ctx.textAlign="center",ctx.fillStyle="#a0a0a0",ctx.fillRect((cwidth-B)/2+B-140,(cheight-M)/2+M-40,60,30),ctx.fillStyle="#ffffff",ctx.fillText("Cancel",(cwidth-B)/2+B-110,(cheight-M)/2+M-33),ctx.fillStyle="#00a0ff",ctx.fillRect((cwidth-B)/2+B-70,(cheight-M)/2+M-40,60,30),ctx.fillStyle="#ffffff",ctx.fillText("Load",(cwidth-B)/2+B-40,(cheight-M)/2+M-33),onRect(_xmouse,_ymouse,(cwidth-B)/2+B-140,(cheight-M)/2+M-40,60,30)?(onButton=!0,mouseIsDown&&!pmouseIsDown&&(lcPopUp=!1,editingTextBox=-1,levelLoadString="",canvas.setAttribute("contenteditable",!1))):onRect(_xmouse,_ymouse,(cwidth-B)/2+B-70,(cheight-M)/2+M-40,60,30)&&(onButton=!0,mouseIsDown&&!pmouseIsDown&&(readLevelString(levelLoadString),lcPopUp=!1,editingTextBox=-1,levelLoadString="",canvas.setAttribute("contenteditable",!1)))),0<lcMessageTimer){50<lcMessageTimer&&(ctx.globalAlpha=(100-lcMessageTimer)/50),ctx.font="25px Helvetica",ctx.textBaseline="middle",ctx.textAlign="center",ctx.fillStyle="#ffffff";let a=lcMessageText.split("\n");a.forEach((e,t)=>{a[t]=ctx.measureText(e).width+10});var B=Math.max(...a),M=25*a.length+5;ctx.fillRect((cwidth-B)/2,(cheight-30)/2,B,M),ctx.fillStyle="#000000",linebreakText(lcMessageText,cwidth/2,cheight/2,25),100<++lcMessageTimer&&(lcMessageTimer=0),ctx.globalAlpha=1}levelTimer++;break;case 6:ctx.drawImage(svgMenu6,0,0,cwidth,cheight),ctx.fillStyle="#666666",ctx.font="bold 35px Helvetica",ctx.textAlign="center",ctx.textBaseline="middle";let r=28;for(let e=0;e<exploreTabWidths.length;e++)e==exploreTab?ctx.fillStyle="#666666":onRect(_xmouse,_ymouse,r,20,exploreTabWidths[e],45)?(ctx.fillStyle="#b3b3b3",mouseIsDown&&!pmouseIsDown&&(exploreTab=e,setExplorePage(0))):ctx.fillStyle="#999999",ctx.fillRect(r,20,exploreTabWidths[e],45),ctx.fillStyle="#ffffff",ctx.fillText(exploreTabNames[e],r+exploreTabWidths[e]/2,45),r+=exploreTabWidths[e]+5;if(exploreLoading)drawExploreLoadingText();else for(let e=0;e<explorePageLevels.length;e++)drawExploreLevel(e%4*232+28,182*Math.floor(e/4)+100,e);ctx.textBaseline="top",ctx.textAlign="center",ctx.fillStyle="#ffffff",ctx.font="30px Helvetica",ctx.fillText(explorePage+1,cwidth/2,460),explorePage<=0||exploreLoading?ctx.fillStyle="#505050":onRect(_xmouse,_ymouse,240,460,25,30)?(ctx.fillStyle="#cccccc",onButton=!0,mouseIsDown&&!pmouseIsDown&&setExplorePage(explorePage-1)):ctx.fillStyle="#999999",drawArrow(240,460,25,30,3),exploreLoading?ctx.fillStyle="#505050":onRect(_xmouse,_ymouse,720,460,25,30)?(ctx.fillStyle="#cccccc",onButton=!0,mouseIsDown&&!pmouseIsDown&&setExplorePage(explorePage+1)):ctx.fillStyle="#999999",drawArrow(720,460,25,30,1),drawMenu2_3Button(1,837.5,486.95,menu2Back),drawMenu0Button("LOG IN",300,15,16,!enableExperimentalFeatures,logInExplore);break;case 7:ctx.fillStyle="#666666",ctx.fillRect(0,0,cwidth,cheight),exploreLoading?drawExploreLoadingText():(ctx.textBaseline="top",ctx.textAlign="left",ctx.fillStyle="#ffffff",ctx.font="38px Helvetica",ctx.fillText(exploreLevelPageLevel.title,29.15,27.4),ctx.fillStyle="#999999",ctx.font="18px Helvetica",ctx.fillText("by "+exploreLevelPageLevel.creator.name,31.85,66.1),ctx.fillStyle="#ffffff",ctx.font="20px Helvetica",wrapText(exploreLevelPageLevel.description,430,98,500,22),ctx.fillStyle="#cccccc",ctx.drawImage(thumbBig,30,98,384,216),drawMenu0Button("PLAY LEVEL",30,389,2,!1,playExploreLevel)),drawMenu2_3Button(1,837.5,486.95,menuExploreBack)}levelTimer<=30||3!=menuScreen?30<=wipeTimer&&wipeTimer<=60&&(white_alpha=220-4*wipeTimer):white_alpha=0,29==wipeTimer&&3==menuScreen&&(charsAtEnd>=charCount2||0==transitionType)&&(white_alpha=100),1<=(wipeTimer=60<=wipeTimer?0:wipeTimer)&&wipeTimer++,ctx.setTransform(pixelRatio,0,0,pixelRatio,0,0),2==pmenuScreen?drawLevelMapBorder():3==pmenuScreen&&(1!=cutScene&&2!=cutScene||drawCutScene(),drawLevelButtons(),3!=menuScreen&&(cameraX=0,cameraY=0,shakeX=0,shakeY=0)),0<white_alpha&&(ctx.fillStyle="#ffffff",ctx.globalAlpha=white_alpha/100,ctx.fillRect(0,0,cwidth,cheight),ctx.globalAlpha=1),onButton?setCursor("pointer"):onTextBox?setCursor("text"):setCursor("auto"),setHoverText(),_frameCount++,pmouseIsDown=mouseIsDown,_pxmouse=_xmouse,_pymouse=_ymouse,pmenuScreen=menuScreen}window.onload=function(){loadingScreen()};let fps=60,now,then=window.performance.now(),lastFrameReq=then,interval=1e3/fps,delta;function rAF60fps(){requestAnimationFrame(rAF60fps),now=window.performance.now(),(delta=now-then)>interval&&(then=now-delta%interval,draw()),lastFrameReq-then>interval&&(then=now),lastFrameReq=now}function getLevelPage(e,t){return exploreLoading=!0,fetch("https://5beam.zelo.dev/api/page?page="+e+"&amount=8&type="+t,{method:"GET"}).then(e=>{e.json().then(e=>{explorePageLevels=e,0==exploreTab&&setExploreThumbs(),truncateLevelTitles(),exploreLoading=!1})}).catch(e=>{console.log(e)})}function getExploreLevel(e){return exploreLoading=!0,fetch("https://5beam.zelo.dev/api/level?id="+e,{method:"GET"}).then(e=>{e.json().then(e=>{exploreLevelPageLevel=e,drawExploreThumb(thumbBigctx,thumbBig.width,exploreLevelPageLevel.data,.4),exploreLoading=!1})}).catch(e=>{console.log(e)})}function getExploreLevelpack(e){return exploreLoading=!0,fetch("https://5beam.zelo.dev/api/levelpack?id="+e,{method:"GET"}).then(e=>{e.json().then(e=>{exploreLevelPageLevel=e,drawExploreThumb(thumbBigctx,thumbBig.width,exploreLevelPageLevel.levels[0].data,.4),exploreLoading=!1})}).catch(e=>{console.log(e)})}function getExploreUser(e){return exploreLoading=!0,fetch("https://5beam.zelo.dev/api/user?discordId="+e,{method:"GET"}).then(e=>{e.json().then(e=>{exploreUser=e,exploreLoading=!1})}).catch(e=>{console.log(e)})}function postExploreLevel(t,a,r){if(6e5<Date.now()-parseInt(getCookie("token_created_at"))||""==getCookie("token_created_at"))setLCMessage("You are not logged in to explore.\nYour login expires after 10 minutes because\nI haven't yet figured out how to refresh the tokens.\nFor now you can just copy your level, go to the explore menu to log in,\nthen come back here and load your level back.");else{if(!levelAlreadySharedToExplore){levelAlreadySharedToExplore=!0,exploreLoading=!0;let e=new FormData;return e.set("access_token",getCookie("access_token")),e.set("title",t),e.set("description",a),e.set("file",new File([r],"file.txt")),fetch("https://5beam.zelo.dev/api/create/level",{method:"POST",body:e}).then(e=>{exploreLoading=!1,200==e.status?setLCMessage("Level successfuly sent to explore!"):setLCMessage("Server responded with status "+e.status)}).catch(e=>{console.log(e),setLCMessage("Sorry, there was an error while attempting to send the level.")})}setLCMessage("You already shared that level to explore.")}}function getCookie(e){var a=e+"=";let t=decodeURIComponent(document.cookie);var r=t.split(";");for(let t=0;t<r.length;t++){let e=r[t];for(;" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(a))return e.substring(a.length,e.length)}return""}class Character{constructor(e,t,a,r,o,c,l,i,h,n,s,d,y,m,p){this.id=e,this.x=t,this.y=a,this.px=t,this.py=a,this.vx=0,this.vy=0,this.onob=!1,this.dire=4,this.carry=!1,this.carryObject=0,this.carriedBy=200,this.landTimer=200,this.deathTimer=30,this.charState=c,this.standingOn=-1,this.stoodOnBy=[],this.w=l,this.h=i,this.weight=h,this.weight2=n,this.h2=s,this.atEnd=!1,this.friction=d,this.fricGoal=0,this.justChanged=2,this.speed=0,this.motionString=[],this.buttonsPressed=[],this.pcharState=0,this.submerged=0,this.temp=0,this.heated=0,this.heatSpeed=y,this.hasArms=m,this.placed=!0,this.frame=3,this.poseTimer=0,this.leg1frame=0,this.leg2frame=0,this.legdire=1,this.leg1skew=0,this.leg2skew=0,this.legAnimationFrame=[0,0],this.burstFrame=-1,this.diaMouthFrame=0,this.expr=0,this.dExpr=p,this.acidDropTimer=[0,0]}applyForces(e,t,a){e=Math.sign(e)*Math.sqrt(Math.abs(e));this.onob||1==this.submerged||(this.vy=Math.min(this.vy+e,25)),this.onob||t?this.vx=(this.vx-this.fricGoal)*this.friction+this.fricGoal:this.vx*=1-.12*(1-this.friction),Math.abs(this.vx)<.01&&(this.vx=0),1==this.submerged?(this.vy=0,.18<this.weight2&&(this.submerged=2)):2<=this.submerged&&(1.5<this.vx&&(this.vx=1.5),this.vx<-1.5&&(this.vx=-1.5),1.8<this.vy&&(this.vy=1.8),this.vy<-a&&(this.vy=-a))}charMove(){this.y+=this.vy,this.x+=this.vx}moveHorizontal(e){e*this.fricGoal<=0&&!this.onob&&(this.fricGoal=0),this.vx+=e,e<0&&(this.dire=1),0<e&&(this.dire=3),this.justChanged=2}stopMoving(){1==this.dire&&(this.dire=2),3==this.dire&&(this.dire=4)}jump(e){this.vy=e}swimUp(e){this.vy-=this.weight2+e}setFrame(e){e!=this.frame&&(5==this.frame&&4==e||4==this.frame&&5==e||(this.poseTimer=0),this.frame=e,3==cutScene&&this.expr!=this.dExpr&&(this.expr=this.dExpr))}}